{
    "ClientConfiguration": {
        "ConfigurationName": "Simple Учет",
        "ConfigurationDescription": "Простое решение для работы с штрихкодами товаров. Поставляется в комплекте с расширением для 1С. Подробнее про расширение Вы можете узнать по ссылке: https://www.simple-kit.ru/products/simple-uchet/ ",
        "ConfigurationVersion": "0.1.0",
        "Processes": [
            {
                "type": "Process",
                "ProcessName": "Документы",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "Name": "Плитки",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "type": "Tiles",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@gtin",
                                        "Variable": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@series",
                                        "Variable": ""
                                    }
                                ]
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "onlineOnAfterStart": false,
                        "DefOnCreate": "",
                        "send_when_opened": false,
                        "DefOnAfterCreate": "",
                        "send_after_opened": false,
                        "DefOnInput": "",
                        "DefOnlineOnCreate": "",
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "send_when_opened": false,
                        "onlineOnInput": false,
                        "DefOnlineOnCreate": "",
                        "DefOnlineOnInput": "",
                        "DefOnCreate": "",
                        "DefOnInput": "",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "match_parent",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "SpinnerLayout",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "gravity_horizontal": "left"
                                            },
                                            {
                                                "type": "Button",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "+",
                                                "Variable": "btn_add_doc",
                                                "TextBold": true,
                                                "gravity_horizontal": "center"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@docCards",
                                        "Variable": "doc_cards"
                                    }
                                ]
                            }
                        ],
                        "onlineOnAfterStart": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Документ товары",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "TextBold": true,
                                        "TextSize": "18"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C"
                                            },
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "@doc_date",
                                                "Variable": ""
                                            }
                                        ]
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@warehouse",
                                        "Variable": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "Elements": []
                                    },
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@doc_goods",
                                        "Variable": "doc_goods"
                                    },
                                    {
                                        "type": "Button",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Отметить к отправке",
                                        "Variable": "btn_doc_mark_verified"
                                    }
                                ]
                            },
                            {
                                "Value": "",
                                "Variable": "barcode_camera",
                                "type": "barcode"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnInput": "",
                        "DefOnCreate": "",
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "DefOnlineOnCreate": "",
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Товар",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@Doc_data",
                                        "Variable": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@Good",
                                        "Variable": "",
                                        "TextSize": "24",
                                        "TextBold": true,
                                        "TextColor": "#7A005C",
                                        "BackgroundColor": ""
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "План",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "@qtty_plan",
                                                        "Variable": "",
                                                        "TextSize": "24"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "Факт",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "type": "EditTextNumeric",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "TextSize": "24"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "Цена",
                                                "Variable": ""
                                            },
                                            {
                                                "type": "EditTextNumeric",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "@price",
                                                "Variable": "price"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "Button",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            },
                            {
                                "Value": "@photoGallery",
                                "Variable": "photoGallery",
                                "type": "HorizontalGallery"
                            },
                            {
                                "Value": "",
                                "Variable": "photo",
                                "type": "photo"
                            },
                            {
                                "Value": "",
                                "Variable": "photo",
                                "type": "photoGallery"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnInput": "",
                        "onlineOnAfterStart": false,
                        "DefOnlineOnCreate": "",
                        "send_when_opened": false,
                        "DefOnCreate": "",
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "elem_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "elem_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Новый документ",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "match_parent",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "SpinnerLayout",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@doc_type_select",
                                        "Variable": "doc_type_click"
                                    },
                                    {
                                        "type": "EditTextText",
                                        "height": "wrap_content",
                                        "width": 50,
                                        "weight": "0",
                                        "Value": "@fld_number",
                                        "Variable": "",
                                        "width_value": "50"
                                    },
                                    {
                                        "type": "DateField",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@doc_date",
                                        "Variable": "fld_data"
                                    },
                                    {
                                        "type": "EditTextAutocomplete",
                                        "show_by_condition": "",
                                        "height": "wrap_content",
                                        "NoRefresh": true,
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@countragent",
                                        "Variable": "fld_countragent",
                                        "gravity_horizontal": "left"
                                    },
                                    {
                                        "type": "EditTextAutocomplete",
                                        "NoRefresh": true,
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@warehouse",
                                        "Variable": "doc_warehouse",
                                        "gravity_horizontal": "left"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "Button",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            },
                                            {
                                                "type": "Button",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "DefOnInput": "",
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "new_doc_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "new_doc_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Документ штрихкоды",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@barc_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "DefOnInput": "",
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "doc_barcodes_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "doc_barcodes_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Удаление штрихкода",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "Товар с такой маркировкой уже есть в документе!",
                                        "Variable": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@good",
                                        "Variable": "id_good",
                                        "TextColor": "#7A005C",
                                        "TextSize": "24",
                                        "TextBold": true
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@code_art",
                                        "Variable": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@unit_name",
                                        "Variable": "id_unit"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@barcode_value",
                                        "Variable": "barcode_value1"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "Button",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "Отменить",
                                                "Variable": "btn_barcode_cancel"
                                            },
                                            {
                                                "type": "Button",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "Удалить",
                                                "Variable": "btn_barcode_delete"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "DefOnInput": "",
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "DefOnlineOnCreate": "",
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Ошибка сканера",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "TextColor": "",
                                        "TextSize": "24"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Сканер отключен",
                                        "Variable": ""
                                    },
                                    {
                                        "type": "Button",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan"
                                    }
                                ]
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnInput": "",
                        "onlineOnAfterStart": false,
                        "Handlers": [
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "CVOperationName": "ActiveCV",
                "type": "CVOperation",
                "CVFrames": [
                    {
                        "Name": "Новый шаг ActiveCV",
                        "type": "CVFrame",
                        "CVOnline": false,
                        "CVDetector": "Objects_Full",
                        "CVResolution": "HD720",
                        "CVMode": "green_and_grey",
                        "CVCameraDevice": "Back",
                        "CVDetectorMode": "train"
                    }
                ],
                "hidden": true
            },
            {
                "ProcessName": "Новый процесс",
                "type": "Process",
                "Operations": [
                    {
                        "Name": "Создать таблицы",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "Button",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Создать таблицы",
                                        "Variable": "btn_init"
                                    }
                                ]
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": false,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "app_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ],
                "hidden": true
            },
            {
                "ProcessName": "Товары",
                "type": "Process",
                "Operations": [
                    {
                        "Name": "Товары список",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "Value": "Категория:",
                                                "Variable": "",
                                                "TextItalic": false
                                            },
                                            {
                                                "type": "object",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "@select_goods_type",
                                                "Variable": "select_goods_type"
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@error_txt",
                                        "Variable": "error_txt",
                                        "TextColor": "#ff0000"
                                    },
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@goods_cards",
                                        "Variable": "goods_cards"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "",
                                "Variable": "barcode",
                                "type": "barcode"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "noConfirmation": true,
                        "DefOnInput": "",
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Цены товара",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "@name",
                                        "Variable": "",
                                        "TextColor": "18",
                                        "TextBold": true
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "@code",
                                                "Variable": "",
                                                "TextSize": "16"
                                            },
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "@type_name",
                                                "Variable": ""
                                            }
                                        ]
                                    },
                                    {
                                        "type": "CardsLayout",
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@good_prices",
                                        "Variable": "good_prices"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "DefOnInput": "",
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "price_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "price_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Выбор",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@cards",
                                        "Variable": "cards"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "good_types_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "good_types_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Карточка товара",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "buttons",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "Button",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "Цены",
                                                "Variable": "to_prices"
                                            },
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "Value": "",
                                                "Variable": ""
                                            },
                                            {
                                                "type": "Button",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "Остатки",
                                                "Variable": "to_remains"
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "name",
                                        "orientation": "vertical",
                                        "Elements": [
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "@good_name",
                                                "Variable": "",
                                                "TextSize": "22",
                                                "TextColor": "#7A005C"
                                            },
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "@item_key",
                                                "Variable": "item_key"
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "good_info",
                                        "orientation": "vertical",
                                        "Elements": [
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "@good_type",
                                                "Variable": "good_type"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "art",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "Артикул:",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "@good_art",
                                                        "Variable": "good_art",
                                                        "TextBold": true
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "code",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "Код:",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "@good_code",
                                                        "Variable": "good_code"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "descr",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "Описание:",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "@good_descr",
                                                        "Variable": "good_descr"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            },
                                            {
                                                "type": "CardsLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "@barcode_cards",
                                                "Variable": "barcode_cards"
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@my_info",
                                        "Variable": "my_info"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onPostStart",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_load",
                                "postExecute": ""
                            }
                        ]
                    }
                ],
                "DefineOnBackPressed": true
            },
            {
                "ProcessName": "Настройки",
                "type": "Process",
                "Operations": [
                    {
                        "Name": "Настройки и обмен",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@ip_adr",
                                        "Variable": "text_ip",
                                        "TextSize": "25"
                                    },
                                    {
                                        "type": "CheckBox",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Отображать серии",
                                        "Variable": "use_series"
                                    },
                                    {
                                        "type": "CheckBox",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Отображать характеристики",
                                        "Variable": "use_properties"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "drawable": "plus"
                                    },
                                    {
                                        "type": "CheckBox",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "gravity_horizontal": "left"
                                    },
                                    {
                                        "type": "CheckBox",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "Запретить сканирование сверх плана",
                                        "Variable": "allow_overscan"
                                    },
                                    {
                                        "type": "EditTextText",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height_value": "0",
                                        "width_value": "0"
                                    },
                                    {
                                        "type": "ProgressButton",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Скопировать базу на компьютер",
                                        "Variable": "btn_copy_base",
                                        "height_value": "0",
                                        "width_value": "0"
                                    },
                                    {
                                        "type": "EditTextText",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@path",
                                        "Variable": "path",
                                        "gravity_horizontal": "left"
                                    },
                                    {
                                        "type": "CheckBox",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Удалять файлы после загрузки",
                                        "Variable": "delete_files"
                                    },
                                    {
                                        "type": "ProgressButton",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Загрузить локальные файлы",
                                        "Variable": "btn_local_files"
                                    },
                                    {
                                        "type": "ProgressButton",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Выгрузить данные",
                                        "Variable": "btn_export"
                                    },
                                    {
                                        "type": "ProgressButton",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "Создать таблицы",
                                        "Variable": "btn_init"
                                    },
                                    {
                                        "type": "ProgressButton",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "Список локальных файлов",
                                        "Variable": "btn_files_list"
                                    },
                                    {
                                        "type": "ProgressButton",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "Версия конфигурации",
                                        "Variable": "btn_conf_version"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "DefOnInput": "",
                        "noConfirmation": true,
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "DefOnlineOnCreate": "",
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_start",
                                "postExecute": "",
                                "listener": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "СписокФайлов",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "MultilineText",
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@files_list",
                                        "Variable": "files_list"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": false,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "send_when_opened": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "file_list_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ],
                "hidden": false
            },
            {
                "ProcessName": "Остатки",
                "type": "Process",
                "Operations": [
                    {
                        "Name": "Проверить остатки",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Value": "",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "Elements": [
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Value": "Выбор склада:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "type": "object",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Value": "@wh_select",
                                                                "Variable": "wh_select"
                                                            }
                                                        ],
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": ""
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "",
                                                        "Variable": "art",
                                                        "orientation": "horizontal",
                                                        "Elements": [
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Value": "Артикул товара:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "type": "EditTextText",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Value": "@good_art_input",
                                                                "Variable": "good_art_input"
                                                            }
                                                        ],
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "@selected_object_name",
                                                        "Variable": "",
                                                        "TextColor": "#008000"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "",
                                                        "Variable": "cell",
                                                        "orientation": "horizontal",
                                                        "Elements": [
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Value": "Артикул ячейки:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "type": "EditTextText",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Value": "@cell_input",
                                                                "Variable": "cell_input"
                                                            }
                                                        ],
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "@selected_cell_name",
                                                        "Variable": "selected_cell_name",
                                                        "TextColor": "#008000"
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "@error_msg",
                                                        "Variable": "error_msg",
                                                        "TextColor": "#ff0000"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "type": "ProgressButton",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "Запросить остатки",
                                        "Variable": "get_remains_btn",
                                        "TextSize": "15"
                                    },
                                    {
                                        "type": "TableLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@goods_custom_table",
                                        "Variable": "goods_custom_table"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "",
                                "Variable": "barcode",
                                "type": "barcode"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnInput": false,
                        "DefOnCreate": "",
                        "send_when_opened": false,
                        "onlineOnAfterStart": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "runprogress",
                                "type": "python",
                                "method": "remains_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "remains_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Выбор склада",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@wh_cards",
                                        "Variable": "wh_cards"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "backward",
                                "Variable": "back_to_remains",
                                "type": "fab"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "open_wh_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "warehouse_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Таблица остатков",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "TextColor": "#008000"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@selected_object_name",
                                        "Variable": "selected_object_name",
                                        "TextColor": "#008000"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@selected_wh_name",
                                        "Variable": "selected_wh_name",
                                        "TextColor": "#008000"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@selected_cell_name",
                                        "Variable": "selected_cell_name",
                                        "TextColor": "#008000"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@error_msg",
                                        "Variable": "error_msg",
                                        "TextItalic": true,
                                        "TextColor": "#ff0000"
                                    },
                                    {
                                        "type": "TableLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@goods_custom_table",
                                        "Variable": "goods_custom_table"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "#f1de",
                                "Variable": "show_filters",
                                "type": "fab"
                            },
                            {
                                "Value": "",
                                "Variable": "barcode",
                                "type": "barcode"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "noConfirmation": true,
                        "Handlers": [
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "remains_tables_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ],
                "hidden": false,
                "DefineOnBackPressed": true
            },
            {
                "ProcessName": "Цены",
                "type": "Process",
                "Operations": [
                    {
                        "Name": "Проверка цен",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "Value": "Артикул товара:",
                                                        "Variable": "",
                                                        "TextItalic": true
                                                    },
                                                    {
                                                        "type": "EditTextText",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Value": "@input_good_art",
                                                        "Variable": "input_good_art"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            },
                                            {
                                                "type": "TextView",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "@prices_object_name",
                                                "Variable": "",
                                                "TextColor": "#008000"
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "",
                                                        "Variable": "price_type",
                                                        "orientation": "horizontal",
                                                        "Elements": [
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Value": "Тип цены:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "type": "object",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Value": "@price_type_select",
                                                                "Variable": "price_type_select"
                                                            }
                                                        ],
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": 10,
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height_value": "10"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "",
                                                        "Variable": "properties",
                                                        "orientation": "horizontal",
                                                        "Elements": [
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Value": "Характеристики:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "type": "object",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Value": "@property_select",
                                                                "Variable": "property_select"
                                                            }
                                                        ],
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": 10,
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height_value": "10"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "",
                                                        "Variable": "units",
                                                        "orientation": "horizontal",
                                                        "Elements": [
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Value": "Упаковка:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "type": "object",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Value": "@unit_select",
                                                                "Variable": "unit_select"
                                                            }
                                                        ],
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": ""
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": 10,
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height_value": "10"
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Value": "@prices_error_msg",
                                                        "Variable": "prices_error_msg",
                                                        "TextColor": "#ff0000"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "type": "TextView",
                                        "height": 1,
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "height_value": "1"
                                    },
                                    {
                                        "type": "ProgressButton",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "Показать",
                                        "Variable": "get_prices_btn"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": 3,
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Value": "",
                                        "Variable": "",
                                        "height_value": "3"
                                    },
                                    {
                                        "type": "TableLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@prices_custom_table",
                                        "Variable": "prices_custom_table"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "",
                                "Variable": "barcode",
                                "type": "barcode"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "runprogress",
                                "type": "python",
                                "method": "prices_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Выбор типа цены",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@price_type_cards",
                                        "Variable": "price_type_cards"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "backward",
                                "Variable": "back_to_prices",
                                "type": "fab"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "price_types_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "price_types_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Выбор характеристик",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@property_cards",
                                        "Variable": "property_cards"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "backward",
                                "Variable": "back_to_prices",
                                "type": "fab"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "property_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "properties_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Выбор упаковки",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "CardsLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@unit_cards",
                                        "Variable": "unit_cards"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "backward",
                                "Variable": "back_to_prices",
                                "type": "fab"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "unit_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "units_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "Name": "Таблица цен",
                        "type": "Operation",
                        "Elements": [
                            {
                                "Value": "",
                                "Variable": "",
                                "type": "LinearLayout",
                                "weight": "0",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "orientation": "vertical",
                                "Elements": [
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "TextColor": "#008000"
                                    },
                                    {
                                        "type": "TextView",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@prices_object_name",
                                        "Variable": "prices_object_name",
                                        "TextColor": "#008000"
                                    },
                                    {
                                        "type": "TableLayout",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Value": "@prices_custom_table",
                                        "Variable": "prices_custom_table"
                                    }
                                ],
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": ""
                            },
                            {
                                "Value": "#f1de",
                                "Variable": "show_filters",
                                "type": "fab"
                            },
                            {
                                "Value": "",
                                "Variable": "barcode",
                                "type": "barcode"
                            }
                        ],
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "hideBottomBarScreen": true,
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false,
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "price_tables_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "prices_tables_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ],
                "DefineOnBackPressed": true
            }
        ],
        "ConfigurationSettings": {
            "uid": "a6ce59bc3f714a5284213f6e293e3e91",
            "vendor": "Simple-kit"
        },
        "ConfigurationTags": "Py,off-line,ActiveCV®",
        "PyHandlers": "ZnJvbSBydS50cmF2ZWxmb29kLnNpbXBsZV91aSBpbXBvcnQgU2ltcGxlVXRpbGl0ZXMgYXMgc3VDbGFzcwoKaW1wb3J0IHVpX2JhcmNvZGVzCmltcG9ydCB1aV9jc3YKaW1wb3J0IHVpX2dsb2JhbAppbXBvcnQgdWlfZm9ybV9kYXRhCmltcG9ydCBzb2NrZXQKaW1wb3J0IGpzb24KaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBkYXRhYmFzZV9pbml0X3F1ZXJ5ZXMKaW1wb3J0IG9zCmZyb20gUElMIGltcG9ydCBJbWFnZQppbXBvcnQgaW1wb3J0bGliCiMgZnJvbSByc19zZXR0aW5ncyBpbXBvcnQgUlNTZXR0aW5ncwpmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwppbXBvcnQgaHR0cF9leGNoYW5nZQpmcm9tIHJlcXVlc3RzLmF1dGggaW1wb3J0IEhUVFBCYXNpY0F1dGgKZnJvbSBydS50cmF2ZWxmb29kLnNpbXBsZV91aSBpbXBvcnQgSW1wb3J0VXRpbHMgYXMgaXVDbGFzcwoKCm5vQ2xhc3MgPSBqY2xhc3MoInJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpLk5vU1FMIikKcnNfc2V0dGluZ3MgPSBub0NsYXNzKCJyc19zZXR0aW5ncyIpCgppbXBvcnRsaWIucmVsb2FkKHVpX2NzdikKaW1wb3J0bGliLnJlbG9hZCh1aV9nbG9iYWwpCmltcG9ydGxpYi5yZWxvYWQodWlfZm9ybV9kYXRhKQppbXBvcnRsaWIucmVsb2FkKGRhdGFiYXNlX2luaXRfcXVlcnllcykKCgojIC0tLS0tCiMgMDEwMDYwODk0MDU1Mzg4NjIxNSxpUEdTUXBCdCEmQgpkZWYgc2V0dGluZ3Nfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyBoYXNoTWFwLnB1dCgndG9hc3QnLCfQvtCx0L3QvtCy0LjQu9C40YHRjCcpCiAgICBhcHBfb25fc3RhcnQoaGFzaE1hcCkKICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19ER1JBTSkKICAgIHRyeToKICAgICAgICBzLmNvbm5lY3QoKCI4LjguOC44IiwgODApKQogICAgICAgIGFhID0gKHMuZ2V0c29ja25hbWUoKVswXSkKICAgICAgICAjIGFhID0gaGFzaE1hcC5nZXQoJ2lwX2FkcicpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2lwX2FkcicsIGFhKQogICAgICAgICMgaGFzaE1hcC5wdXQoJ3RvYXN0JywgYWEpCiAgICBleGNlcHQ6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2lwX2FkcicsICfQvdC10YIg0YHQtdGC0LgnKQogICAgIyBhcHBfb25fc3RhcnQoaGFzaE1hcCkKICAgICMg0JfQvdCw0YfQtdC90LjRjyDQutC+0L3RgdGC0LDQvdGCINC4INC90LDRgdGC0YDQvtC10LoKICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfY29uc3RhbnRzKCkKICAgIGlmIHJlczoKICAgICAgICBoYXNoTWFwLnB1dCgndXNlX3NlcmllcycsIHN0cihyZXNbMV0pKQogICAgICAgIGhhc2hNYXAucHV0KCd1c2VfcHJvcGVydGllcycsIHN0cihyZXNbMl0pKQogICAgICAgIGhhc2hNYXAucHV0KCd1c2VfbWFyaycsIHN0cihyZXNbM10pKQogICAgICAgIGhhc2hNYXAucHV0KCdhZGRfaWZfbm90X2luX3BsYW4nLCBzdHIocmVzWzRdKSkKICAgICAgICBoYXNoTWFwLnB1dCgncGF0aCcsIHN0cihyZXNbNV0pKQogICAgICAgIGhhc2hNYXAucHV0KCdkZWxldGVfZmlsZXMnLCBzdHIocmVzWzZdKSkKICAgICAgICBoYXNoTWFwLnB1dCgnYWxsb3dfb3ZlcnNjYW4nLCBzdHIocmVzWzldKSkKCiAgICBpZiBub3QgaGFzaE1hcC5jb250YWluc0tleSgnaXBfaG9zdCcpOgogICAgICAgIGhhc2hNYXAucHV0KCdpcF9ob3N0JywgJzE5Mi4xNjguMS43NycpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgc2V0dGluZ3Nfb25fY2xpY2soaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgdXNlX3NlcmllcyA9IGhhc2hNYXAuZ2V0KCd1c2Vfc2VyaWVzJykKICAgIHVzZV9wcm9wZXJ0aWVzID0gaGFzaE1hcC5nZXQoJ3VzZV9wcm9wZXJ0aWVzJykKICAgIHVzZV9tYXJrID0gaGFzaE1hcC5nZXQoJ3VzZV9tYXJrJykKICAgIGRlbGV0ZV9maWxlcyA9IGhhc2hNYXAuZ2V0KCdkZWxldGVfZmlsZXMnKQogICAgYWRkX2lmX25vdF9pbl9wbGFuID0gaGFzaE1hcC5nZXQoJ2FkZF9pZl9ub3RfaW5fcGxhbicpCiAgICBhbGxvd19vdmVyc2NhbiA9IGhhc2hNYXAuZ2V0KCdhbGxvd19vdmVyc2NhbicpCiAgICBwYXRoID0gaGFzaE1hcC5nZXQoJ3BhdGgnKQoKICAgIGlmIHVzZV9zZXJpZXMgaXMgTm9uZTogdXNlX3NlcmllcyA9ICdmYWxzZScKICAgIGlmIHVzZV9wcm9wZXJ0aWVzIGlzIE5vbmU6IHVzZV9wcm9wZXJ0aWVzID0gJ2ZhbHNlJwogICAgaWYgdXNlX21hcmsgaXMgTm9uZTogdXNlX21hcmsgPSAnZmFsc2UnCiAgICBpZiBhZGRfaWZfbm90X2luX3BsYW4gaXMgTm9uZTogYWRkX2lmX25vdF9pbl9wbGFuID0gJ2ZhbHNlJwogICAgaWYgcGF0aCBpcyBOb25lOiBwYXRoID0gJy8vc3RvcmFnZS9lbXVsYXRlZC8wL0FuZHJvaWQvZGF0YS9ydS50cmF2ZWxmb29kLnNpbXBsZV91aS8nICAjICcvL3N0b3JhZ2UvZW11bGF0ZWQvMC9kb3dubG9hZC8nCiAgICBpZiBkZWxldGVfZmlsZXMgaXMgTm9uZTogZGVsZXRlX2ZpbGVzID0gJ2ZhbHNlJwogICAgaWYgYWxsb3dfb3ZlcnNjYW4gaXMgTm9uZTogYWxsb3dfb3ZlcnNjYW4gPSAnZmFsc2UnCiAgICAjIHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCdVcGRhdGUgUlNfZG9jcyBTRVQgY29udHJvbCA9ID8nLChhbGxvd19vdmVyc2NhbiwpKSAgI9CSINGC0LDQsdC70LjRhtGLINC00L7QutGD0LzQtdC90YLQvtCyINC30LDQv9C40YHRi9Cy0LDQtdC8INC90L7QstC+0LUg0LfQvdCw0YfQtdC90LjQtSDQutC+0L3RgtGA0L7Qu9GPCiAgICB1aV9nbG9iYWwucHV0X2NvbnN0YW50cygKICAgICAgICAodXNlX3NlcmllcywgdXNlX3Byb3BlcnRpZXMsIHVzZV9tYXJrLCBhZGRfaWZfbm90X2luX3BsYW4sIHBhdGgsIGRlbGV0ZV9maWxlcywgYWxsb3dfb3ZlcnNjYW4pKQogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgnbGlzdGVuZXInKQogICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl9jb3B5X2Jhc2UnOgogICAgICAgIGlwX2hvc3QgPSBoYXNoTWFwLmdldCgnaXBfaG9zdCcpCiAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUoJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy9TaW1wbGVLZWVwJyk6CiAgICAgICAgICAgIHdpdGggb3BlbignLy9kYXRhL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvZGF0YWJhc2VzL1NpbXBsZUtlZXAnLCAncmInKSBhcyBmOiAgIyByaWdodHNjYW4KICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KCdodHRwOi8vJyArIGlwX2hvc3QgKyAnOjI0NDQvcG9zdCcsIGZpbGVzPXsnUmlnaHRzY2FuJzogZn0pICAjIHJpZ2h0c2NhbgogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQkdCw0LfQsCBTUUxpdGUg0YPRgdC/0LXRiNC90L4g0LLRi9Cz0YDRg9C20LXQvdCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQpNCw0LnQuyDQvdC1INC90LDQudC00LXQvScpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2xvY2FsX2ZpbGVzJzoKICAgICAgICAjIHBhdGggPSBoYXNoTWFwLmdldCgnbG9jYWxwYXRoJykKICAgICAgICBwYXRoID0gaGFzaE1hcC5nZXQoJ3BhdGgnKQogICAgICAgIGRlbGV0ZV9maWxlcyA9IGhhc2hNYXAuZ2V0KCdkZWxldGVfZmlsZXMnKQogICAgICAgIGlmIG5vdCBkZWxldGVfZmlsZXM6IGRlbGV0ZV9maWxlcyA9ICcwJwogICAgICAgIGlmIG5vdCBwYXRoOiBwYXRoID0gJy8vc3RvcmFnZS9lbXVsYXRlZC8wL2Rvd25sb2FkLycKCiAgICAgICAgcmV0X3RleHQgPSB1aV9jc3YubGlzdF9mb2xkZXIocGF0aCwgZGVsZXRlX2ZpbGVzKQoKICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCByZXRfdGV4dCkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9leHBvcnQnOgoKICAgICAgICB1aV9jc3YuZXhwb3J0X2NzdihwYXRoLCBoYXNoTWFwLmdldCgnaXBfYWRyJyksIGhhc2hNYXAuZ2V0KCdBTkRST0lEX0lEJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9CU0LDQvdC90YvQtSDQstGL0LPRgNGD0LbQtdC90YsnKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CgogICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2ZpbGVzX2xpc3QnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Ch0L/QuNGB0L7QutCk0LDQudC70L7QsicpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fY29uZl92ZXJzaW9uJzoKICAgICAgICBjb25mID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgnX2NvbmZpZ3VyYXRpb24gJykpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3NpemUnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cd0LDRgdGC0YDQvtC50LrQuCDQqNGA0LjRhNGC0L7QsicpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fdGVzdF9iYXJjb2RlJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQotC10YHRgiDRiNGC0YDQuNGF0LrQvtC00LAnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2xvYWRfZGF0YSc6CiAgICAgICAgIyBodHRwID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKICAgICAgICAjIHJlc3VsdCA9IGh0dHBfZXhjaGFuZ2Uuc2VydmVyX2xvYWRfZGF0YShodHRwKQogICAgICAgIHRpbWVyX3VwZGF0ZShoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSkKICAgICAgICAjIGlmIG5vdCByZXN1bHQgPT0gJ29rJzoKICAgICAgICAjICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLHJlc3VsdCkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9lcnJfbG9nJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQntGI0LjQsdC60LgnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2h0dHBfc2V0dGluZ3MnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cd0LDRgdGC0YDQvtC50LrQuCBodHRwINGB0L7QtdC00LjQvdC10L3QuNGPJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JudF9jbGVhcl90YWJsZXMnOgogICAgICAgIHF0ZXh0ID0gJycnCiAgICAgICAgU0VMRUNUIG5hbWUgRlJPTSBzcWxpdGVfbWFzdGVyIFdIRVJFIHR5cGU9J3RhYmxlJwogICAgICAgICcnJwogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQogICAgICAgIGZvciBlbCBpbiByZXM6CiAgICAgICAgICAgIGRlbF90ZXh0ID0gJ0RFTEVURSBGUk9NICcgKyBlbFswXQogICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChkZWxfdGV4dCkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl91cGxvYWRfZG9jcyc6CiAgICAgICAgdXJsID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKICAgICAgICBxdGV4dCA9ICcnJ1NFTEVDVCBpZF9kb2MgRlJPTSBSU19kb2NzIFdIRVJFIHZlcmlmaWVkID0gJzEnCiAgICAgICAgICAgICAgICAgICAgVU5JT04KICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgaWRfZG9jIEZST00gUlNfYWRyX2RvY3MgV0hFUkUgdmVyaWZpZWQgPSAnMScgJycnCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIE5vbmUsIFRydWUpCgogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgZG9jX2xpc3QgPSBbXQogICAgICAgICAgICBmb3IgZWwgaW4gcmVzOgogICAgICAgICAgICAgICAgZG9jX2xpc3QuYXBwZW5kKCciJyArIGVsWydpZF9kb2MnXSArICciJykKICAgICAgICAgICAgZG9jX2luX3N0ciA9ICcsJy5qb2luKGRvY19saXN0KQogICAgICAgICAgICAjIGh0cHBhcmFtcyA9IHsndXNlcm5hbWUnOmhhc2hNYXAuZ2V0KCdvbmxpbmVVc2VyJyksICdwYXNzd29yZCc6aGFzaE1hcC5nZXQoJ29ubGluZVBhc3MnKSwgJ3VybCc6dXJsfQogICAgICAgICAgICBhbnN3ZXIgPSBodHRwX2V4Y2hhbmdlLnBvc3RfY2hhbmdlc190b19zZXJ2ZXIoZG9jX2luX3N0ciwgdXJsKQogICAgICAgICAgICBpZiBhbnN3ZXIuZ2V0KCdFcnJvcicpIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdlcnJvcl9sb2cnLCBzdHIoYW5zd2VyLmdldCgnRXJyb3InKSksIFRydWUpCgogICAgICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2RvY3MgU0VUIHNlbnQgPSAxICBXSEVSRSBpZF9kb2MgaW4gKHtkb2NfaW5fc3RyfSkgJwogICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKGRvY19pbl9zdHIsKSwgRmFsc2UpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fdGltZXInOgogICAgICAgIHRyeToKICAgICAgICAgICAgdGltZXJfdXBkYXRlKGhhc2hNYXApCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLHN0cihlKSkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zb3VuZF9zZXR0aW5ncyc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCfQndCw0YHRgtGA0L7QudC60LAg0LfQstGD0LrQsCcpCiAgICByZXR1cm4gaGFzaE1hcAoKCiMg0JfQsNC/0L7Qu9C90LXQvdC40LUg0YHQv9C40YHQutCwINC00L7QutGD0LzQtdC90YLQvtCyCmRlZiByZWZpbGxfZG9jc19saXN0KGZpbHRlcj0nJyk6CiAgICBkb2NfbGlzdCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2NhcmQocnNfc2V0dGluZ3MpCiAgICBkb2NfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10gPSBbXQoKICAgIHF1ZXJ5X3RleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2RvY19xdWVyeShmaWx0ZXIpCgogICAgaWYgZmlsdGVyID09ICcnIG9yIGZpbHRlciA9PSAn0JLRgdC1JzoKICAgICAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCkKICAgIGVsc2U6CiAgICAgICAgcmVzdWx0cyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChmaWx0ZXIsKSkKCiAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgaWYgcmVjb3JkWzhdID09IDE6CiAgICAgICAgICAgIGNvbXBsZXRlZCA9ICd0cnVlJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbXBsZXRlZCA9ICdmYWxzZScKICAgICAgICBwcm9kdWN0X3JvdyA9IHsKICAgICAgICAgICAgJ2NvbXBsZXRlZCc6IGNvbXBsZXRlZCwKICAgICAgICAgICAgJ3R5cGUnOiBzdHIocmVjb3JkWzFdKSwKICAgICAgICAgICAgJ251bWJlcic6IHN0cihyZWNvcmRbMl0pLAogICAgICAgICAgICAnZGF0YSc6IHN0cihyZWNvcmRbM10pLAogICAgICAgICAgICAna2V5JzogcmVjb3JkWzBdLAogICAgICAgICAgICAnd2FyZWhvdXNlJzogcmVjb3JkWzddLAogICAgICAgICAgICAnY291bnRyYWdlbnQnOiByZWNvcmRbNl0sCiAgICAgICAgICAgICdhZGRfbWFya19zZWxlY3Rpb24nOiByZWNvcmRbMTBdCiAgICAgICAgfQogICAgICAgIGRvY19saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgcmV0dXJuIGpzb24uZHVtcHMoZG9jX2xpc3QpCgoKZGVmIGRvY3Nfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyDQl9Cw0L/QvtC70L3QuNC8INC/0L7Qu9C1INGE0LjQu9GM0YLRgNCwINC/0L4g0LLQuNC00YMg0LTQvtC60YPQvNC10L3RgtC+0LIKICAgIHJlc3VsdCA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHVpX2Zvcm1fZGF0YS5nZXRfZG9jX3R5cGVfcXVlcnkoKSkKICAgIGlmIGhhc2hNYXAuZ2V0KCdkb2NfdHlwZV9zZWxlY3QnKSA9PSBOb25lOgogICAgICAgIGRvY190eXBlX2xpc3QgPSBbJ9CS0YHQtSddCiAgICAgICAgZm9yIHJlY29yZCBpbiByZXN1bHQ6CiAgICAgICAgICAgIGRvY190eXBlX2xpc3QuYXBwZW5kKHJlY29yZFswXSkKICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX3R5cGVfc2VsZWN0JywgJzsnLmpvaW4oZG9jX3R5cGVfbGlzdCkpCgogICAgIyBoYXNoTWFwLnB1dCgnZG9jX3R5cGVfY2xpY2snLCAn0JLRgdC1JykKICAgICMg0JXRgdC70Lgg0JLRi9C30L7QsiDRjdC60YDQsNC90LAg0LjQtyDQvNC10L3RjiDQv9C70LjRgtC+0LogLSDQvtCx0YDQsNCx0L7RgtCw0LXQvAogICAgaWYgaGFzaE1hcC5jb250YWluc0tleSgnc2VsZWN0ZWRfdGlsZV9rZXknKToKICAgICAgICB0aWxlX2tleSA9IGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF90aWxlX2tleScpCiAgICAgICAgaWYgdGlsZV9rZXk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdkb2NfdHlwZV9jbGljaycsIHRpbGVfa2V5KQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfdGlsZV9rZXknLCAnJykKICAgICMg0J/QtdGA0LXQt9Cw0L/QvtC70L3QuNC8INGB0L/QuNGB0L7QuiDQtNC+0LrRg9C80LXQvdGC0L7QsgogICAgaWYgaGFzaE1hcC5nZXQoJ2RvY190eXBlX2NsaWNrJykgPT0gTm9uZToKICAgICAgICBscyA9IHJlZmlsbF9kb2NzX2xpc3QoKQogICAgZWxzZToKICAgICAgICBscyA9IHJlZmlsbF9kb2NzX2xpc3QoaGFzaE1hcC5nZXQoJ2RvY190eXBlX2NsaWNrJykpCiAgICBoYXNoTWFwLnB1dCgiZG9jQ2FyZHMiLCBscykKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBkb2NfZGV0YWlsc19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgIGZhbHNlVmFsdWVMaXN0ID0gKDAsJzAnLCdmYWxzZScsJ0ZhbHNlJyxOb25lKQogICAgIyDQpNC+0YDQvNC40YDRg9C10Lwg0YLQsNCx0LvQuNGG0YMg0LrQsNGA0YLQvtGH0LXQuiDQuCDQt9Cw0L/RgNC+0YEg0Log0LHQsNC30LUKICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfY29uc3RhbnRzKCkKICAgIHVzZV9zZXJpZXMgPSByZXNbMV0KICAgIHVzZV9wcm9wZXJ0aWVzID0gcmVzWzJdCiAgICBoYXNoTWFwLnB1dCgndXNlX3Byb3BlcnRpZXMnLCByZXNbMl0pCiAgICBkb2NfZGV0YWlsX2xpc3QgPSB1aV9mb3JtX2RhdGEuZ2V0X2RvY19kZXRhaWxfY2FyZHModXNlX3NlcmllcywgdXNlX3Byb3BlcnRpZXMscnNfc2V0dGluZ3MpCiAgICBkb2NfZGV0YWlsX2xpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddID0gW10KCiAgICAjINCf0L7Qu9GD0YfQsNC10Lwg0YLQtdC10LrRg9GJ0LjQuSDQtNC+0LrRg9C80LXQvdGCCiAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgnZG9jQ2FyZHMnKSkKCiAgICBlbGVtX24gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KCiAgICBmb3IgZWwgaW4gZWxlbV9uOgogICAgICAgIGlmIGVsWydrZXknXSA9PSBpZF9kb2M6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdhZGRfbWFya19zZWxlY3Rpb24nLAogICAgICAgICAgICAgICAgICAgICAgICBzdHIoZWxbJ2FkZF9tYXJrX3NlbGVjdGlvbiddIGlmIGVsWydhZGRfbWFya19zZWxlY3Rpb24nXSBlbHNlICcwJykpCiAgICAjICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY3VycmVudF9zdHIpLTFdCgogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2RldGFpbHNfcXVlcnkoKQoKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCAoaWRfZG9jLCksIFRydWUpCiAgICByb3dfZmlsdGVyID0gVHJ1ZSBpZiBoYXNoTWFwLmdldCgncm93c19maWx0ZXInKSA9PSAnMScgZWxzZSBGYWxzZQogICAgaWYgcmVzdWx0czoKICAgICAgICBoYXNoTWFwLnB1dCgnaWRfZG9jJywgc3RyKHJlc3VsdHNbMF1bJ2lkX2RvYyddKSkKICAgICAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgICAgIHBpYyA9ICcjZjAyYScgaWYgcmVjb3JkWydJc0RvbmUnXSAhPSAwIGVsc2UgJyNmMDBjJwogICAgICAgICAgICBpZiByZWNvcmRbJ3F0dHknXSA9PSAwIGFuZCByZWNvcmRbJ3F0dHlfcGxhbiddID09IDA6CiAgICAgICAgICAgICAgICBwaWMgPSAnJwogICAgICAgICAgICBpZiByb3dfZmlsdGVyIGFuZCByZWNvcmRbJ3F0dHknXSA9PSByZWNvcmRbJ3F0dHlfcGxhbiddOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgcHJvZHVjdF9yb3cgPSB7CiAgICAgICAgICAgICAgICAna2V5Jzogc3RyKHJlY29yZFsnaWQnXSksCiAgICAgICAgICAgICAgICAnZ29vZF9uYW1lJzogc3RyKHJlY29yZFsnZ29vZF9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX2dvb2QnOiBzdHIocmVjb3JkWydpZF9nb29kJ10pLAogICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnRpZXMnOiBzdHIocmVjb3JkWydpZF9wcm9wZXJ0aWVzJ10pLAogICAgICAgICAgICAgICAgJ3Byb3BlcnRpZXNfbmFtZSc6IHN0cihyZWNvcmRbJ3Byb3BlcnRpZXNfbmFtZSddKSwKICAgICAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzdHIocmVjb3JkWydpZF9zZXJpZXMnXSksCiAgICAgICAgICAgICAgICAnc2VyaWVzX25hbWUnOiBzdHIocmVjb3JkWydzZXJpZXNfbmFtZSddKSwKICAgICAgICAgICAgICAgICdpZF91bml0Jzogc3RyKHJlY29yZFsnaWRfdW5pdCddKSwKICAgICAgICAgICAgICAgICd1bml0c19uYW1lJzogc3RyKHJlY29yZFsndW5pdHNfbmFtZSddKSwKICAgICAgICAgICAgICAgICdjb2RlX2FydCc6ICfQmtC+0LQ6ICcgKyBzdHIocmVjb3JkWydjb2RlJ10pLAoKICAgICAgICAgICAgICAgICdxdHR5Jzogc3RyKHJlY29yZFsncXR0eSddIGlmIHJlY29yZFsncXR0eSddIGlzIG5vdCBOb25lIGVsc2UgMCksCiAgICAgICAgICAgICAgICAncXR0eV9wbGFuJzogc3RyKHJlY29yZFsncXR0eV9wbGFuJ10gaWYgcmVjb3JkWydxdHR5X3BsYW4nXSBpcyBub3QgTm9uZSBlbHNlIDApLAogICAgICAgICAgICAgICAgJ3ByaWNlJzogc3RyKHJlY29yZFsncHJpY2UnXSBpZiByZWNvcmRbJ3ByaWNlJ10gaXMgbm90IE5vbmUgZWxzZSAwKSwKICAgICAgICAgICAgICAgICdwcmljZV9uYW1lJzogc3RyKHJlY29yZFsncHJpY2VfbmFtZSddKSwKICAgICAgICAgICAgICAgICdwaWN0dXJlJzogcGljCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10uYXBwZW5kKHByb2R1Y3Rfcm93KQoKICAgICAgICAjINCf0YDQuNC30L3QsNC6LCBoYXZlX3F0dHlfcGxhbiDQldGB0YLRjNCf0LvQsNC90J/QntCa0J7Qu9C40YfQtdGB0YLQstGDICAtICDQmNGB0YLQuNC90LAg0LrQvtCz0LTQsCDRgdGD0LzQvNCwINC60L7Qu9C+0L3QutC4IFF0dHlfcGxhbiA+IDAKICAgICAgICAjINCf0YDQuNC30L3QsNC6ICBoYXZlX21hcmtfcGxhbiAi0JXRgdGC0YzQn9C70LDQvdCa0J7QtNC+0LLQnNCw0YDQutC40YDQvtCy0LrQuCDigJMg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC60L7Qu9C40YfQtdGB0YLQstC+INGB0YLRgNC+0Log0YLQsNCx0LsuIFJTX2RvY3NfYmFyY29kZXMg0YEg0LfQsNC00LDQvdC90YvQvCBpZF9kb2Mg0LggaXNfcGxhbiAg0LHQvtC70YzRiNC1INC90YPQu9GPLgogICAgICAgICMg0J/RgNC40LfQvdCw0LogaGF2ZV96ZXJvX3BsYW4gItCV0YHRgtGMINGB0YLRgNC+0LrQuCDRgtC+0LLQsNGA0LAg0LIg0LTQvtC60YPQvNC10L3RgtC1IiDQmNGB0YLQuNC90LAsINC60L7Qs9C00LAg0LXRgdGC0Ywg0LfQsNC/0L7Qu9C90LXQvdC90YvQtSDRgdGC0YDQvtC60Lgg0YLQvtCy0LDRgNC+0LIg0LIg0LTQvtC60YPQvNC10L3RgtC1CiAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAi0JrQvtC90YLRgNC+0LvQuNGA0L7QstCw0YLRjCIgIC0g0L/RgNC40LfQvdCw0Log0LTQu9GPINC00L7QutGD0LzQtdC90YLQsCwg0L3QsNC00L4g0LvQuCDQutC+0L3RgtGA0L7Qu9C40YDQvtCy0LDRgtGMCgogICAgICAgIHF0ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9xdHR5X3N0cmluZ19jb3VudF9xdWVyeSgpCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jfSkKICAgICAgICBpZiBub3QgcmVzOgogICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgICAgIGhhdmVfemVyb19wbGFuID0gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IHJlc1swXVswXSA+IDAgICMg0JIg0LTQvtC60YPQvNC10L3RgtC1INC10YHRgtGMINGB0YLRgNC+0LrQuAogICAgICAgICAgICBpZiBoYXZlX3plcm9fcGxhbjoKICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gcmVzWzBdWzFdID4gMCAgIyDQkiDQtNC+0LrRg9C80LXQvdGC0LUg0LXRgdGC0Ywg0LrQvtC70LLQviDQv9C70LDQvQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICMg0JXRgdGC0Ywg0LvQuCDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/Qu9Cw0L0g0L/QviDQutC+0LTQsNC8INC80LDRgNC60LjRgNC+0LLQutC4CiAgICAgICAgcXRleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2hhdmVfbWFya19jb2Rlc19xdWVyeSgpCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jLCAnaXNfcGxhbic6ICcxJ30pCiAgICAgICAgaWYgbm90IHJlczoKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBGYWxzZQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXZlX21hcmtfcGxhbiA9IHJlc1swXVswXSA+IDAKICAgIGVsc2U6CiAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgIGhhdmVfemVyb19wbGFuID0gRmFsc2UKICAgICAgICBoYXZlX21hcmtfcGxhbiA9IEZhbHNlCgogICAgaGFzaE1hcC5wdXQoJ2hhdmVfcXR0eV9wbGFuJywgc3RyKGhhdmVfcXR0eV9wbGFuKSkKICAgIGhhc2hNYXAucHV0KCdoYXZlX3plcm9fcGxhbicsIHN0cihoYXZlX3plcm9fcGxhbikpCiAgICBoYXNoTWFwLnB1dCgnaGF2ZV9tYXJrX3BsYW4nLCBzdHIoaGF2ZV9tYXJrX3BsYW4pKQogICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoJ1NFTEVDVCBjb250cm9sIGZyb20gUlNfZG9jcyAgV0hFUkUgaWRfZG9jID0gPycsIChpZF9kb2MsKSkKICAgICMg0JXRgdGC0Ywg0LvQuCDQutC+0L3RgtGA0L7Qu9GMINC/0LvQsNC90LAg0LIg0LTQvtC60YPQvNC10L3RgtC1CiAgICBpZiByZXM6CiAgICAgICAgaWYgcmVzWzBdWzBdOgogICAgICAgICAgICBpZiByZXNbMF1bMF0gaW4gZmFsc2VWYWx1ZUxpc3Q6CiAgICAgICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY29udHJvbCA9ICdUcnVlJwoKICAgICAgICAgICAgIyBjb250cm9sID0gcmVzWzBdWzBdICMnVHJ1ZScKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwogICAgZWxzZToKICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwoKICAgIGhhc2hNYXAucHV0KCdjb250cm9sJywgY29udHJvbCkKICAgIGhhc2hNYXAucHV0KCJkb2NfZ29vZHMiLCBqc29uLmR1bXBzKGRvY19kZXRhaWxfbGlzdCkpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZG9jX2Fkcl9kZXRhaWxzX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgY3VycmVudF9jZWxsID0gaGFzaE1hcC5nZXQoJ2N1cnJlbnRfY2VsbF9pZCcpCgogICAgZmFsc2VWYWx1ZUxpc3QgPSAoMCwnMCcsJ2ZhbHNlJywnRmFsc2UnLE5vbmUpCiAgICAjINCk0L7RgNC80LjRgNGD0LXQvCDRgtCw0LHQu9C40YbRgyDQutCw0YDRgtC+0YfQtdC6INC4INC30LDQv9GA0L7RgSDQuiDQsdCw0LfQtQogICAgcmVzID0gdWlfZ2xvYmFsLmdldF9jb25zdGFudHMoKQogICAgdXNlX3NlcmllcyA9IHJlc1sxXQogICAgdXNlX3Byb3BlcnRpZXMgPSByZXNbMl0KICAgIGhhc2hNYXAucHV0KCd1c2VfcHJvcGVydGllcycsIHJlc1syXSkKICAgIGRvY19kZXRhaWxfbGlzdCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2RldGFpbF9jYXJkcyh1c2Vfc2VyaWVzLCB1c2VfcHJvcGVydGllcyxyc19zZXR0aW5ncywgVHJ1ZSkKICAgIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10gPSBbXQoKICAgICMg0J/QvtC70YPRh9Cw0LXQvCDRgtC10LXQutGD0YnQuNC5INC00L7QutGD0LzQtdC90YIKICAgIGN1cnJlbnRfc3RyID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfcG9zaXRpb24iKQogICAgamxpc3QgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCdkb2NBZHJDYXJkcycpKQoKICAgIGVsZW1fbiA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXQoKICAgIGZvciBlbCBpbiBlbGVtX246CiAgICAgICAgaWYgZWxbJ2tleSddID09IGlkX2RvYzoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2FkZF9tYXJrX3NlbGVjdGlvbicsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0cihlbFsnYWRkX21hcmtfc2VsZWN0aW9uJ10gaWYgZWxbJ2FkZF9tYXJrX3NlbGVjdGlvbiddIGVsc2UgJzAnKSkKICAgICMgICAgY3VycmVudF9lbGVtID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0ciktMV0KCiAgICBxdWVyeV90ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9kb2NfZGV0YWlsc19xdWVyeShUcnVlLCBUcnVlIGlmIGN1cnJlbnRfY2VsbCBlbHNlIEZhbHNlKQogICAgdGFibGVfdHlwZV9maWx0ZXIgPSBoYXNoTWFwLmdldCgndGFibGVfdHlwZV9maWx0ZXInKSBpZiBoYXNoTWFwLmdldCgndGFibGVfdHlwZV9maWx0ZXInKSBlbHNlICdvdXQnCiAgICBpZiBjdXJyZW50X2NlbGw6CiAgICAgICAgcGFyYW1zID0gKGlkX2RvYywgdGFibGVfdHlwZV9maWx0ZXIsIGN1cnJlbnRfY2VsbCkKICAgIGVsc2U6CiAgICAgICAgcGFyYW1zID0gKGlkX2RvYywgdGFibGVfdHlwZV9maWx0ZXIpCgogICAgcmVzdWx0cyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIHBhcmFtcywgVHJ1ZSkKICAgIHJvd19maWx0ZXIgPSBUcnVlIGlmIGhhc2hNYXAuZ2V0KCdyb3dzX2ZpbHRlcicpID09ICcxJyBlbHNlIEZhbHNlCgogICAgaWYgcmVzdWx0czoKICAgICAgICBoYXNoTWFwLnB1dCgnaWRfZG9jJywgc3RyKHJlc3VsdHNbMF1bJ2lkX2RvYyddKSkKICAgICAgICBjdXJyZW50X2NlbGwgPScnCiAgICAgICAgZm9yIHJlY29yZCBpbiByZXN1bHRzOgogICAgICAgICAgICBpZiByb3dfZmlsdGVyIGFuZCByZWNvcmRbJ3F0dHknXSA9PSByZWNvcmRbJ3F0dHlfcGxhbiddOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgcGljID0gJyNmMDJhJyBpZiByZWNvcmRbJ0lzRG9uZSddICE9IDAgZWxzZSAnI2YwMGMnCiAgICAgICAgICAgIGlmIHJlY29yZFsncXR0eSddID09IDAgYW5kIHJlY29yZFsncXR0eV9wbGFuJ10gPT0gMDoKICAgICAgICAgICAgICAgIHBpYyA9ICcnCgogICAgICAgICAgICBpZiBjdXJyZW50X2NlbGwgIT0gcmVjb3JkWydjZWxsX25hbWUnXToKICAgICAgICAgICAgICAgIGMgPSB7Imdyb3VwIjogcmVjb3JkWydjZWxsX25hbWUnXX0KICAgICAgICAgICAgICAgIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10uYXBwZW5kKGMpCiAgICAgICAgICAgICAgICBjdXJyZW50X2NlbGwgPSByZWNvcmRbJ2NlbGxfbmFtZSddCgogICAgICAgICAgICBwcm9kdWN0X3JvdyA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBzdHIocmVjb3JkWydpZCddKSwKICAgICAgICAgICAgICAgICdnb29kX25hbWUnOiBzdHIocmVjb3JkWydnb29kX25hbWUnXSksCiAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IHN0cihyZWNvcmRbJ2lkX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnaWRfcHJvcGVydGllcyc6IHN0cihyZWNvcmRbJ2lkX3Byb3BlcnRpZXMnXSksCiAgICAgICAgICAgICAgICAncHJvcGVydGllc19uYW1lJzogc3RyKHJlY29yZFsncHJvcGVydGllc19uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IHN0cihyZWNvcmRbJ2lkX3NlcmllcyddKSwKICAgICAgICAgICAgICAgICdzZXJpZXNfbmFtZSc6IHN0cihyZWNvcmRbJ3Nlcmllc19uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX3VuaXQnOiBzdHIocmVjb3JkWydpZF91bml0J10pLAogICAgICAgICAgICAgICAgJ3VuaXRzX25hbWUnOiBzdHIocmVjb3JkWyd1bml0c19uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2NvZGVfYXJ0JzogJ9Ca0L7QtDogJyArIHN0cihyZWNvcmRbJ2NvZGUnXSksCiAgICAgICAgICAgICAgICAnY2VsbF9uYW1lJzogc3RyKHJlY29yZFsnY2VsbF9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX2NlbGwnOiBzdHIocmVjb3JkWydpZF9jZWxsJ10pLAoKICAgICAgICAgICAgICAgICdxdHR5Jzogc3RyKHJlY29yZFsncXR0eSddIGlmIHJlY29yZFsncXR0eSddIGlzIG5vdCBOb25lIGVsc2UgMCksCiAgICAgICAgICAgICAgICAncXR0eV9wbGFuJzogc3RyKHJlY29yZFsncXR0eV9wbGFuJ10gaWYgcmVjb3JkWydxdHR5X3BsYW4nXSBpcyBub3QgTm9uZSBlbHNlIDApLAogICAgICAgICAgICAgICAgJ3BpY3R1cmUnOiBwaWMKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZG9jX2RldGFpbF9saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgICAgICMg0J/RgNC40LfQvdCw0LosIGhhdmVfcXR0eV9wbGFuINCV0YHRgtGM0J/Qu9Cw0L3Qn9Ce0JrQntC70LjRh9C10YHRgtCy0YMgIC0gINCY0YHRgtC40L3QsCDQutC+0LPQtNCwINGB0YPQvNC80LAg0LrQvtC70L7QvdC60LggUXR0eV9wbGFuID4gMAogICAgICAgICMg0J/RgNC40LfQvdCw0LogIGhhdmVfbWFya19wbGFuICLQldGB0YLRjNCf0LvQsNC90JrQntC00L7QstCc0LDRgNC60LjRgNC+0LLQutC4IOKAkyDQmNGB0YLQuNC90LAsINC60L7Qs9C00LAg0LrQvtC70LjRh9C10YHRgtCy0L4g0YHRgtGA0L7QuiDRgtCw0LHQuy4gUlNfZG9jc19iYXJjb2RlcyDRgSDQt9Cw0LTQsNC90L3Ri9C8IGlkX2RvYyDQuCBpc19wbGFuICDQsdC+0LvRjNGI0LUg0L3Rg9C70Y8uCiAgICAgICAgIyDQn9GA0LjQt9C90LDQuiBoYXZlX3plcm9fcGxhbiAi0JXRgdGC0Ywg0YHRgtGA0L7QutC4INGC0L7QstCw0YDQsCDQsiDQtNC+0LrRg9C80LXQvdGC0LUiINCY0YHRgtC40L3QsCwg0LrQvtCz0LTQsCDQtdGB0YLRjCDQt9Cw0L/QvtC70L3QtdC90L3Ri9C1INGB0YLRgNC+0LrQuCDRgtC+0LLQsNGA0L7QsiDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgICAgICAjINCf0YDQuNC30L3QsNC6ICLQmtC+0L3RgtGA0L7Qu9C40YDQvtCy0LDRgtGMIiAgLSDQv9GA0LjQt9C90LDQuiDQtNC70Y8g0LTQvtC60YPQvNC10L3RgtCwLCDQvdCw0LTQviDQu9C4INC60L7QvdGC0YDQvtC70LjRgNC+0LLQsNGC0YwKCiAgICAgICAgcXRleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X3F0dHlfc3RyaW5nX2NvdW50X3F1ZXJ5KCkKICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgeydpZF9kb2MnOiBpZF9kb2N9KQogICAgICAgIGlmIG5vdCByZXM6CiAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhdmVfemVyb19wbGFuID0gcmVzWzBdWzBdID4gMCAgIyDQkiDQtNC+0LrRg9C80LXQvdGC0LUg0LXRgdGC0Ywg0YHRgtGA0L7QutC4CiAgICAgICAgICAgIGlmIGhhdmVfemVyb19wbGFuOgogICAgICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSByZXNbMF1bMV0gPiAwICAjINCSINC00L7QutGD0LzQtdC90YLQtSDQtdGB0YLRjCDQutC+0LvQstC+INC/0LvQsNC9CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgIyDQldGB0YLRjCDQu9C4INCyINC00L7QutGD0LzQtdC90YLQtSDQv9C70LDQvSDQv9C+INC60L7QtNCw0Lwg0LzQsNGA0LrQuNGA0L7QstC60LgKICAgICAgICBxdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfaGF2ZV9tYXJrX2NvZGVzX3F1ZXJ5KCkKICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgeydpZF9kb2MnOiBpZF9kb2MsICdpc19wbGFuJzogJzEnfSkKICAgICAgICBpZiBub3QgcmVzOgogICAgICAgICAgICBoYXZlX21hcmtfcGxhbiA9IEZhbHNlCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhdmVfbWFya19wbGFuID0gcmVzWzBdWzBdID4gMAogICAgZWxzZToKICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICBoYXNoTWFwLnB1dCgnaGF2ZV9xdHR5X3BsYW4nLCBzdHIoaGF2ZV9xdHR5X3BsYW4pKQogICAgaGFzaE1hcC5wdXQoJ2hhdmVfemVyb19wbGFuJywgc3RyKGhhdmVfemVyb19wbGFuKSkKICAgIGhhc2hNYXAucHV0KCdoYXZlX21hcmtfcGxhbicsIHN0cihoYXZlX21hcmtfcGxhbikpCiAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgnU0VMRUNUIGNvbnRyb2wgZnJvbSBSU19kb2NzICBXSEVSRSBpZF9kb2MgPSA/JywgKGlkX2RvYywpKQogICAgIyDQldGB0YLRjCDQu9C4INC60L7QvdGC0YDQvtC70Ywg0L/Qu9Cw0L3QsCDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgIGlmIHJlczoKICAgICAgICBpZiByZXNbMF1bMF06CiAgICAgICAgICAgIGlmIHJlc1swXVswXSBpbiBmYWxzZVZhbHVlTGlzdDoKICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnRmFsc2UnCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjb250cm9sID0gJ1RydWUnCgogICAgICAgICAgICAjIGNvbnRyb2wgPSByZXNbMF1bMF0gIydUcnVlJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbnRyb2wgPSAnRmFsc2UnCiAgICBlbHNlOgogICAgICAgIGNvbnRyb2wgPSAnRmFsc2UnCgogICAgaGFzaE1hcC5wdXQoJ2NvbnRyb2wnLCBjb250cm9sKQogICAgaGFzaE1hcC5wdXQoImRvY19nb29kcyIsIGpzb24uZHVtcHMoZG9jX2RldGFpbF9saXN0KSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBkb2NfYWRyX2RldGFpbHNfbGlzdGVuZXIoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICMgY3VycmVudF9zdHIgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAjIGN1cnJlbnRfY2FyZF9saXN0ID0gaGFzaE1hcC5nZXQoImRvY19nb29kcyIpCiAgICAjIGpsID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddCiAgICAjIGlmIG5vdCBjdXJyZW50X2NhcmRfbGlzdCA9PSBOb25lOgogICAgIyAgICAgamxpc3QgPSBqc29uLmxvYWRzKGN1cnJlbnRfY2FyZF9saXN0KQogICAgIyAgICAgY3VycmVudF9lbGVtID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0ciktMV0KICAgICMgZWxzZToKICAgICMgICAgIGN1cnJlbnRfZWxlbSA9IE5vbmUKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykKICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKCiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImRvY19nb29kcyIpKQogICAgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY3VycmVudF9zdHIpXQogICAgICAgIGhhc2hNYXAucHV0KCJEb2NfZGF0YSIsCiAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5nZXQoJ2RvY190eXBlJykgKyAnIOKElicgKyBoYXNoTWFwLmdldCgnZG9jX24nKSArCiAgICAgICAgICAgICAgICAgICAgJyDQvtGCJyArIGhhc2hNYXAuZ2V0KCdkb2NfZGF0ZScpKQogICAgICAgIGhhc2hNYXAucHV0KCJjdXJyZW50X2NlbGxfbmFtZSIsICfQr9GH0LXQudC60LA6ICcgKyAgY3VycmVudF9lbGVtWydjZWxsX25hbWUnXSkKICAgICAgICBoYXNoTWFwLnB1dCgnaWRfY2VsbCcsIGN1cnJlbnRfZWxlbVsnaWRfY2VsbCddKQogICAgICAgIGhhc2hNYXAucHV0KCJHb29kIiwgY3VycmVudF9lbGVtWydnb29kX25hbWUnXSkKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eV9wbGFuIiwgc3RyKGN1cnJlbnRfZWxlbVsncXR0eV9wbGFuJ10pKQogICAgICAgIGlmIG5vdCBjdXJyZW50X2VsZW1bJ3F0dHknXTogICMgb3IgZmxvYXQoY3VycmVudF9lbGVtWydxdHR5J10pID09IDA6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJxdHR5IiwgJycpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgZmxvYXQoY3VycmVudF9lbGVtWydxdHR5J10pID09IDA6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsICcnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoInF0dHkiLCBzdHIoY3VycmVudF9lbGVtWydxdHR5J10pKQogICAgICAgIGhhc2hNYXAucHV0KCdrZXknLCBjdXJyZW50X2VsZW1bJ2tleSddKQoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQotC+0LLQsNGAINCy0YvQsdC+0YAiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gIkJBQ0tfQlVUVE9OIjoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2JhcmNvZGVzIjoKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dEaWFsb2ciLCAi0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCIpCgogICAgIyBlbGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKCiAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJyBvciBoYXNoTWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgY3VycmVudF9jZWxsID0gaGFzaE1hcC5nZXQoJ2N1cnJlbnRfY2VsbCcpCgogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19hZHJfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdmbGRfYmFyY29kZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpCgogICAgICAgIGRvY19jZWxsID0gZG9jLmZpbmRfY2VsbChkb2MsIGJhcmNvZGUpCiAgICAgICAgaWYgbm90IGN1cnJlbnRfY2VsbCBhbmQgbm90IGRvY19jZWxsOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnYmVlcF9kdXJhdGlvbiAnLCByc19zZXR0aW5ncy5nZXQoJ2JlZXBfZHVyYXRpb24nKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoImJlZXAiLCByc19zZXR0aW5ncy5nZXQoJ3NpZ25hbF9udW0nKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Cd0LUg0L3QsNC50LTQtdC90LAg0Y/Rh9C10LnQutCwJykKICAgICAgICAgICAgcmV0dXJuIGhhc2hNYXAKCiAgICAgICAgaWYgZG9jX2NlbGw6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdjdXJyZW50X2NlbGwnLCBkb2NfY2VsbFsnbmFtZSddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9jZWxsX2lkJywgZG9jX2NlbGxbJ2lkJ10pCiAgICAgICAgICAgIHJldHVybiBoYXNoTWFwCgoKICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IGhhc2hNYXAuZ2V0KCdoYXZlX3F0dHlfcGxhbicpCiAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBoYXNoTWFwLmdldCgnaGF2ZV96ZXJvX3BsYW4nKQogICAgICAgIGhhdmVfbWFya19wbGFuID0gaGFzaE1hcC5nZXQoJ2hhdmVfbWFya19wbGFuJykKICAgICAgICBjb250cm9sID0gaGFzaE1hcC5nZXQoJ2NvbnRyb2wnKQogICAgICAgIHJlcyA9IGRvYy5wcm9jZXNzX3RoZV9iYXJjb2RlKGRvYywgYmFyY29kZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZXZhbChoYXZlX3F0dHlfcGxhbiksIGV2YWwoaGF2ZV96ZXJvX3BsYW4pLCBldmFsKGNvbnRyb2wpLCAgY3VycmVudF9jZWxsKQogICAgICAgIGlmIHJlcyA9PSBOb25lOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2Nhbm5lZF9iYXJjb2RlJywgYmFyY29kZSkKICAgICAgICAgICAgIyBzdUNsYXNzLnVyb3ZvX3NldF9sb2NrX3RyaWdnZXIoVHJ1ZSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J7RiNC40LHQutCwINGB0LrQsNC90LXRgNCwJykKICAgICAgICAgICAgIyBoYXNoTWFwLnB1dCgndG9hc3QnLAogICAgICAgICAgICAjICAgICAgICAgICAgICfQqNGC0YDQuNGFINC60L7QtCDQvdC1INC30LDRgNC10LPQuNGB0YLRgNC40YDQvtCy0LDQvSDQsiDQsdCw0LfQtSDQtNCw0L3QvdGL0YUuINCf0YDQvtCy0LXRgNGM0YLQtSDRgtC+0LLQsNGAINC40LvQuCDQstGL0L/QvtC70L3QuNGC0LUg0L7QsdC80LXQvSDQtNCw0L3QvdGL0LzQuCcpCiAgICAgICAgZWxpZiByZXNbJ0Vycm9yJ106CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdiZWVwX2R1cmF0aW9uICcsIHJzX3NldHRpbmdzLmdldCgnYmVlcF9kdXJhdGlvbicpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgiYmVlcCIsIHJzX3NldHRpbmdzLmdldCgnc2lnbmFsX251bScpKQogICAgICAgICAgICBpZiByZXNbJ0Vycm9yJ10gPT0gJ0FscmVhZHlTY2FubmVkJzoKCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnYmFyY29kZScsIGpzb24uZHVtcHMoeydiYXJjb2RlJzogcmVzWydCYXJjb2RlJ10sICdkb2NfaW5mbyc6IHJlc1snZG9jX2luZm8nXX0pKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0KPQtNCw0LvQtdC90LjQtSDRiNGC0YDQuNGF0LrQvtC00LAnKQogICAgICAgICAgICBlbGlmIHJlc1snRXJyb3InXSA9PSAnUXVhbnRpdHlQbGFuUmVhY2hlZCc6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCByZXNbJ0Rlc2NyJ10pCiAgICAgICAgICAgIGVsaWYgcmVzWydFcnJvciddID09ICdaZXJvX3BsYW5fZXJyb3InOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgcmVzWydEZXNjciddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgcmVzWydEZXNjciddICkgICMrICcgJysgcmVzWydCYXJjb2RlJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0KLQvtCy0LDRgCDQtNC+0LHQsNCy0LvQtdC9INCyINC00L7QutGD0LzQtdC90YInKQogICAgICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RvY19tYXJrX3ZlcmlmaWVkJzoKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfYWRyX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICBkb2MubWFya192ZXJpZmllZChkb2MsIDEpCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgtGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2NlbGxfaWQnKToKICAgICAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ2N1cnJlbnRfY2VsbCcpCiAgICAgICAgICAgIGhhc2hNYXAucmVtb3ZlKCdjdXJyZW50X2NlbGxfaWQnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2NsZWFyX2NlbGwnOgogICAgICAgIGhhc2hNYXAucmVtb3ZlKCdjdXJyZW50X2NlbGwnKQogICAgICAgIGhhc2hNYXAucmVtb3ZlKCdjdXJyZW50X2NlbGxfaWQnKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zZWxlY3RfY2VsbCc6ICPQmtC90L7Qv9C60LAg0LLRi9Cx0YDQsNGC0Ywg0Y/Rh9C10LnQutGDCgogICAgICAgIGhhc2hNYXAucmVtb3ZlKCdjdXJyZW50X2NlbGwnKQogICAgICAgIGhhc2hNYXAucmVtb3ZlKCdjdXJyZW50X2NlbGxfaWQnKQogICAgICAgIGhhc2hNYXAucmVtb3ZlKCdTZWFyY2hTdHJpbmcnKQogICAgICAgIGhhc2hNYXAucHV0KCd0YWJsZV9mb3Jfc2VsZWN0JywgJ1JTX2NlbGxzJykgI9Ci0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfY2VsbF92YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCduYW1lO2JhcmNvZGUnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKCiAgICBlbGlmIGxpc3RlbmVyID09ICdzZWxlY3RfY2VsbF92YWx1ZSc6CiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfaWQnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRfY2VsbF9pZCcsaGFzaE1hcC5nZXQoJ2N1cnJlbnRfaWQnKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRfY2VsbCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKCiAgICBlbGlmIGxpc3RlbmVyID09J0xheW91dEFjdGlvbic6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDRgdGC0YDQvtC60LgKICAgICAgICBjdXJyZW50X3N0ciA9IGludChoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpKQogICAgICAgIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgiZG9jX2dvb2RzIikpCiAgICAgICAgY3VycmVudF9lbGVtID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2N1cnJlbnRfc3RyXQogICAgICAgIGlmIGN1cnJlbnRfZWxlbS5nZXQoJ2dyb3VwJyk6CiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtjdXJyZW50X3N0cisxXQogICAgICAgICMKICAgICAgICBpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Cj0LTQsNC70LjRgtGMINGB0YLRgNC+0LrRgyc6CgogICAgICAgICAgICBpZiBjdXJyZW50X2VsZW1bJ2tleSddOgogICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoJ0RFTEVURSBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIFdIRVJFIGlkID0gPycsIChjdXJyZW50X2VsZW1bJ2tleSddLCkpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsJycpCiAgICAgICAgZWxpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9CY0LfQvNC10L3QuNGC0Ywg0Y/Rh9C10LnQutGDJzoKCiAgICAgICAgICAgIHBhc3MKCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fYWRkX3N0cmluZyc6CgogICAgICAgIGhhc2hNYXAucHV0KCJEb2NfZGF0YSIsCiAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5nZXQoJ2RvY190eXBlJykgKyAnIOKElicgKyBoYXNoTWFwLmdldCgnZG9jX24nKSArCiAgICAgICAgICAgICAgICAgICAgJyDQvtGCJyArIGhhc2hNYXAuZ2V0KCdkb2NfZGF0ZScpKQogICAgICAgIGhhc2hNYXAucHV0KCJHb29kIiwgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnRpZXMiLCAnJykKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eV9wbGFuIiwgJycpCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0L7QstCw0YAiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9yb3dzX2ZpbHRlcl9vbic6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3Jvd3NfZmlsdGVyJywgJzEnKQogICAgICAgIGhhc2hNYXAucHV0KCdSZWZyZXNoU2NyZWVuJywnJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9yb3dzX2ZpbHRlcl9vZmYnOgogICAgICAgIGhhc2hNYXAucmVtb3ZlKCdyb3dzX2ZpbHRlcicpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1JlZnJlc2hTY3JlZW4nLCcnKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRvY3Nfb25fc2VsZWN0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoImxpc3RlbmVyIikKCiAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImRvY0NhcmRzIikpCiAgICAgICAgY3VycmVudF9kb2MgPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KCiAgICAgICAgIyBpZF9kb2MgPSBjdXJyZW50X2RvY1sna2V5J10KICAgICAgICBoYXNoTWFwLnB1dCgnaWRfZG9jJywgY3VycmVudF9kb2NbJ2tleSddKQogICAgICAgIGhhc2hNYXAucHV0KCdkb2NfdHlwZScsIGN1cnJlbnRfZG9jWyd0eXBlJ10pCiAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY19uJywgY3VycmVudF9kb2NbJ251bWJlciddKQogICAgICAgIGhhc2hNYXAucHV0KCdkb2NfZGF0ZScsIGN1cnJlbnRfZG9jWydkYXRhJ10pCiAgICAgICAgaGFzaE1hcC5wdXQoJ3dhcmVob3VzZScsIGN1cnJlbnRfZG9jWyd3YXJlaG91c2UnXSkKICAgICAgICBoYXNoTWFwLnB1dCgnY291bnRyYWdlbnQnLCBjdXJyZW50X2RvY1snY291bnRyYWdlbnQnXSkKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImRvY190eXBlX2NsaWNrIjoKICAgICAgICBscyA9IHJlZmlsbF9kb2NzX2xpc3QoaGFzaE1hcC5nZXQoJ2RvY190eXBlX2NsaWNrJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY0NhcmRzJywgbHMpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0JTQvtC60YPQvNC10L3RgtGLJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X2RvYyA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImNhcmRfZGF0YSIpKQogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19kb2MKICAgICAgICBkb2MuaWRfZG9jID0gY3VycmVudF9kb2NbJ2tleSddCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAnQ2hlY2tCb3gxJzoKICAgICAgICAgICAgaWYgY3VycmVudF9kb2NbJ2NvbXBsZXRlZCddID09ICdmYWxzZSc6CiAgICAgICAgICAgICAgICBkb2MubWFya192ZXJpZmllZChkb2MsIDEpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkb2MubWFya192ZXJpZmllZChkb2MsIDApCgogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQn9C+0LTRgtCy0LXRgNC00LjRgtGMJzoKICAgICAgICAgICAgZG9jLm1hcmtfdmVyaWZpZWQoZG9jLCAxKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICBkb2MuY2xlYXJfYmFyY29kZV9kYXRhKGRvYykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9CU0LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAg0Lgg0LzQsNGA0LrQuNGA0L7QstC60Lgg0L7Rh9C40YnQtdC90YsnKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQo9C00LDQu9C40YLRjCc6CiAgICAgICAgICAgIGRvYy5kZWxldGVfZG9jKGRvYykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0JTQvtC60YPQvNC10L3RgtGLJykKICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KHQutCw0L3QuNGA0L7QstCw0YLRjCDRiNGC0YDQuNGF0LrQvtC00Ysg0L/QvtGC0L7QutC+0LwnOgoKICAgICAgICAgICAgIyBpZF9kb2MgPSBjdXJyZW50X2RvY1sna2V5J10KICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2lkX2RvYycsIGN1cnJlbnRfZG9jWydrZXknXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY190eXBlJywgY3VycmVudF9kb2NbJ3R5cGUnXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY19uJywgY3VycmVudF9kb2NbJ251bWJlciddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2RhdGUnLCBjdXJyZW50X2RvY1snZGF0YSddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnd2FyZWhvdXNlJywgY3VycmVudF9kb2NbJ3dhcmVob3VzZSddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY291bnRyYWdlbnQnLCBjdXJyZW50X2RvY1snY291bnRyYWdlbnQnXSkKCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywn0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9hZGRfZG9jIjoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndC+0LLRi9C5INC00L7QutGD0LzQtdC90YInKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J/Qu9C40YLQutC4JykKICAgICAgICAjIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgICAgICMgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QvtCy0YvQuSDQtNC+0LrRg9C80LXQvdGCJykKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRvY19kZXRhaWxzX2xpc3RlbmVyKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgICMg0J3QsNGF0L7QtNC40LwgSUQg0LTQvtC60YPQvNC10L3RgtCwCiAgICAjIGN1cnJlbnRfc3RyID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfcG9zaXRpb24iKQogICAgIyBjdXJyZW50X2NhcmRfbGlzdCA9IGhhc2hNYXAuZ2V0KCJkb2NfZ29vZHMiKQogICAgIyBqbCA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXQogICAgIyBpZiBub3QgY3VycmVudF9jYXJkX2xpc3QgPT0gTm9uZToKICAgICMgICAgIGpsaXN0ID0ganNvbi5sb2FkcyhjdXJyZW50X2NhcmRfbGlzdCkKICAgICMgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY3VycmVudF9zdHIpLTFdCiAgICAjIGVsc2U6CiAgICAjICAgICBjdXJyZW50X2VsZW0gPSBOb25lCiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CgogICAgICAgICMg0J3QsNGF0L7QtNC40LwgSUQg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgY3VycmVudF9zdHIgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAgICAgamxpc3QgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJkb2NfZ29vZHMiKSkKICAgICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICBoYXNoTWFwLnB1dCgiRG9jX2RhdGEiLAogICAgICAgICAgICAgICAgICAgIGhhc2hNYXAuZ2V0KCdkb2NfdHlwZScpICsgJyDihJYnICsgaGFzaE1hcC5nZXQoJ2RvY19uJykgKwogICAgICAgICAgICAgICAgICAgICcg0L7RgicgKyBoYXNoTWFwLmdldCgnZG9jX2RhdGUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgiR29vZCIsIGN1cnJlbnRfZWxlbVsnZ29vZF9uYW1lJ10pCiAgICAgICAgaGFzaE1hcC5wdXQoInF0dHlfcGxhbiIsIHN0cihjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddKSkKICAgICAgICBpZiBub3QgY3VycmVudF9lbGVtWydxdHR5J106ICAjIG9yIGZsb2F0KGN1cnJlbnRfZWxlbVsncXR0eSddKSA9PSAwOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsICcnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIGZsb2F0KGN1cnJlbnRfZWxlbVsncXR0eSddKSA9PSAwOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoInF0dHkiLCAnJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCJxdHR5Iiwgc3RyKGN1cnJlbnRfZWxlbVsncXR0eSddKSkKICAgICAgICBoYXNoTWFwLnB1dCgna2V5JywgY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICBoYXNoTWFwLnB1dCgncHJpY2UnLCBjdXJyZW50X2VsZW1bJ3ByaWNlJ10pCiAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlX3R5cGUnLCBjdXJyZW50X2VsZW1bJ3ByaWNlX25hbWUnXSkKICAgICAgICAjINCk0L7RgNC80LjRgNGD0LXQvCDRgtCw0LHQu9C40YbRgyBRUiDQutC+0LTQvtCyLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2JhcmNvZGVfcXVlcnkoKQogICAgICAgIGFyZ3MgPSBkaWN0KGlkX2dvb2Q9Y3VycmVudF9lbGVtWydpZF9nb29kJ10sIGlkX3Byb3BlcnR5PWN1cnJlbnRfZWxlbVsnaWRfcHJvcGVydGllcyddLAogICAgICAgICAgICAgICAgICAgIGlkX3Nlcmllcz1jdXJyZW50X2VsZW1bJ2lkX3NlcmllcyddLCBpZF91bml0PWN1cnJlbnRfZWxlbVsnaWRfdW5pdCddLCBpZF9kb2M9aGFzaE1hcC5nZXQoJ2lkX2RvYycpKQoKICAgICAgICBjYXJkcyA9IHVpX2Zvcm1fZGF0YS5nZXRfYmFyY29kZV9jYXJkKHJzX3NldHRpbmdzKQogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3MsIFRydWUpCiAgICAgICAgIyDQpNC+0YDQvNC40YDRg9C10Lwg0YHQv9C40YHQvtC6INC60LDRgNGC0L7Rh9C10Log0LHQsNGA0LrQvtC00L7QsgogICAgICAgIGNhcmRzWydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXSA9IFtdCiAgICAgICAgZm9yIGVsIGluIHJlczoKICAgICAgICAgICAgIyBiYXJjb2RlX2RhdGEgPSB1aV9iYXJjb2Rlcy5nZXRfZ3Rpbl9zZXJpYWxfZnJvbV9kYXRhbWF0cml4KGVsWydiYXJjb2RlJ10pCiAgICAgICAgICAgIGlmIGVsWydhcHByb3ZlZCddID09ICdUcnVlJyBvciBlbFsnYXBwcm92ZWQnXSA9PSAnMScgb3IgZWxbJ2FwcHJvdmVkJ10gPT0gJ3RydWUnOgogICAgICAgICAgICAgICAgcGljdHVyZSA9ICcjZjAwYycKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHBpY3R1cmUgPSAnJwogICAgICAgICAgICByb3cgPSB7CiAgICAgICAgICAgICAgICAnYmFyY29kZSc6IGVsWydtYXJrX2NvZGUnXSwKICAgICAgICAgICAgICAgICdwaWN0dXJlJzogcGljdHVyZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhcmRzWydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXS5hcHBlbmQocm93KQogICAgICAgIGhhc2hNYXAucHV0KCJiYXJjb2RlX2NhcmRzIiwganNvbi5kdW1wcyhjYXJkcykpCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0L7QstCw0YAg0LLRi9Cx0L7RgCIpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fYWRkX3N0cmluZyc6CgogICAgICAgIGhhc2hNYXAucHV0KCJEb2NfZGF0YSIsCiAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5nZXQoJ2RvY190eXBlJykgKyAnIOKElicgKyBoYXNoTWFwLmdldCgnZG9jX24nKSArCiAgICAgICAgICAgICAgICAgICAgJyDQvtGCJyArIGhhc2hNYXAuZ2V0KCdkb2NfZGF0ZScpKQogICAgICAgIGhhc2hNYXAucHV0KCJHb29kIiwgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnRpZXMiLCAnJykKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eV9wbGFuIiwgJycpCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0L7QstCw0YAiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gIkJBQ0tfQlVUVE9OIjoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2JhcmNvZGVzIjoKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dEaWFsb2ciLCAi0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCIpCgogICAgIyBlbGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKCiAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJyBvciBoYXNoTWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgZG9jID0gdWlfZ2xvYmFsLlJzX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICBpZiBoYXNoTWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgICAgIGJhcmNvZGUgPSBoYXNoTWFwLmdldCgnZmxkX2JhcmNvZGUnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJhcmNvZGUgPSBoYXNoTWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQoKICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IGhhc2hNYXAuZ2V0KCdoYXZlX3F0dHlfcGxhbicpCiAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBoYXNoTWFwLmdldCgnaGF2ZV96ZXJvX3BsYW4nKQogICAgICAgIGhhdmVfbWFya19wbGFuID0gaGFzaE1hcC5nZXQoJ2hhdmVfbWFya19wbGFuJykKICAgICAgICBjb250cm9sID0gaGFzaE1hcC5nZXQoJ2NvbnRyb2wnKQogICAgICAgIHJlcyA9IGRvYy5wcm9jZXNzX3RoZV9iYXJjb2RlKGRvYywgYmFyY29kZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZXZhbChoYXZlX3F0dHlfcGxhbiksIGV2YWwoaGF2ZV96ZXJvX3BsYW4pLCBldmFsKGNvbnRyb2wpLCBldmFsKGhhdmVfbWFya19wbGFuKSkKICAgICAgICBpZiByZXMgPT0gTm9uZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3NjYW5uZWRfYmFyY29kZScsIGJhcmNvZGUpCiAgICAgICAgICAgICMgc3VDbGFzcy51cm92b19zZXRfbG9ja190cmlnZ2VyKFRydWUpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Ce0YjQuNCx0LrQsCDRgdC60LDQvdC10YDQsCcpCiAgICAgICAgICAgICMgaGFzaE1hcC5wdXQoJ3RvYXN0JywKICAgICAgICAgICAgIyAgICAgICAgICAgICAn0KjRgtGA0LjRhSDQutC+0LQg0L3QtSDQt9Cw0YDQtdCz0LjRgdGC0YDQuNGA0L7QstCw0L0g0LIg0LHQsNC30LUg0LTQsNC90L3Ri9GFLiDQn9GA0L7QstC10YDRjNGC0LUg0YLQvtCy0LDRgCDQuNC70Lgg0LLRi9C/0L7Qu9C90LjRgtC1INC+0LHQvNC10L0g0LTQsNC90L3Ri9C80LgnKQogICAgICAgIGVsaWYgcmVzWydFcnJvciddOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnYmVlcF9kdXJhdGlvbiAnLCByc19zZXR0aW5ncy5nZXQoJ2JlZXBfZHVyYXRpb24nKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoImJlZXAiLCByc19zZXR0aW5ncy5nZXQoJ3NpZ25hbF9udW0nKSkKICAgICAgICAgICAgaWYgcmVzWydFcnJvciddID09ICdBbHJlYWR5U2Nhbm5lZCc6CgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGUnLCBqc29uLmR1bXBzKHsnYmFyY29kZSc6IHJlc1snQmFyY29kZSddLCAnZG9jX2luZm8nOiByZXNbJ2RvY19pbmZvJ119KSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cj0LTQsNC70LXQvdC40LUg0YjRgtGA0LjRhdC60L7QtNCwJykKICAgICAgICAgICAgZWxpZiByZXNbJ0Vycm9yJ10gPT0gJ1F1YW50aXR5UGxhblJlYWNoZWQnOgoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsIHJlc1snRGVzY3InXSkKICAgICAgICAgICAgZWxpZiByZXNbJ0Vycm9yJ10gPT0gJ1plcm9fcGxhbl9lcnJvcic6CgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgcmVzWydEZXNjciddKQogICAgICAgICAgICBlbHNlOgoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsIHJlc1snRGVzY3InXSApICAjKyAnICcrIHJlc1snQmFyY29kZSddCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Ci0L7QstCw0YAg0LTQvtCx0LDQstC70LXQvSDQsiDQtNC+0LrRg9C80LXQvdGCJykKICAgICAgICAjIGhhc2hNYXAucHV0KCd0b2FzdCcsJzEnKQogICAgICAgICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSDQktGA0LXQvNC10L3QvdC+CiAgICAgICAgdXJsID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKICAgICAgICBxdGV4dCA9ICcnJ1NFTEVDVCBpZF9kb2MgRlJPTSBSU19kb2NzIFdIRVJFIHZlcmlmaWVkID0gMScnJwogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCBOb25lLCBUcnVlKQoKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIGRvY19saXN0ID0gW10KICAgICAgICAgICAgZm9yIGVsIGluIHJlczoKICAgICAgICAgICAgICAgIGRvY19saXN0LmFwcGVuZCgnIicgKyBlbFsnaWRfZG9jJ10gKyAnIicpCiAgICAgICAgICAgIGRvY19pbl9zdHIgPSAnLCcuam9pbihkb2NfbGlzdCkKICAgICAgICAgICAgIyBodHBwYXJhbXMgPSB7J3VzZXJuYW1lJzpoYXNoTWFwLmdldCgnb25saW5lVXNlcicpLCAncGFzc3dvcmQnOmhhc2hNYXAuZ2V0KCdvbmxpbmVQYXNzJyksICd1cmwnOnVybH0KICAgICAgICAgICAgYW5zd2VyID0gaHR0cF9leGNoYW5nZS5wb3N0X2NoYW5nZXNfdG9fc2VydmVyKGRvY19pbl9zdHIsIHVybCkKICAgICAgICAgICAgaWYgYW5zd2VyLmdldCgnRXJyb3InKSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHJzX3NldHRpbmdzLnB1dCgnZXJyb3JfbG9nJywgc3RyKGFuc3dlci5nZXQoJ0Vycm9yJykpLCBUcnVlKQoKICAgICAgICAgICAgcXRleHQgPSBmJ1VQREFURSBSU19kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIE5vbmUsIEZhbHNlKQogICAgICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOgogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19kb2MKICAgICAgICBkb2MuaWRfZG9jID0gaGFzaE1hcC5nZXQoJ2lkX2RvYycpCiAgICAgICAgZG9jLm1hcmtfdmVyaWZpZWQoZG9jLCAxKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnTGF5b3V0QWN0aW9uJzoKICAgICAgICBsYXlvdXRfbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgnbGF5b3V0X2xpc3RlbmVyJykKICAgICAgICBpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Cj0LTQsNC70LjRgtGMINGB0YLRgNC+0LrRgyc6CiAgICAgICAgICAgIGN1cnJlbnRfc3RyID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfcG9zaXRpb24iKQogICAgICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImRvY19nb29kcyIpKQogICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICAgICAgaWRfc3RyID0gY3VycmVudF9lbGVtWydrZXknXQoKICAgICAgICAgICAgcXRleHQgPSAnREVMRVRFIEZST00gUlNfZG9jc190YWJsZSBXSEVSRSBpZD0/JwogICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwoaWRfc3RyLCkpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcm93c19maWx0ZXJfb24nOgogICAgICAgIGhhc2hNYXAucHV0KCdyb3dzX2ZpbHRlcicsICcxJykKICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsJycpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcm93c19maWx0ZXJfb2ZmJzoKICAgICAgICBoYXNoTWFwLnJlbW92ZSgncm93c19maWx0ZXInKQogICAgICAgIGhhc2hNYXAucHV0KCdSZWZyZXNoU2NyZWVuJywnJykKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRlbGV0ZV9iYXJjb2RlX3NjcmVlbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICAjINCd0LDRhdC+0LTQuNC8IElEINC00L7QutGD0LzQtdC90YLQsAogICAgYmFyY29kZV9kYXRhID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgnYmFyY29kZScpKVsnYmFyY29kZSddCiAgICAjINCd0LDQudC00LXQvCDQvdGD0LbQvdGL0LUg0L/QvtC70Y8g0LfQsNC/0YDQvtGB0L7QvCDQuiDQsdCw0LfQtQogICAgcXRleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X21hcmtjb2RlX3F1ZXJ5KCkKICAgIGFyZ3MgPSB7J2lkX2RvYyc6IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKSwKICAgICAgICAgICAgJ0dUSU4nOiBiYXJjb2RlX2RhdGFbJ0dUSU4nXSwgJ1Nlcmllcyc6IGJhcmNvZGVfZGF0YVsnU0VSSUFMJ119CgogICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIGFyZ3MsIFRydWUpCgogICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRTdHInLCBqc29uLmR1bXBzKHJlc1swXSkpCiAgICBoYXNoTWFwLnB1dCgiQ3VyU3RyIiwgc3RyKHJlc1swXVsnQ3VyU3RyJ10pKQogICAgaGFzaE1hcC5wdXQoImdvb2QiLCByZXNbMF1bJ2dvb2RfbmFtZSddKQogICAgaGFzaE1hcC5wdXQoIidjb2RlX2FydCciLCByZXNbMF1bJ2dvb2RfY29kZSddKQogICAgaGFzaE1hcC5wdXQoInVuaXRfbmFtZSIsIHN0cihyZXNbMF1bJ3VuaXQnXSkpCiAgICBoYXNoTWFwLnB1dCgnYmFyY29kZV92YWx1ZScsICcwMScgKyBiYXJjb2RlX2RhdGFbJ0dUSU4nXSArICcyMScgKyBiYXJjb2RlX2RhdGFbJ1NFUklBTCddKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRlbGV0ZV9iYXJjb2RlX3NjcmVlbl9jbGljayhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCiAgICBpZiBsaXN0ZW5lciA9PSAiYnRuX2JhcmNvZGVfY2FuY2VsIjoKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9iYXJjb2RlX2RlbGV0ZSI6CiAgICAgICAgZG9jID0gdWlfZ2xvYmFsLlJzX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICBjdXJyZW50X2JhcmNvZGVfc3RyID0gaW50KGhhc2hNYXAuZ2V0KCJDdXJTdHIiKSkKICAgICAgICBlbCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoJ2N1cnJlbnRTdHInKSkKCiAgICAgICAgIyBkb2MuaWRfc3RyID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgIyBkb2MucXR0eSA9IGZsb2F0KGhhc2hNYXAuZ2V0KCdxdHR5JykpCiAgICAgICAgIyBkb2MudXBkYXRlX2RvY19zdHIoZG9jLCBoYXNoTWFwLmdldCgncHJpY2UnKSkKICAgICAgICBxdWVyeV90ZXh0ID0gJ1VwZGF0ZSAgUlNfZG9jc19iYXJjb2RlcyBTRVQgYXBwcm92ZWQ9PyBXaGVyZSBpZD0/JwogICAgICAgIHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsICgnMCcsIGN1cnJlbnRfYmFyY29kZV9zdHIpKQogICAgICAgIGRvYy51cGRhdGVfZG9jX3RhYmxlX2RhdGEoZG9jLCBlbCwgLTEpCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJCQUNLX0JVVFRPTiI6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgYWRyX2VsZW1fb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaGFzaE1hcC5wdXQoJ21tX2xvY2FsJywgJycpCiAgICByZXR1cm4gaGFzaE1hcAoKZGVmIGVsZW1fb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaGFzaE1hcC5wdXQoJ21tX2xvY2FsJywgJycpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBhZHJfZWxlbV9vbl9jbGljayhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCgoKICAgIGlmIGxpc3RlbmVyID09ICJidG5fb2siOgogICAgICAgICMgIyDQv9C+0LvRg9GH0LjQvCDRgtC10LrRg9GJ0YPRjiDRgdGC0YDQvtC60YMg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgIyBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfYWRyX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICAjIGlmIG5vdCBjdXJyZW50X3N0ciA9PSAnMCc6CiAgICAgICAgIyAgICAgamxpc3QgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJkb2NfZ29vZHMiKSkKICAgICAgICAjICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICAjICAgICBrZXkgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjICAgICBkb2MuaWRfc3RyID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgIyAuLi4g0Lgg0LfQsNC/0LjRiNC10Lwg0LXQtSDQsiDQsdCw0LfRgwogICAgICAgIHF0dHkgPSBoYXNoTWFwLmdldCgncXR0eScpCiAgICAgICAgZG9jLnF0dHkgPSBmbG9hdChxdHR5KSBpZiBxdHR5IGVsc2UgMAogICAgICAgIGVsZW1fZm9yX2FkZCA9eydpZF9nb29kJzpoYXNoTWFwLmdldCgnR29vZF9pZCcpLCAnaWRfcHJvcGVydHknOmhhc2hNYXAuZ2V0KCdwcm9wZXJ0aWVzX2lkJyksICdpZF9zZXJpZXMnOmhhc2hNYXAuZ2V0KCdzZXJpZXNfaWQnKSwgJ2lkX3VuaXQnOiBoYXNoTWFwLmdldCgndW5pdF9pZCcpfQoKICAgICAgICBkb2MudXBkYXRlX2RvY190YWJsZV9kYXRhKGRvYywgZWxlbV9mb3JfYWRkLCBxdHR5LCBoYXNoTWFwLmdldCgnY3VycmVudF9jZWxsX25hbWUnKSxoYXNoTWFwLmdldCgndGFibGVfdHlwZV9maWx0ZXInKSkgIyhkb2MsICkKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9jYW5jZWwiOgoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09ICJCQUNLX0JVVFRPTiI6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiIjoKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsIHN0cihmbG9hdChoYXNoTWFwLmdldCgncXR0eScpKSkpCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fZ29vZF9zZWxlY3QiOgogICAgICAgIGhhc2hNYXAucmVtb3ZlKCdTZWFyY2hTdHJpbmcnKQogICAgICAgIGhhc2hNYXAucHV0KCd0YWJsZV9mb3Jfc2VsZWN0JywgJ1JTX2dvb2RzJykgICMg0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9nb29kc192YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCAnbmFtZTthcnQnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDRgdC/0YDQsNCy0L7Rh9C90LjQunzQodC/0YDQsNCy0L7Rh9C90LjQuicpCiAgICAjLS0KICAgIGVsaWYgbGlzdGVuZXIgPT0gInNlbGVjdF9nb29kc192YWx1ZSI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ0dvb2QnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ0dvb2RfaWQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9pZCcpKQogICAgICAgICMg0J/RgNC4INCy0YvQsdC+0YDQtSDRgtC+0LLQsNGA0LAg0LfQsNC/0L7Qu9C90LjQvCDQtdC00LjQvdC40YbRgyDQuNC30LzQtdGA0LXQvdC40Y8g0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4KICAgICAgICBxdGV4dCA9ICcnJ1NlbGVjdCBSU19nb29kcy51bml0IGFzIHVuaXRfaWQsIAogICAgICAgICAgICAgICAgICAgIFJTX3VuaXRzLm5hbWUgCiAgICAgICAgICAgICAgICAgICAgRnJvbSBSU19nb29kcwogICAgICAgICAgICAgICAgICAgICAgTGVmdCBKb2luIFJTX3VuaXRzIG9uIFJTX3VuaXRzLmlkX293bmVyID0gUlNfZ29vZHMuaWQgYW5kIFJTX3VuaXRzLmlkID0gUlNfZ29vZHMudW5pdCAKICAgICAgICAgICAgICAgICAgICBXSEVSRSBSU19nb29kcy5pZCA9ID8nJycKICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJyksKSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd1bml0X2lkJywgcmVzWzBdWzBdKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgndW5pdCcsIHJlc1swXVsxXSkKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fcHJvcGVydGllcyI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1NlYXJjaFN0cmluZycsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfcHJvcGVydGllcycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfcHJvcGVydGllc192YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCAnbmFtZTtpZF9vd25lcicpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKICAgICMgLS0KICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9wcm9wZXJ0aWVzX3ZhbHVlJzoKICAgICAgICBoYXNoTWFwLnB1dCgncHJvcGVydGllcycsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgncHJvcGVydGllc19pZCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJykpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX3NlcmllcyI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfc2VyaWVzJykgICMg0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9zZXJpZXNfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWU7IGlkX293bmVyJykKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQogICAgICAgICNfXwogICAgZWxpZiBsaXN0ZW5lciA9PSAnc2VsZWN0X3Nlcmllc192YWx1ZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlcmllcycsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgnc2VyaWVzX2lkJywgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfaWQnKSkKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fdW5pdCI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1NlYXJjaFN0cmluZycsIGhhc2hNYXAuZ2V0KCdHb29kX2lkJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfdW5pdHMnKSAgIyDQotCw0LHQu9C40YbQsCDQtNC70Y8g0LLRi9Cx0L7RgNCwINC30L3QsNGH0LXQvdC40Y8KICAgICAgICBoYXNoTWFwLnB1dCgnU2V0UmVzdWx0TGlzdGVuZXInLCAnc2VsZWN0X3VuaXRfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWU7aWRfb3duZXInKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDRgdC/0YDQsNCy0L7Rh9C90LjQunzQodC/0YDQsNCy0L7Rh9C90LjQuicpCiAgICAgICAgI19fCiAgICBlbGlmIGxpc3RlbmVyID09ICdzZWxlY3RfdW5pdF92YWx1ZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3VuaXQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3VuaXRfaWQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9pZCcpKQogICAgI2J0bl9zZWxlY3RfY2VsbAogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX3NlbGVjdF9jZWxsIjoKICAgICAgICBoYXNoTWFwLnB1dCgnU2VhcmNoU3RyaW5nJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfY2VsbHMnKSAgIyDQotCw0LHQu9C40YbQsCDQtNC70Y8g0LLRi9Cx0L7RgNCwINC30L3QsNGH0LXQvdC40Y8KICAgICAgICBoYXNoTWFwLnB1dCgnU2V0UmVzdWx0TGlzdGVuZXInLCAnc2VsZWN0X2NlbGxfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWU7YmFyY29kZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKICAgICAgICAjX18KICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9jZWxsX3ZhbHVlJzoKICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9jZWxsX25hbWUnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRfY2VsbF9pZCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJykpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAicGhvdG8iOgoKICAgICAgICAjINCc0L7QttC90L4g0LLQvtC+0LHRidC1INGN0YLQvtCz0L4g0L3QtSDQtNC10LvQsNGC0Ywt0L7RgdGC0LDQstC70Y/RgtGMINC60LDQuiDQtdGB0YLRjC4g0K3RgtC+INC00LvRjyDQv9GA0LjQvNC10YDQsC4KICAgICAgICBpbWFnZV9maWxlID0gc3RyKAogICAgICAgICAgICBoYXNoTWFwLmdldCgicGhvdG9fcGF0aCIpKSAgIyAi0L/QtdGA0LXQvNC10L3QvdCw0Y8iKyJfcGF0aCIgLSDRgdGO0LTQsCDQv9C+0LzQtdGJ0LDQtdGC0YHRjyDQv9GD0YLRjCDQuiDQv9C+0LvRg9GH0LXQvdC90L7QuSDRhNC+0YLQvtCz0YDQsNGE0LjQuAoKICAgICAgICBpbWFnZSA9IEltYWdlLm9wZW4oaW1hZ2VfZmlsZSkKCiAgICAgICAgIyDRgdGA0LDQt9GDINGB0LTQtdC70LDQtdC8INGE0L7RgtC60YMgLSDQutCy0LDQtNGA0LDRgtC90L7QuSAtINGN0YLQviDQv9GA0L7RgdGC0L7QuSDQstCw0YDQuNCw0L3Rgi4g0JzQvtC20L3QviDRgdC00LXQu9Cw0YLRjCDQvdCw0L/RgNC40LzQtdGAINC+0YLQtNC10LvRjNC+INC80LjQvdC40LDRgtGO0YDRiyDQtNC70Y8g0YHQv9C40YHQutCwLCDRjdGC0L4g0L3QtdC80L3QvtCz0L4g0YHQu9C+0LbQvdC10LUKICAgICAgICBpbSA9IGltYWdlLnJlc2l6ZSgoNTAwLCA1MDApKQogICAgICAgIGltLnNhdmUoaW1hZ2VfZmlsZSkKCiAgICAgICAganBob3RvYXJyID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgicGhvdG9HYWxsZXJ5IikpCiAgICAgICAgaGFzaE1hcC5wdXQoInBob3RvR2FsbGVyeSIsIGpzb24uZHVtcHMoanBob3RvYXJyKSkKICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsanNvbi5kdW1wcyhqcGhvdG9hcnIpKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImdhbGxlcnlfY2hhbmdlIjogICMg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC80L7QttC10YIg0YPQtNCw0LvQuNGC0Ywg0YTQvtGC0L4g0LjQtyDQs9Cw0LvQtdGA0LXQuC4g0J3QvtCy0YvQuSDQvNCw0YHRgdC40LIg0L3QsNC00L4g0L/QvtC80LXRgdGC0LjRgtGMINC6INC00L7QutGD0LzQtdC90YLRgwoKICAgICAgICBpZiBoYXNoTWFwLmNvbnRhaW5zS2V5KCJwaG90b0dhbGxlcnkiKTogICMg0Y3RgtC4IDIg0L7QsdGA0LDQsdC+0YLRh9C40LrQsCAtINCw0L3QsNC70L7Qs9C40YfQvdGL0LUsINC/0YDQvtGB0YLQviDQtNC70Y8g0YDQsNC30L3Ri9GFINGB0L7QsdGL0YLQuNC5CiAgICAgICAgICAgIGpwaG90b2FyciA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoInBob3RvR2FsbGVyeSIpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgicGhvdG9HYWxsZXJ5IiwganNvbi5kdW1wcyhqcGhvdG9hcnIpKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsIiMyIitqc29uLmR1bXBzKGpwaG90b2FycikpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZWxlbV9vbl9jbGljayhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCgogICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgIyDQv9C+0LvRg9GH0LjQvCDRgtC10LrRg9GJ0YPRjiDRgdGC0YDQvtC60YMg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgY3VycmVudF9zdHIgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAgICAgI9CV0YHQu9C4INGB0YLRgNC+0LrQsCDQvdC1INGB0YPRidC10YHRgtCy0YPQtdGCLCDRgdC+0LfQtNCw0LTQuNC8INC10LUKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgICMgaWYgY3VycmVudF9zdHIgPT0nMCc6CiAgICAgICAgIyAgICAgcGFzcwogICAgICAgICMgICAgICNqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KICAgICAgICAjIGVsc2U6CiAgICAgICAgIyAgICAgamxpc3QgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJkb2NfZ29vZHMiKSkKICAgICAgICAjICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICAjICAgICBrZXkgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjICAgICBkb2MuaWRfc3RyID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgIyAuLi4g0Lgg0LfQsNC/0LjRiNC10Lwg0LXQtSDQsiDQsdCw0LfRgwoKICAgICAgICBxdHR5ID0gaGFzaE1hcC5nZXQoJ3F0dHknKQogICAgICAgIGRvYy5xdHR5ID0gZmxvYXQocXR0eSkgaWYgcXR0eSBlbHNlIDAKICAgICAgICBlbGVtX2Zvcl9hZGQgPSB7J2lkX2dvb2QnOiBoYXNoTWFwLmdldCgnR29vZF9pZCcpLCAnaWRfcHJvcGVydHknOiBoYXNoTWFwLmdldCgncHJvcGVydGllc19pZCcpLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogaGFzaE1hcC5nZXQoJ3Nlcmllc19pZCcpLCdpZF91bml0JzogaGFzaE1hcC5nZXQoJ3VuaXRfaWQnKX0KICAgICAgICBkb2MudXBkYXRlX2RvY190YWJsZV9kYXRhKGRvYywgZWxlbV9mb3JfYWRkLCBxdHR5KSAgIyAoZG9jLCApCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fY2FuY2VsIjoKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiQkFDS19CVVRUT04iOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKICAgIGVsaWYgbGlzdGVuZXIgPT0gIiI6CiAgICAgICAgaGFzaE1hcC5wdXQoInF0dHkiLCBzdHIoZmxvYXQoaGFzaE1hcC5nZXQoJ3F0dHknKSkpKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2dvb2Rfc2VsZWN0IjoKICAgICAgICBoYXNoTWFwLnJlbW92ZSgnU2VhcmNoU3RyaW5nJykKICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU19nb29kcycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfZ29vZHNfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDRgdC/0YDQsNCy0L7Rh9C90LjQunzQodC/0YDQsNCy0L7Rh9C90LjQuicpCiAgICAjLS0KICAgIGVsaWYgbGlzdGVuZXIgPT0gInNlbGVjdF9nb29kc192YWx1ZSI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ0dvb2QnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ0dvb2RfaWQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9pZCcpKQogICAgICAgICPQn9GA0Lgg0LLRi9Cx0L7RgNC1INGC0L7QstCw0YDQsCDQt9Cw0L/QvtC70L3QuNC8INC10LTQuNC90LjRhtGDINC40LfQvNC10YDQtdC90LjRjyDQv9C+INGD0LzQvtC70YfQsNC90LjRjgogICAgICAgIHF0ZXh0ID0gJycnU2VsZWN0IFJTX2dvb2RzLnVuaXQgYXMgdW5pdF9pZCwgCiAgICAgICAgICAgICAgICAgICAgUlNfdW5pdHMubmFtZSAKICAgICAgICAgICAgICAgICAgICBGcm9tIFJTX2dvb2RzCiAgICAgICAgICAgICAgICAgICAgICBMZWZ0IEpvaW4gUlNfdW5pdHMgb24gUlNfdW5pdHMuaWRfb3duZXIgPSBSU19nb29kcy5pZCBhbmQgUlNfdW5pdHMuaWQgPSBSU19nb29kcy51bml0IAogICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX2dvb2RzLmlkID0gPycnJwogICAgICAgIHJlcyA9ICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJyksKSkKICAgICAgICBpZiByZXM6CgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndW5pdF9pZCcsIHJlc1swXVswXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3VuaXQnLCByZXNbMF1bMV0pCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX3Byb3BlcnRpZXMiOgoKICAgICAgICBoYXNoTWFwLnB1dCgnU2VhcmNoU3RyaW5nJywgaGFzaE1hcC5nZXQoJ0dvb2RfaWQnKSkKICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU19wcm9wZXJ0aWVzJykgICMg0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9wcm9wZXJ0aWVzX3ZhbHVlJykKICAgICAgICBoYXNoTWFwLnB1dCgnZmlsdGVyX2ZpZWxkcycsICduYW1lO2lkX293bmVyJykKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQogICAgIyAtLQogICAgZWxpZiBsaXN0ZW5lciA9PSAnc2VsZWN0X3Byb3BlcnRpZXNfdmFsdWUnOgogICAgICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0aWVzJywgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfbmFtZScpKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9zZXJpZXMiOgogICAgICAgIGhhc2hNYXAucHV0KCd0YWJsZV9mb3Jfc2VsZWN0JywgJ1JTX3NlcmllcycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3Rfc2VyaWVzX3ZhbHVlJykKICAgICAgICBoYXNoTWFwLnB1dCgnZmlsdGVyX2ZpZWxkcycsICduYW1lJykKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQogICAgICAgICNfXwogICAgZWxpZiBsaXN0ZW5lciA9PSAnc2VsZWN0X3Nlcmllc192YWx1ZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlcmllcycsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl91bml0IjoKICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU191bml0cycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfdW5pdF92YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCAnbmFtZTtpZF9vd25lcicpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKICAgICAgICAjX18KICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF91bml0X3ZhbHVlJzoKICAgICAgICBoYXNoTWFwLnB1dCgndW5pdCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgndW5pdF9pZCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJykpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAicGhvdG8iOgoKICAgICAgICAjINCc0L7QttC90L4g0LLQvtC+0LHRidC1INGN0YLQvtCz0L4g0L3QtSDQtNC10LvQsNGC0Ywt0L7RgdGC0LDQstC70Y/RgtGMINC60LDQuiDQtdGB0YLRjC4g0K3RgtC+INC00LvRjyDQv9GA0LjQvNC10YDQsC4KICAgICAgICBpbWFnZV9maWxlID0gc3RyKAogICAgICAgICAgICBoYXNoTWFwLmdldCgicGhvdG9fcGF0aCIpKSAgIyAi0L/QtdGA0LXQvNC10L3QvdCw0Y8iKyJfcGF0aCIgLSDRgdGO0LTQsCDQv9C+0LzQtdGJ0LDQtdGC0YHRjyDQv9GD0YLRjCDQuiDQv9C+0LvRg9GH0LXQvdC90L7QuSDRhNC+0YLQvtCz0YDQsNGE0LjQuAoKICAgICAgICBpbWFnZSA9IEltYWdlLm9wZW4oaW1hZ2VfZmlsZSkKCiAgICAgICAgIyDRgdGA0LDQt9GDINGB0LTQtdC70LDQtdC8INGE0L7RgtC60YMgLSDQutCy0LDQtNGA0LDRgtC90L7QuSAtINGN0YLQviDQv9GA0L7RgdGC0L7QuSDQstCw0YDQuNCw0L3Rgi4g0JzQvtC20L3QviDRgdC00LXQu9Cw0YLRjCDQvdCw0L/RgNC40LzQtdGAINC+0YLQtNC10LvRjNC+INC80LjQvdC40LDRgtGO0YDRiyDQtNC70Y8g0YHQv9C40YHQutCwLCDRjdGC0L4g0L3QtdC80L3QvtCz0L4g0YHQu9C+0LbQvdC10LUKICAgICAgICBpbSA9IGltYWdlLnJlc2l6ZSgoNTAwLCA1MDApKQogICAgICAgIGltLnNhdmUoaW1hZ2VfZmlsZSkKCiAgICAgICAganBob3RvYXJyID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgicGhvdG9HYWxsZXJ5IikpCiAgICAgICAgaGFzaE1hcC5wdXQoInBob3RvR2FsbGVyeSIsIGpzb24uZHVtcHMoanBob3RvYXJyKSkKICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsanNvbi5kdW1wcyhqcGhvdG9hcnIpKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImdhbGxlcnlfY2hhbmdlIjogICMg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC80L7QttC10YIg0YPQtNCw0LvQuNGC0Ywg0YTQvtGC0L4g0LjQtyDQs9Cw0LvQtdGA0LXQuC4g0J3QvtCy0YvQuSDQvNCw0YHRgdC40LIg0L3QsNC00L4g0L/QvtC80LXRgdGC0LjRgtGMINC6INC00L7QutGD0LzQtdC90YLRgwoKICAgICAgICBpZiBoYXNoTWFwLmNvbnRhaW5zS2V5KCJwaG90b0dhbGxlcnkiKTogICMg0Y3RgtC4IDIg0L7QsdGA0LDQsdC+0YLRh9C40LrQsCAtINCw0L3QsNC70L7Qs9C40YfQvdGL0LUsINC/0YDQvtGB0YLQviDQtNC70Y8g0YDQsNC30L3Ri9GFINGB0L7QsdGL0YLQuNC5CiAgICAgICAgICAgIGpwaG90b2FyciA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoInBob3RvR2FsbGVyeSIpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgicGhvdG9HYWxsZXJ5IiwganNvbi5kdW1wcyhqcGhvdG9hcnIpKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsIiMyIitqc29uLmR1bXBzKGpwaG90b2FycikpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgYWRyX2VsZW1fdmlldl9vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBoYXNoTWFwLnB1dCgnbW1fbG9jYWwnLCAnJykKICAgIHJldHVybiBoYXNoTWFwCgpkZWYgZWxlbV92aWV2X29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGhhc2hNYXAucHV0KCdtbV9sb2NhbCcsICcnKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgYWRyX2VsZW1fdmlldl9vbl9jbGljayhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCgogICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgIyDQv9C+0LvRg9GH0LjQvCDRgtC10LrRg9GJ0YPRjiDRgdGC0YDQvtC60YMg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgY3VycmVudF9zdHIgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAgICAgZG9jID0gdWlfZ2xvYmFsLlJzX2Fkcl9kb2MKICAgICAgICBpZiBub3QgY3VycmVudF9zdHIgPT0gJzAnOgogICAgICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImRvY19nb29kcyIpKQogICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICAgICAga2V5ID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgICAgIGRvYy5pZF9zdHIgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjIC4uLiDQuCDQt9Cw0L/QuNGI0LXQvCDQtdC1INCyINCx0LDQt9GDCiAgICAgICAgcXR0eSA9IGhhc2hNYXAuZ2V0KCdxdHR5JykKICAgICAgICBkb2MucXR0eSA9IGZsb2F0KHF0dHkpIGlmIHF0dHkgZWxzZSAwCgogICAgICAgIGRvYy51cGRhdGVfZG9jX3N0cihkb2MpICMoZG9jLCApCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fY2FuY2VsIjoKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiQkFDS19CVVRUT04iOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKICAgIGVsaWYgbGlzdGVuZXIgPT0gIiI6CiAgICAgICAgaGFzaE1hcC5wdXQoInF0dHkiLCBzdHIoZmxvYXQoaGFzaE1hcC5nZXQoJ3F0dHknKSkpKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAicGhvdG8iOgoKICAgICAgICAjINCc0L7QttC90L4g0LLQvtC+0LHRidC1INGN0YLQvtCz0L4g0L3QtSDQtNC10LvQsNGC0Ywt0L7RgdGC0LDQstC70Y/RgtGMINC60LDQuiDQtdGB0YLRjC4g0K3RgtC+INC00LvRjyDQv9GA0LjQvNC10YDQsC4KICAgICAgICBpbWFnZV9maWxlID0gc3RyKAogICAgICAgICAgICBoYXNoTWFwLmdldCgicGhvdG9fcGF0aCIpKSAgIyAi0L/QtdGA0LXQvNC10L3QvdCw0Y8iKyJfcGF0aCIgLSDRgdGO0LTQsCDQv9C+0LzQtdGJ0LDQtdGC0YHRjyDQv9GD0YLRjCDQuiDQv9C+0LvRg9GH0LXQvdC90L7QuSDRhNC+0YLQvtCz0YDQsNGE0LjQuAoKICAgICAgICBpbWFnZSA9IEltYWdlLm9wZW4oaW1hZ2VfZmlsZSkKCiAgICAgICAgIyDRgdGA0LDQt9GDINGB0LTQtdC70LDQtdC8INGE0L7RgtC60YMgLSDQutCy0LDQtNGA0LDRgtC90L7QuSAtINGN0YLQviDQv9GA0L7RgdGC0L7QuSDQstCw0YDQuNCw0L3Rgi4g0JzQvtC20L3QviDRgdC00LXQu9Cw0YLRjCDQvdCw0L/RgNC40LzQtdGAINC+0YLQtNC10LvRjNC+INC80LjQvdC40LDRgtGO0YDRiyDQtNC70Y8g0YHQv9C40YHQutCwLCDRjdGC0L4g0L3QtdC80L3QvtCz0L4g0YHQu9C+0LbQvdC10LUKICAgICAgICBpbSA9IGltYWdlLnJlc2l6ZSgoNTAwLCA1MDApKQogICAgICAgIGltLnNhdmUoaW1hZ2VfZmlsZSkKCiAgICAgICAganBob3RvYXJyID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgicGhvdG9HYWxsZXJ5IikpCiAgICAgICAgaGFzaE1hcC5wdXQoInBob3RvR2FsbGVyeSIsIGpzb24uZHVtcHMoanBob3RvYXJyKSkKICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsanNvbi5kdW1wcyhqcGhvdG9hcnIpKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImdhbGxlcnlfY2hhbmdlIjogICMg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC80L7QttC10YIg0YPQtNCw0LvQuNGC0Ywg0YTQvtGC0L4g0LjQtyDQs9Cw0LvQtdGA0LXQuC4g0J3QvtCy0YvQuSDQvNCw0YHRgdC40LIg0L3QsNC00L4g0L/QvtC80LXRgdGC0LjRgtGMINC6INC00L7QutGD0LzQtdC90YLRgwoKICAgICAgICBpZiBoYXNoTWFwLmNvbnRhaW5zS2V5KCJwaG90b0dhbGxlcnkiKTogICMg0Y3RgtC4IDIg0L7QsdGA0LDQsdC+0YLRh9C40LrQsCAtINCw0L3QsNC70L7Qs9C40YfQvdGL0LUsINC/0YDQvtGB0YLQviDQtNC70Y8g0YDQsNC30L3Ri9GFINGB0L7QsdGL0YLQuNC5CiAgICAgICAgICAgIGpwaG90b2FyciA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoInBob3RvR2FsbGVyeSIpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgicGhvdG9HYWxsZXJ5IiwganNvbi5kdW1wcyhqcGhvdG9hcnIpKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsIiMyIitqc29uLmR1bXBzKGpwaG90b2FycikpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZWxlbV92aWV2X29uX2NsaWNrKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoImxpc3RlbmVyIikKCiAgICBpZiBsaXN0ZW5lciA9PSAiYnRuX29rIjoKICAgICAgICAjINC/0L7Qu9GD0YfQuNC8INGC0LXQutGD0YnRg9GOINGB0YLRgNC+0LrRgyDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICAj0JXRgdC70Lgg0YHRgtGA0L7QutCwINC90LUg0YHRg9GJ0LXRgdGC0LLRg9C10YIsINGB0L7Qt9C00LDQtNC40Lwg0LXQtQogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19kb2MKICAgICAgICBkb2MuaWRfZG9jID0gaGFzaE1hcC5nZXQoJ2lkX2RvYycpCiAgICAgICAgIyBpZiBjdXJyZW50X3N0ciA9PScwJzoKICAgICAgICAjICAgICBwYXNzCiAgICAgICAgICAgICNqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KICAgICAgICAjZWxzZToKICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImRvY19nb29kcyIpKQogICAgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY3VycmVudF9zdHIpXQogICAgICAgIGtleSA9IGludChjdXJyZW50X2VsZW1bJ2tleSddKQogICAgICAgIGRvYy5pZF9zdHIgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjIC4uLiDQuCDQt9Cw0L/QuNGI0LXQvCDQtdC1INCyINCx0LDQt9GDCgogICAgICAgIHF0dHkgPSBoYXNoTWFwLmdldCgncXR0eScpCiAgICAgICAgZG9jLnF0dHkgPSBmbG9hdChxdHR5KSBpZiBxdHR5IGVsc2UgMAoKICAgICAgICBkb2MudXBkYXRlX2RvY19zdHIoZG9jLCBoYXNoTWFwLmdldCgncHJpY2UnKSkgICMgKGRvYywgKQoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2NhbmNlbCI6CgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKICAgIGVsaWYgbGlzdGVuZXIgPT0gIkJBQ0tfQlVUVE9OIjoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09ICIiOgogICAgICAgIGhhc2hNYXAucHV0KCJxdHR5Iiwgc3RyKGZsb2F0KGhhc2hNYXAuZ2V0KCdxdHR5JykpKSkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gInBob3RvIjoKCiAgICAgICAgIyDQnNC+0LbQvdC+INCy0L7QvtCx0YnQtSDRjdGC0L7Qs9C+INC90LUg0LTQtdC70LDRgtGMLdC+0YHRgtCw0LLQu9GP0YLRjCDQutCw0Log0LXRgdGC0YwuINCt0YLQviDQtNC70Y8g0L/RgNC40LzQtdGA0LAuCiAgICAgICAgaW1hZ2VfZmlsZSA9IHN0cigKICAgICAgICAgICAgaGFzaE1hcC5nZXQoInBob3RvX3BhdGgiKSkgICMgItC/0LXRgNC10LzQtdC90L3QsNGPIisiX3BhdGgiIC0g0YHRjtC00LAg0L/QvtC80LXRidCw0LXRgtGB0Y8g0L/Rg9GC0Ywg0Log0L/QvtC70YPRh9C10L3QvdC+0Lkg0YTQvtGC0L7Qs9GA0LDRhNC40LgKCiAgICAgICAgaW1hZ2UgPSBJbWFnZS5vcGVuKGltYWdlX2ZpbGUpCgogICAgICAgICMg0YHRgNCw0LfRgyDRgdC00LXQu9Cw0LXQvCDRhNC+0YLQutGDIC0g0LrQstCw0LTRgNCw0YLQvdC+0LkgLSDRjdGC0L4g0L/RgNC+0YHRgtC+0Lkg0LLQsNGA0LjQsNC90YIuINCc0L7QttC90L4g0YHQtNC10LvQsNGC0Ywg0L3QsNC/0YDQuNC80LXRgCDQvtGC0LTQtdC70YzQviDQvNC40L3QuNCw0YLRjtGA0Ysg0LTQu9GPINGB0L/QuNGB0LrQsCwg0Y3RgtC+INC90LXQvNC90L7Qs9C+INGB0LvQvtC20L3QtdC1CiAgICAgICAgaW0gPSBpbWFnZS5yZXNpemUoKDUwMCwgNTAwKSkKICAgICAgICBpbS5zYXZlKGltYWdlX2ZpbGUpCgogICAgICAgIGpwaG90b2FyciA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoInBob3RvR2FsbGVyeSIpKQogICAgICAgIGhhc2hNYXAucHV0KCJwaG90b0dhbGxlcnkiLCBqc29uLmR1bXBzKGpwaG90b2FycikpCiAgICAgICAgIyBoYXNoTWFwLnB1dCgidG9hc3QiLGpzb24uZHVtcHMoanBob3RvYXJyKSkKCiAgICBlbGlmIGxpc3RlbmVyID09ICJnYWxsZXJ5X2NoYW5nZSI6ICAjINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDQvNC+0LbQtdGCINGD0LTQsNC70LjRgtGMINGE0L7RgtC+INC40Lcg0LPQsNC70LXRgNC10LguINCd0L7QstGL0Lkg0LzQsNGB0YHQuNCyINC90LDQtNC+INC/0L7QvNC10YHRgtC40YLRjCDQuiDQtNC+0LrRg9C80LXQvdGC0YMKCiAgICAgICAgaWYgaGFzaE1hcC5jb250YWluc0tleSgicGhvdG9HYWxsZXJ5Iik6ICAjINGN0YLQuCAyINC+0LHRgNCw0LHQvtGC0YfQuNC60LAgLSDQsNC90LDQu9C+0LPQuNGH0L3Ri9C1LCDQv9GA0L7RgdGC0L4g0LTQu9GPINGA0LDQt9C90YvRhSDRgdC+0LHRi9GC0LjQuQogICAgICAgICAgICBqcGhvdG9hcnIgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJwaG90b0dhbGxlcnkiKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoInBob3RvR2FsbGVyeSIsIGpzb24uZHVtcHMoanBob3RvYXJyKSkKICAgICAgICAgICAgIyBoYXNoTWFwLnB1dCgidG9hc3QiLCIjMiIranNvbi5kdW1wcyhqcGhvdG9hcnIpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByaWNlX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlkX2dvb2QgPSBoYXNoTWFwLmdldCgnaWRfZ29vZCcpCiAgICAjINCk0L7RgNC80LjRgNGD0LXQvCDRgtCw0LHQu9C40YbRgyDQutCw0YDRgtC+0YfQtdC6INC4INC30LDQv9GA0L7RgSDQuiDQsdCw0LfQtQogICAgZ29vZHNfcHJpY2VfbGlzdCA9IHVpX2Zvcm1fZGF0YS5nZXRfcHJpY2VfY2FyZChyc19zZXR0aW5ncykKICAgIGdvb2RzX3ByaWNlX2xpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddID0gW10KCiAgICBxdWVyeV90ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9wcmljZV9xdWVyeSgpCgogICAgcmVzdWx0cyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChpZF9nb29kLCkpCiAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgcHJvZHVjdF9yb3cgPSB7CiAgICAgICAgICAgICdrZXknOiBzdHIocmVjb3JkWzBdKSwKICAgICAgICAgICAgJ2dvb2RfbmFtZSc6IHN0cihyZWNvcmRbM10pLAogICAgICAgICAgICAjICdpZF9wcm9wZXJ0aWVzJzogc3RyKHJlY29yZFszXSksCiAgICAgICAgICAgICdwcm9wZXJ0aWVzX25hbWUnOiBzdHIocmVjb3JkWzVdKSwKICAgICAgICAgICAgIyAnaWRfc2VyaWVzJzogc3RyKHJlY29yZFs1XSksCiAgICAgICAgICAgICdzZXJpZXNfbmFtZSc6IHN0cihyZWNvcmRbN10pfQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgcHJpY2VzX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgICIiImlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9nb29kX2lkJyk6CiAgICAgICAgZ2V0X3ByaWNlcyhoYXNoTWFwKSIiIgoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByaWNlc19vbl9pbnB1dChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAiZ2V0X3ByaWNlc19idG4iOgogICAgICAgIGdldF9wcmljZXMoaGFzaE1hcCkKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICJwcmljZV90eXBlX3NlbGVjdCI6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAn0JLRi9Cx0L7RgCDRgtC40L/QsCDRhtC10L3RiycpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAicHJvcGVydHlfc2VsZWN0IjoKICAgICAgICBnZXRfZ29vZF9ieV9hcnQoaGFzaE1hcCkKICAgICAgICBpZiBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9pZCcpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICfQktGL0LHQvtGAINGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC6JykKICAgICAgICAgICAgIyByZXR1cm4gaGFzaE1hcAogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gInVuaXRfc2VsZWN0IjoKICAgICAgICBnZXRfZ29vZF9ieV9hcnQoaGFzaE1hcCkKICAgICAgICBpZiBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9pZCcpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICfQktGL0LHQvtGAINGD0L/QsNC60L7QstC60LgnKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gImJhcmNvZGUiOgogICAgICAgIGlkZW50aWZ5X2JhcmNvZGVfcHJpY2VzKGhhc2hNYXApCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAiT05fQkFDS19QUkVTU0VEIjoKICAgICAgICBraWxsX3ByaWNlX3RhYmxlcyhoYXNoTWFwKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdyZXR1cm5fdG9fZ29vZF9jYXJkJyk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdub1JlZnJlc2gnLCAnJykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoIkZpbmlzaFByb2Nlc3NSZXN1bHQiLCAiIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgiRmluaXNoUHJvY2VzcyIsICIiKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgcHJpY2VfdHlwZXNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdDYXJkc0NsaWNrJzoKICAgICAgICBzZWxlY3RlZF9wcmljZV90eXBlX2lkID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfa2V5IikKICAgICAgICBzZWxlY3RlZF9wcmljZV90eXBlX25hbWUgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIG5hbWUgRlJPTSBSU19wcmljZV90eXBlcyB3aGVyZSBpZCA9ICciICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZF9wcmljZV90eXBlX2lkICsgIiciKQogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJywgc3RyKHNlbGVjdGVkX3ByaWNlX3R5cGVfaWQpKQogICAgICAgIGhhc2hNYXAucHV0KCJwcmljZV90eXBlX3NlbGVjdCIsIHN0cihzZWxlY3RlZF9wcmljZV90eXBlX25hbWVbMF0pLnNwbGl0KCInIilbMV0pCiAgICAgICAgaGFzaE1hcC5wdXQoIkJhY2tTY3JlZW4iLCAiIikKICAgICAgICByZXR1cm4gaGFzaE1hcAoKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYWNrX3RvX3ByaWNlcycgb3IgJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgYmFja190b19wcmljZXMoaGFzaE1hcCkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByb3BlcnRpZXNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgIHNlbGVjdGVkX3Byb3BlcnR5X2lkID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfa2V5IikKICAgICAgICBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBuYW1lIEZST00gUlNfcHJvcGVydGllcyB3aGVyZSBpZCA9ICciICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRfcHJvcGVydHlfaWQgKyAiJyIpCgogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsIHN0cihzZWxlY3RlZF9wcm9wZXJ0eV9pZCkpCiAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnR5X3NlbGVjdCIsIHN0cihzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lWzBdKS5zcGxpdCgiJyIpWzFdKQogICAgICAgIGhhc2hNYXAucHV0KCJCYWNrU2NyZWVuIiwgIiIpCiAgICAgICAgcmV0dXJuIGhhc2hNYXAKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYWNrX3RvX3ByaWNlcycgb3IgJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgYmFja190b19wcmljZXMoaGFzaE1hcCkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiB1bml0c19vbl9pbnB1dChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgc2VsZWN0ZWRfdW5pdF9pZCA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpCiAgICAgICAgc2VsZWN0ZWRfdW5pdF9uYW1lID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBuYW1lIEZST00gUlNfdW5pdHMgd2hlcmUgaWQgPSAnIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRfdW5pdF9pZCArICInIikKICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9pZCcsIHN0cihzZWxlY3RlZF91bml0X2lkKSkKICAgICAgICBoYXNoTWFwLnB1dCgidW5pdF9zZWxlY3QiLCBzdHIoc2VsZWN0ZWRfdW5pdF9uYW1lWzBdKS5zcGxpdCgiJyIpWzFdKQogICAgICAgIGhhc2hNYXAucHV0KCJCYWNrU2NyZWVuIiwgIiIpCiAgICAgICAgcmV0dXJuIGhhc2hNYXAKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYWNrX3RvX3ByaWNlcycgb3IgJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgYmFja190b19wcmljZXMoaGFzaE1hcCkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByaWNlc190YWJsZXNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ3Nob3dfZmlsdGVycyc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0iKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3Byb3BlcnR5X2lkJywgJycpCgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCJyZXR1cm5fdG9fZ29vZF9jYXJkIik6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJCYWNrU2NyZWVuIiwgJycpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2dvb2RfaWQnLCAnJykKCiAgICAgICAgICAgIGlmIGhhc2hNYXAuZ2V0KCJjdXJyZW50X3NjcmVlbl9uYW1lIikgPT0gItCi0LDQsdC70LjRhtCwINC+0YHRgtCw0YLQutC+0LIiOgogICAgICAgICAgICAgICAga2lsbF9yZW1haW5zX3RhYmxlcyhoYXNoTWFwKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J/RgNC+0LLQtdGA0LjRgtGMINC+0YHRgtCw0YLQutC4JykKICAgICAgICAgICAgZWxpZiBoYXNoTWFwLmdldCgiY3VycmVudF9zY3JlZW5fbmFtZSIpID09ICLQotCw0LHQu9C40YbQsCDRhtC10L0iOgogICAgICAgICAgICAgICAga2lsbF9wcmljZV90YWJsZXMoaGFzaE1hcCkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cf0YDQvtCy0LXRgNC60LAg0YbQtdC9JykKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYXJjb2RlJzoKICAgICAgICBpZGVudGlmeV9iYXJjb2RlX3ByaWNlcyhoYXNoTWFwKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGlkZW50aWZ5X2JhcmNvZGVfcHJpY2VzKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdiYXJjb2RlJyk6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGVfaW5mbycsIHN0cihoYXNoTWFwLmdldCgnYmFyY29kZScpKSkKCiAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykKICAgICAgICBnb29kX2lkX3F1ZXJ5ID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoCiAgICAgICAgICAgICJTRUxFQ1QgaWRfZ29vZCBGUk9NIFJTX2JhcmNvZGVzIHdoZXJlIGJhcmNvZGUgPSAnIiArIGJhcmNvZGUgKyAiJyIpCiAgICAgICAgcHJvcGVydGllc19xdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KAogICAgICAgICAgICAiU0VMRUNUIGlkX3Byb3BlcnR5IEZST00gUlNfYmFyY29kZXMgd2hlcmUgYmFyY29kZSA9ICciICsgYmFyY29kZSArICInIikKCiAgICAgICAgaWYgZ29vZF9pZF9xdWVyeToKICAgICAgICAgICAgZ29vZF9pZCA9IHN0cihnb29kX2lkX3F1ZXJ5KS5zcGxpdCgiJyIpWzFdCgogICAgICAgICAgICBpZiBsZW4oZ29vZF9pZCkgPiAwOgogICAgICAgICAgICAgICAgZ29vZF9uYW1lX3F1ZXJ5ID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoCiAgICAgICAgICAgICAgICAgICAgIlNFTEVDVCBuYW1lIEZST00gUlNfZ29vZHMgd2hlcmUgaWQgPSAnIiArIGdvb2RfaWQgKyAiJyIpCgogICAgICAgICAgICAgICAgZ29vZF9uYW1lID0gc3RyKGdvb2RfbmFtZV9xdWVyeSkuc3BsaXQoIiciKVsxXQoKICAgICAgICAgICAgICAgIGdvb2RfYXJ0X3F1ZXJ5ID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBhcnQgRlJPTSBSU19nb29kcyB3aGVyZSBpZCA9ICciICsgZ29vZF9pZCArICInIikKCiAgICAgICAgICAgICAgICBnb29kX2FydCA9IHN0cihnb29kX2FydF9xdWVyeSkuc3BsaXQoIiciKVsxXQoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdpbnB1dF9nb29kX2lkJywgZ29vZF9pZCkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdpbnB1dF9nb29kX2FydCcsIGdvb2RfYXJ0KQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19vYmplY3RfbmFtZScsIGdvb2RfbmFtZSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcmljZXNfZXJyb3JfbXNnJywgIiIpCgogICAgICAgIGlmIHByb3BlcnRpZXNfcXVlcnk6CiAgICAgICAgICAgIHByb3BlcnR5X2lkID0gc3RyKHByb3BlcnRpZXNfcXVlcnkpLnNwbGl0KCInIilbMV0KICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3Byb3BlcnR5X2lkJywgcHJvcGVydHlfaWQpCgogICAgICAgICAgICBpZiBsZW4ocHJvcGVydHlfaWQpID4gMDoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0eV9pZCcsIHByb3BlcnR5X2lkKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgncHJpY2VzX29iamVjdF9uYW1lJywgIiIpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcmljZXNfZXJyb3JfbXNnJywgItCo0YLRgNC40YXQutC+0LQg0L3QtSDRgNCw0YHQv9C+0LfQvdCw0L0iKQogICAgZ2V0X3ByaWNlcyhoYXNoTWFwKQoKZGVmIGJhY2tfdG9fcHJpY2VzKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdjdXJyZW50X3NjcmVlbl9uYW1lJykgPT0gItCS0YvQsdC+0YAg0YLQuNC/0LAg0YbQtdC90YsiOgogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3ByaWNlX3R5cGVfbmFtZScsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdwcmljZV90eXBlX3NlbGVjdCcsICcnKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdjdXJyZW50X3NjcmVlbl9uYW1lJykgPT0gItCS0YvQsdC+0YAg0YXQsNGA0LDQutGC0LXRgNC40YHRgtC40LoiOgogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnR5X3NlbGVjdCIsICcnKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdjdXJyZW50X3NjcmVlbl9uYW1lJykgPT0gItCS0YvQsdC+0YAg0YPQv9Cw0LrQvtCy0LrQuCI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfaWQnLCAiIikKICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoInVuaXRfc2VsZWN0IiwgIiIpCiAgICBoYXNoTWFwLnB1dCgiQmFja1NjcmVlbiIsICIiKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgbmV3X2RvY19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnZG9jX3R5cGVfc2VsZWN0JykgPT0gTm9uZToKICAgICAgICAjINCX0LDQv9C+0LvQvdC40Lwg0L/QvtC70LUg0YTQuNC70YzRgtGA0LAg0L/QviDQstC40LTRgyDQtNC+0LrRg9C80LXQvdGC0L7QsgogICAgICAgIHJlc3VsdCA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHVpX2Zvcm1fZGF0YS5nZXRfZG9jX3R5cGVfcXVlcnkoKSkKICAgICAgICBkb2NfdHlwZV9saXN0ID0gWyfQktGB0LUnXQogICAgICAgIGZvciByZWNvcmQgaW4gcmVzdWx0OgogICAgICAgICAgICBkb2NfdHlwZV9saXN0LmFwcGVuZChyZWNvcmRbMF0pCiAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY190eXBlX3NlbGVjdCcsICc7Jy5qb2luKGRvY190eXBlX2xpc3QpKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdjb3VudHJhZ2VudCcpID09IE5vbmU6CiAgICAgICAgI2ZsZF9jb3VudHJhZ2VudCA9IHVpX2dsb2JhbC5nZXRfbmFtZV9saXN0KCdSU19jb3VudHJhZ2VudHMnKQoKICAgICAgICBoYXNoTWFwLnB1dCgnY291bnRyYWdlbnQnLCAn0JrQvtC90YLRgNCw0LPQtdC90YInKSAgI2ZsZF9jb3VudHJhZ2VudAoKICAgIGlmIGhhc2hNYXAuZ2V0KCd3YXJlaG91c2UnKSA9PSBOb25lOgogICAgICAgICNmbGRfY291bnRyYWdlbnQgPSB1aV9nbG9iYWwuZ2V0X25hbWVfbGlzdCgnUlNfd2FyZWhvdXNlcycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3dhcmVob3VzZScsICfQodC60LvQsNC0JykgI2RvY193YXJlaG91c2UKCiAgICBpZiBub3QgaGFzaE1hcC5jb250YWluc0tleSgnZG9jX2RhdGUnKToKICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2RhdGUnLCAnMDEuMDEuMjAyMicpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgbmV3X2RvY19vbl9zZWxlY3QoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgibGlzdGVuZXIiKQogICAgdHlwZSA9IGhhc2hNYXAuZ2V0KCdkb2NfdHlwZV9jbGljaycpCiAgICBpZiBub3QgdHlwZToKICAgICAgICB0eXBlID0gJ9Cf0YDQuNGF0L7QtCcKICAgIGZsZF9udW1iZXIgPSBoYXNoTWFwLmdldCgnZmxkX251bWJlcicpCgogICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgaWYgbm90IGZsZF9udW1iZXI6CgogICAgICAgICAgICBpZCA9IHVpX2dsb2JhbC5Sc19kb2MuZ2V0X25ld19pZCgxKQogICAgICAgICAgICAjIGlkID0gKGYne2lkOjA0fScpCiAgICAgICAgICAgICMgaWQgPSAiezA6MD40fSIuZm9ybWF0KGlkKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlkID0gZmxkX251bWJlcgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVpX2dsb2JhbC5Sc19kb2MuYWRkKCcwMScsIChpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCwgICMgaGFzaE1hcC5nZXQoJ2ZsZF9udW1iZXInKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5nZXQoJ2ZsZF9kYXRhJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X2J5X25hbWUoaGFzaE1hcC5nZXQoJ2NvdW50cmFnZW50JyksICdSU19jb3VudHJhZ2VudHMnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpX2dsb2JhbC5nZXRfYnlfbmFtZShoYXNoTWFwLmdldCgnd2FyZWhvdXNlJyksICdSU193YXJlaG91c2VzJykpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Cd0L7QvNC10YAg0LTQvtC60YPQvNC10L3RgtCwINC90LXRg9C90LjQutCw0LvQtdC9IScpCgoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9jYW5jZWwnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9CU0L7QutGD0LzQtdC90YLRiycpCiAgICBlbGlmIGxpc3RlbmVyID09ICdmbGRfZGF0YSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY19kYXRlJywgaGFzaE1hcC5nZXQoJ2ZsZF9kYXRhJykpCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09J2J0bl9zZWxlY3Rfd2FyZWhvdXNlJzoKICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU193YXJlaG91c2VzJykgICMg0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9jZWxsX3ZhbHVlJykKICAgICAgICBoYXNoTWFwLnB1dCgnZmlsdGVyX2ZpZWxkcycsICduYW1lJykKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3NlbGVjdF9jb3VudHJhZ2VudCc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfY291bnRyYWdlbnRzJykgICMg0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9jZWxsX3ZhbHVlJykKICAgICAgICBoYXNoTWFwLnB1dCgnZmlsdGVyX2ZpZWxkcycsICduYW1lO2Z1bGxfbmFtZTtpbm47a3BwJykKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9jZWxsX3ZhbHVlJzoKICAgICAgICBpZiBoYXNoTWFwLmdldCgndGFibGVfZm9yX3NlbGVjdCcpID09ICdSU19jb3VudHJhZ2VudHMnOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY291bnRyYWdlbnQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpICNmbGRfY291bnRyYWdlbnQKICAgICAgICBlbGlmIGhhc2hNYXAuZ2V0KCd0YWJsZV9mb3Jfc2VsZWN0JykgPT0gJ1JTX3dhcmVob3VzZXMnOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnd2FyZWhvdXNlJywgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfbmFtZScpKSAgIyBmbGRfY291bnRyYWdlbnQKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRvY19iYXJjb2Rlc19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBkb2NfZGV0YWlsX2xpc3QgPSB1aV9mb3JtX2RhdGEuZ2V0X2JhcmNvZGVfY2FyZChyc19zZXR0aW5ncykKICAgIHF1ZXJ5X3RleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2JhcmNvZGVfcXVlcnkoKQogICAgaWRfZG9jID0gaGFzaE1hcC5nZXQoJ2lkX2RvYycpCiAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgKGlkX2RvYywpKQoKICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICBwcm9kdWN0X3JvdyA9IHsKICAgICAgICAgICAgJ2tleSc6IHN0cihyZWNvcmRbMF0pLAogICAgICAgICAgICAnYmFyY29kZV92YWx1ZSc6IHN0cihyZWNvcmRbM10pLAogICAgICAgICAgICAnYXBwcm92ZWQnOiBzdHIocmVjb3JkWzRdKQoKICAgICAgICB9CgogICAgICAgIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10uYXBwZW5kKHByb2R1Y3Rfcm93KQoKICAgIGhhc2hNYXAucHV0KCJiYXJjX2NhcmRzIiwganNvbi5kdW1wcyhkb2NfZGV0YWlsX2xpc3QpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRvY19iYXJjb2Rlc19saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBiYXJjb2RlX2Vycm9yX3NjcmVlbl9saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAjIHN1Q2xhc3MudXJvdm9fc2V0X2xvY2tfdHJpZ2dlcihGYWxzZSkKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICBlbGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdidG5fY29udGludWVfc2Nhbic6CiAgICAgICAgIyBzdUNsYXNzLnVyb3ZvX3NldF9sb2NrX3RyaWdnZXIoRmFsc2UpCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgdGlsZXNfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgc21hbGxfdGlsZSA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX3RpbGVzKHJzX3NldHRpbmdzKQogICAgcXRleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2RvY3Nfc3RhdF9xdWVyeSgpCiAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgTm9uZSwgVHJ1ZSkKCiAgICB4ID0geyd0aWxlcyc6IFtbXV0sICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmNWY1ZjUifQoKICAgICMgeFsndGlsZXMnOlswXVswXV09MQogICAgcm93cyA9IDEKICAgIGNvbHVtbnMgPSAxCiAgICBmb3IgZWwgaW4gcmVzOgogICAgICAgIGlmIGVsWydkb2NUeXBlJ109PU5vbmU6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgaWYgY29sdW1ucyAlIDMgPT0gMDoKICAgICAgICAgICAgcm93cyArPSAxCiAgICAgICAgICAgIGNvbHVtbnMgPSAwCiAgICAgICAgICAgIHhbJ3RpbGVzJ10uYXBwZW5kKFtdKQogICAgICAgIGNvbHVtbnMgKz0gMQoKICAgICAgICB0aWxlID0gewoKICAgICAgICAgICAgImxheW91dCI6IHNtYWxsX3RpbGUsCiAgICAgICAgICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgImRvY05hbWUiOiBlbFsnZG9jVHlwZSddLAogICAgICAgICAgICAgICAgJ1F0dHlPZkRvY3MnOiBzdHIoZWxbJ2NvdW50J10pICsgJy8nICsgc3RyKGVsWyd2ZXJpZmllZCddKSwKICAgICAgICAgICAgICAgICMgJ1F0dHlPZkRvY3NJbmNvbXBsZXRlZCc6ZWxbJ2NvdW50J10gLSBlbFsndmVyaWZpZWQnXQogICAgICAgICAgICAgICAgJ2NvdW50X3ZlcmlmaWVkJzogc3RyKGVsWydjb3VudF92ZXJpZmllZCddK2VsWydjb3VudF91bnZlcmlmaWVkJ10pICsgJy8nICsgc3RyKGVsWydjb3VudF91bnZlcmlmaWVkJ10pLAogICAgICAgICAgICAgICAgJ3F0dHlfcGxhbl92ZXJpZmllZCc6IHN0cihlbFsncXR0eV9wbGFuX3ZlcmlmaWVkJ10rZWxbJ3F0dHlfcGxhbl91bnZlcmlmaWVkJ10pICsgJy8nICsgc3RyKGVsWydxdHR5X3BsYW5fdW52ZXJpZmllZCddKSwKCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgImNvbG9yIjogJyNGRkZGRkYnLCAgIyAiI0ZGQ0M5OSIsCiAgICAgICAgICAgICJzdGFydF9zY3JlZW4iOiAi0JTQvtC60YPQvNC10L3RgtGLIiwKCiAgICAgICAgICAgICJzdGFydF9wcm9jZXNzIjogIiIsCiAgICAgICAgICAgICdrZXknOiBlbFsnZG9jVHlwZSddCiAgICAgICAgfQoKICAgICAgICB4Wyd0aWxlcyddW3Jvd3MgLSAxXS5hcHBlbmQodGlsZSkKCiAgICBoYXNoTWFwLnB1dCgidGlsZXMiLCBqc29uLmR1bXBzKHgsIGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiB0aWxlc19vbl9zZWxlY3QoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgibGlzdGVuZXIiKQoKICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICBwYXNzCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgoKICAgICAgICBoYXNoTWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgYXBwX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgICMgaGFzaE1hcC5wdXQoJ0luc3RhbGxDb25maWd1cmF0aW9uJywgJycpCiAgICAjIGhhc2hNYXAucHV0KCdVcGRhdGVNZW51JywgJycpCiAgICAjIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQmtC+0L3RhNCwINGD0YHRgtCw0L3QvtCy0LvQtdC90LAhISEnKQogICAgc2hlbWEgPSBkYXRhYmFzZV9pbml0X3F1ZXJ5ZXMuZGF0YWJhc2Vfc2hlbWEoKQogICAgZm9yIGVsIGluIHNoZW1hOgogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KGVsKQoKCiAgICAgICAgIyBmb3IgcGFyYW1ldGVyX25hbWUsIHZhbHVlIGluIHBhcmFtZXRlcnMuaXRlbXMoKToKICAgICAgICAjICAgICBzZXRfcGFyYW1zLnB1dChwYXJhbWV0ZXJfbmFtZSx2YWx1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnVGl0bGVUZXh0U2l6ZScpID09IE5vbmU6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCJUaXRsZVRleHRTaXplIiwgIjE4IiwgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJykgPT0gTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoInRpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSIsICIxOCIsIFRydWUpCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykgPT0gTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkNhcmRUaXRsZVRleHRTaXplIiwgIjIwIiwgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpID09IE5vbmU6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCJDYXJkRGF0ZVRleHRTaXplIiwgIjEwIiwgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnQ2FyZFRleHRTaXplJykgPT0gTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkNhcmRUZXh0U2l6ZSIsICIxNSIsIFRydWUpCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnKSA9PSBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSIsICIxOCIsIFRydWUpCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ2dvb2RzVGV4dFNpemUnKSA9PSBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiZ29vZHNUZXh0U2l6ZSIsICIxOCIsIFRydWUpCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZScpID09IE5vbmU6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCJTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUiLCAiMTYiLCBUcnVlKQogICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJykgPT0gTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkRvY1R5cGVDYXJkVGV4dFNpemUiLCAiMTUiLCBUcnVlKQogICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCdzaWduYWxfbnVtJykgPT0gTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoJ3NpZ25hbF9udW0nLCAnODMnLCBUcnVlKQogICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCdiZWVwX2R1cmF0aW9uJykgPT0gTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoJ2JlZXBfZHVyYXRpb24nLCAnMTAwMCcsIFRydWUpCgogICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9CT0L7RgtC+0LIg0Log0YDQsNCx0L7RgtC1JykKCiAgICAjINCf0YDQvtCy0LXRgNC40LwsINGB0LLQvtC/0LDQtNCw0Y7RgiDQu9C4INGC0LXQutGD0YnQuNC5INGA0LXQu9C40Lcg0LrQvtC90YTRiyDQuCDQt9Cw0L/QuNGB0Ywg0L4g0L3QtdC8INCyINCR0JQsINC10YHQu9C4INC90LXRgiAtINGC0L4g0L3QsNC00L4g0LLRi9C/0L7Qu9C90LjRgtGMINC/0YDQvtGG0LXQtNGD0YDRgyDQvtCx0L3QvtCy0LvQtdC90LjRjwogICAgIyBpZiBub3QgdWlfZ2xvYmFsLmdldF9jb25zdGFudHMoJ3JlbGVhc2UnKSA9PSBoYXNoTWFwLmdldCgncmVsZWFzZScpOgogICAgIyB1cGRhdGVfcHJvYy51cGRhdGVfb25fcmVsZWFzZShjdXJyZW50X3JlbGVhc2UpCiAgICAjIHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCdVcGRhdGUgUlNfY29uc3RhbnRzIHNldCByZWxlYXNlID0gPycsKGhhc2hNYXAuZ2V0KCdyZWxlYXNlJyksKSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBmaWxlX2xpc3Rfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgdHggPSAnJwoKICAgICMgdHJhdmVyc2Ugcm9vdCBkaXJlY3RvcnksIGFuZCBsaXN0IGRpcmVjdG9yaWVzIGFzIGRpcnMgYW5kIGZpbGVzIGFzIGZpbGVzCiAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsaygiLiIpOgogICAgICAgIHBhdGggPSByb290LnNwbGl0KG9zLnNlcCkKICAgICAgICBwcmludCgobGVuKHBhdGgpIC0gMSkgKiAnLS0tJywgb3MucGF0aC5iYXNlbmFtZShyb290KSkKICAgICAgICBmb3IgZmlsZSBpbiBmaWxlczoKICAgICAgICAgICAgcHJpbnQobGVuKHBhdGgpICogJy0tLScsIGZpbGUpCgogICAgaGFzaE1hcC5wdXQoJ2ZpbGVzX2xpc3QnLCB0eCkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGV2ZW50X3NlcnZpY2UoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyBoYXNoTWFwLnB1dCgnX2NvbmZpZ3VyYXRpb24nLCcnKQogICAgaGFzaE1hcC5wdXQoJ3dzX2JvZHknLCBoYXNoTWFwLmdldCgnQU5EUk9JRF9JRCcpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHB1dF9ub3RpZmljYXRpb24oaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaGFzaE1hcC5wdXQoJ19jb25maWd1cmF0aW9uJywnJykKICAgIHF0ZXh0ID0gJ1NFTEVDVCBkb2NfdHlwZSwgY291bnQoaWRfZG9jKSBhcyBjb3VudCwgbWF4KGNyZWF0ZWRfYXQpIGFzIGR0IEZST00gUlNfZG9jcyBXSEVSRSBjcmVhdGVkX2F0Pj8gR1JPVVAgQlkgZG9jX3R5cGUnCiAgICBsYXN0RGF0ZSA9IHJzX3NldHRpbmdzLmdldCgnbGFzdERhdGUnKQogICAgaWYgbm90IGxhc3REYXRlOgogICAgICAgIGxhc3REYXRlID0gJzIwMjAtMDEtMDEgMDA6MDA6MDAnICAjIG9uZV9tb250aF9hZ28uc3RyZnRpbWUoJyVZLSVtLSVkLSVILSVNLSVTJykKICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LChsYXN0RGF0ZSwpLFRydWUpCiAgICBEb2NMaXN0ID0gJycKICAgIGlmIHJlczoKICAgICAgICBmb3IgZWwgaW4gcmVzOgogICAgICAgICAgICBEb2NMaXN0ID0gRG9jTGlzdCArICgnICcgKyBlbFsnZG9jX3R5cGUnXSArICc6ICcgKyBzdHIoZWxbJ2NvdW50J10pKQoKICAgICAgICBoYXNoTWFwLnB1dCgnYmFzaWNfbm90aWZpY2F0aW9uJywganNvbi5kdW1wcyhbeydudW1iZXInOjEsICd0aXRsZSc6J9Cd0L7QstGL0LUg0LTQvtC60YPQvNC10L3RgtGLJywgJ21lc3NhZ2UnOiBEb2NMaXN0IH1dKSkKICAgICAgICBxdGV4dCA9ICdTRUxFQ1QgbWF4KGNyZWF0ZWRfYXQpIGFzIGR0IEZST00gUlNfZG9jcycKICAgICAgICByZXMyID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnbGFzdERhdGUnLHJlczJbMF1bMF0sVHJ1ZSkKICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLGxhc3REYXRlKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGZvbnRfc2l6ZV9zZXR0aW5nc19saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX29uX3NhdmUnIG9yIGhhc2hNYXAuZ2V0KCdldmVudCcpPT0nSW5wdXQnOgoKICAgICAgICByc19zZXR0aW5ncy5wdXQoIlRpdGxlVGV4dFNpemUiLCBoYXNoTWFwLmdldCgiVGl0bGVUZXh0U2l6ZSIpLCBUcnVlKQogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiQ2FyZFRpdGxlVGV4dFNpemUiLCBoYXNoTWFwLmdldCgiQ2FyZFRpdGxlVGV4dFNpemUiKSwgVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkNhcmRUZXh0U2l6ZSIsIGhhc2hNYXAuZ2V0KCJDYXJkVGV4dFNpemUiKSwgVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkNhcmREYXRlVGV4dFNpemUiLCBoYXNoTWFwLmdldCgiQ2FyZERhdGVUZXh0U2l6ZSIpLCBUcnVlKQogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSIsIGhhc2hNYXAuZ2V0KCJHb29kc0NhcmRUaXRsZVRleHRTaXplIiksIFRydWUpCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCJnb29kc1RleHRTaXplIiwgaGFzaE1hcC5nZXQoImdvb2RzVGV4dFNpemUiKSwgVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoIlNlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSIsIGhhc2hNYXAuZ2V0KCJTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUiKSwgVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkRvY1R5cGVDYXJkVGV4dFNpemUiLCBoYXNoTWFwLmdldCgiRG9jVHlwZUNhcmRUZXh0U2l6ZSIpLCBUcnVlKQogICAgICAgIHJzX3NldHRpbmdzLnB1dCgidGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplIiwgaGFzaE1hcC5nZXQoInRpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSIpLCBUcnVlKQogICAgICAgICNwYXJhbXMucHV0KCJzaWduYWxfbnVtIiwgaGFzaE1hcC5nZXQoInNpZ25hbF9udW0iKSwgVHJ1ZSkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9vbl9jYW5jZWwnIG9yIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBmb250X3NpemVzX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICAjINCh0LvQvtCy0LDRgNC40Log0L3QsNC30LLQsNC90LjQuSDQuCDQuNC80LXQvSDRgNCw0LfQvNC10YDQvtCyINGI0YDQuNGE0YLQvtCyCiAgICBzcyA9IHsKICAgICAgICAnVGl0bGVUZXh0U2l6ZSc6ICfQoNCw0LfQvNC10YAg0LfQsNCz0L7Qu9C+0LLQutCwJywKICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnOiAn0KDQsNC30LzQtdGAINC30LDQs9C+0LvQvtCy0LrQsCDQutCw0YDRgtC+0YfQutC4JywKICAgICAgICAiQ2FyZERhdGVUZXh0U2l6ZSI6ICfQlNCw0L3QvdGL0LUg0LrQsNGA0YLQvtGH0LrQuCcsCiAgICAgICAgJ0NhcmRUZXh0U2l6ZSc6J9Cg0LDQt9C80LXRgCDRgtC10LrRgdGC0LAg0Y3Qu9C10LzQtdC90YLQvtCyJywKICAgICAgICAnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSc6ICfQl9Cw0LPQvtC70L7QstC+0Log0YLQvtCy0LDRgNCwJywKICAgICAgICAnZ29vZHNUZXh0U2l6ZSc6ICfQotC+0LLQsNGAJywKICAgICAgICAnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJzogJ9Ch0LXRgNC40Lgg0YHQstC+0LnRgdGC0LLQsCcsCiAgICAgICAgJ0RvY1R5cGVDYXJkVGV4dFNpemUnOiAn0KLQuNC/INC00L7QutGD0LzQtdC90YLQsCcsCiAgICAgICAgJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSc6J9Cd0LDQt9Cy0LDQvdC40LUg0LTQvtC60YPQvNC10L3RgtCwINCyINC60LDRgNGC0L7Rh9C60LUnfSAgIywgICAgICAgJ3NpZ25hbF9udW0nOiAi0J3QvtC80LXRgCDRgdC40LPQvdCw0LvQsCIKCiAgICBoYXNoTWFwLnB1dCgnVGl0bGVUZXh0U2l6ZScsICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0KDQsNC30LzQtdGAINC30LDQs9C+0LvQvtCy0LrQsCcsIGRlZmF1bHRfdGV4dD1yc19zZXR0aW5ncy5nZXQoJ1RpdGxlVGV4dFNpemUnKSwgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkgIyAgKQogICAgaGFzaE1hcC5wdXQoJ0NhcmRUaXRsZVRleHRTaXplJywKICAgICAgICAgICAgICAgIHVpX2Zvcm1fZGF0YS5Nb2Rlcm5GaWVsZChoaW50PSfQoNCw0LfQvNC10YAg0LfQsNCz0L7Qu9C+0LLQutCwINC60LDRgNGC0L7Rh9C60LgnLCBkZWZhdWx0X3RleHQ9cnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpICAjICkKICAgICMiQ2FyZERhdGVUZXh0U2l6ZSI6ICfQlNCw0L3QvdGL0LUg0LrQsNGA0YLQvtGH0LrQuCcsCiAgICBoYXNoTWFwLnB1dCgnQ2FyZERhdGVUZXh0U2l6ZScsCiAgICAgICAgICAgICAgICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0JTQsNC90L3Ri9C1INC60LDRgNGC0L7Rh9C60LgnLCBkZWZhdWx0X3RleHQ9cnNfc2V0dGluZ3MuZ2V0KCdDYXJkRGF0ZVRleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkgICMgKQogICAgIydDYXJkVGV4dFNpemUnOifQoNCw0LfQvNC10YAg0YLQtdC60YHRgtCwINGN0LvQtdC80LXQvdGC0L7QsicsCiAgICBoYXNoTWFwLnB1dCgnQ2FyZFRleHRTaXplJywKICAgICAgICAgICAgICAgIHVpX2Zvcm1fZGF0YS5Nb2Rlcm5GaWVsZChoaW50PSfQoNCw0LfQvNC10YAg0YLQtdC60YHRgtCwINGN0LvQtdC80LXQvdGC0L7QsicsIGRlZmF1bHRfdGV4dD1yc19zZXR0aW5ncy5nZXQoJ0NhcmRUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpICAjICkKICAgICMnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSc6ICfQl9Cw0LPQvtC70L7QstC+0Log0YLQvtCy0LDRgNCwJywKICAgIGhhc2hNYXAucHV0KCdHb29kc0NhcmRUaXRsZVRleHRTaXplJywKICAgICAgICAgICAgICAgIHVpX2Zvcm1fZGF0YS5Nb2Rlcm5GaWVsZChoaW50PSfQl9Cw0LPQvtC70L7QstC+0Log0YLQvtCy0LDRgNCwJywgZGVmYXVsdF90ZXh0PXJzX3NldHRpbmdzLmdldCgnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpICAjICkKICAgICMnZ29vZHNUZXh0U2l6ZSc6ICfQotC+0LLQsNGAJywKICAgIGhhc2hNYXAucHV0KCdnb29kc1RleHRTaXplJywKICAgICAgICAgICAgICAgIHVpX2Zvcm1fZGF0YS5Nb2Rlcm5GaWVsZChoaW50PSfQotC+0LLQsNGAJywgZGVmYXVsdF90ZXh0PXJzX3NldHRpbmdzLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpICAjICkKICAgICMnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJzogJ9Ch0LXRgNC40Lgg0YHQstC+0LnRgdGC0LLQsCcsCiAgICBoYXNoTWFwLnB1dCgnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJywKICAgICAgICAgICAgICAgIHVpX2Zvcm1fZGF0YS5Nb2Rlcm5GaWVsZChoaW50PSfQodC10YDQuNC4INGB0LLQvtC50YHRgtCy0LAnLCBkZWZhdWx0X3RleHQ9cnNfc2V0dGluZ3MuZ2V0KCdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKSAgIyApCiAgICAjJ0RvY1R5cGVDYXJkVGV4dFNpemUnOiAn0KLQuNC/INC00L7QutGD0LzQtdC90YLQsCcsCiAgICBoYXNoTWFwLnB1dCgnRG9jVHlwZUNhcmRUZXh0U2l6ZScsCiAgICAgICAgICAgICAgICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0KLQuNC/INC00L7QutGD0LzQtdC90YLQsCcsIGRlZmF1bHRfdGV4dD1yc19zZXR0aW5ncy5nZXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKSAgIyApCiAgICAjJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSc6J9Cd0LDQt9Cy0LDQvdC40LUg0LTQvtC60YPQvNC10L3RgtCwINCyINC60LDRgNGC0L7Rh9C60LUnCiAgICBoYXNoTWFwLnB1dCgndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJywKICAgICAgICAgICAgICAgIHVpX2Zvcm1fZGF0YS5Nb2Rlcm5GaWVsZChoaW50PSfQndCw0LfQstCw0L3QuNC1INC00L7QutGD0LzQtdC90YLQsCDQsiDQutCw0YDRgtC+0YfQutC1JywgZGVmYXVsdF90ZXh0PXJzX3NldHRpbmdzLmdldCgndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkgICMgKQoKICAgIHJldHVybiBoYXNoTWFwCgpkZWYgc291bmRfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyBzcyA9IHsnc2lnbmFsX251bSc6ICLQndC+0LzQtdGAINGB0LjQs9C90LDQu9CwIiwKICAgICMgICAgICAgJ2JlZXBfZHVyYXRpb24nOifQlNC70LjRgtC10LvRjNC90L7RgdGC0Ywo0LzRgSknfSAgIyAsCgogICAgaGFzaE1hcC5wdXQoJ3NpZ25hbF9udW0nLAogICAgICAgICAgICAgICAgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J9Cd0L7QvNC10YAg0YHQuNCz0L3QsNC70LAnLCBkZWZhdWx0X3RleHQ9cnNfc2V0dGluZ3MuZ2V0KCdzaWduYWxfbnVtJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkgICMgKQogICAgaGFzaE1hcC5wdXQoJ2JlZXBfZHVyYXRpb24nLAogICAgICAgICAgICAgICAgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J9CU0LvQuNGC0LXQu9GM0L3QvtGB0YLRjCjQvNGBKScsIGRlZmF1bHRfdGV4dD1yc19zZXR0aW5ncy5nZXQoJ2JlZXBfZHVyYXRpb24nKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKSAgIyApCiAgICAjZmllbGRzX2Zyb21fc2V0dGluZ3MoaGFzaE1hcCwgc3MpCgogICAgcmV0dXJuIGhhc2hNYXAKCmRlZiBzb3VuZF9zZXR0aW5nc19saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX29uX3NhdmUnIG9yIGhhc2hNYXAuZ2V0KCdldmVudCcpID09ICdJbnB1dCc6CgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnc2lnbmFsX251bScsIGhhc2hNYXAuZ2V0KCJzaWduYWxfbnVtX3ZhbHVlIiksIFRydWUpCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdiZWVwX2R1cmF0aW9uJywgaGFzaE1hcC5nZXQoJ2JlZXBfZHVyYXRpb25fdmFsdWUnKSwgVHJ1ZSkKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX29uX3NhdmUnOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fb25fY2FuY2VsJyBvciBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fdGVzdF9zb3VuZCc6CiAgICAgICAgI2hhc2hNYXAucHV0KCdiZWVwX2R1cmF0aW9uICcsIGhhc2hNYXAuZ2V0KCJiZWVwX2R1cmF0aW9uIikpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2JlZXAnLCBoYXNoTWFwLmdldCgnc2lnbmFsX251bScpKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgdGVzdF9iYXJjb2RlX2xpc3RlbmVyKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpPT0nYmFyY29kZScgb3IgaGFzaE1hcC5nZXQoImV2ZW50IikgPT0gIm9uUmVzdWx0UG9zaXRpdmUiOgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdmbGRfYmFyY29kZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpCiAgICAgICAgYmFyYyA9IHVpX2JhcmNvZGVzLnBhcnNlX2JhcmNvZGUoYmFyY29kZSkKICAgICAgICBrZXlzX2xpc3QgPSBbJ0VSUk9SJywnR1RJTicsJ1NFUklBTCcsJ0Z1bGxDb2RlJywgJ0JBUkNPREUnLCAnU0NIRU1FJywgJ0VYUElSWScsICdCQVRDSCcsICdOSFJOJywgJ0NIRUNLJywgJ1dFSUdIVCcsICdQUE4nXQogICAgICAgIHg9MQogICAgICAgIGZvciBpIGluIGtleXNfbGlzdDoKICAgICAgICAgICAgcmVzX3ZhbHVlID0gIGJhcmMuZ2V0KGksTm9uZSkKICAgICAgICAgICAgaWYgcmVzX3ZhbHVlOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2ZsZF8nK3N0cih4KSxzdHIoaSkrJzogJysgcmVzX3ZhbHVlKQogICAgICAgICAgICAgICAgeCs9MQogICAgICAgICPQldGB0LvQuCDQt9Cw0L/QvtC70L3QtdC90L4g0LzQtdC90LXQtSA1INC/0L7Qu9C10LksINGB0L7RgtGA0LXQvCDQvtGB0YLQsNC70YzQvdGL0LUg0L/RgNC+0YjQu9GL0LUg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIHdoaWxlIHg8PTc6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdmbGRfJyArIHN0cih4KSwgJycpCiAgICAgICAgICAgIHgrPTEKCiAgICBlbGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICJCQUNLX0JVVFRPTiIgb3IgJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0iKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGJhcmNvZGVfZmxvd19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgIGZhbHNlVmFsdWVMaXN0ID0gKDAsICcwJywgJ2ZhbHNlJywgJ0ZhbHNlJywgTm9uZSkKICAgICMg0KTQvtGA0LzQuNGA0YPQtdC8INGC0LDQsdC70LjRhtGDINC60LDRgNGC0L7Rh9C10Log0Lgg0LfQsNC/0YDQvtGBINC6INCx0LDQt9C1CgogICAgZG9jX2RldGFpbF9saXN0ID0gdWlfZm9ybV9kYXRhLmRvY19iYXJjX2Zsb3dfY2FyZChyc19zZXR0aW5ncykKICAgIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10gPSBbXQoKCiAgICBxdWVyeV90ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9kb2NfYmFyY19mbG93X3F1ZXJ5KCkKCiAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgKGlkX2RvYywpLCBUcnVlKQoKICAgIGlmIHJlc3VsdHM6CiAgICAgICAgIyBoYXNoTWFwLnB1dCgnaWRfZG9jJywgc3RyKHJlc3VsdHNbMF1bJ2lkX2RvYyddKSkKICAgICAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgICAgIHBpYyA9ICcjZjAwYycKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHN0cihyZWNvcmRbJ2JhcmNvZGUnXSksCiAgICAgICAgICAgICAgICAnYmFyY29kZSc6IHN0cihyZWNvcmRbJ2JhcmNvZGUnXSksCgogICAgICAgICAgICB9CgogICAgICAgICAgICBkb2NfZGV0YWlsX2xpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICAgICAgIyDQn9GA0LjQt9C90LDQuiwgaGF2ZV9xdHR5X3BsYW4g0JXRgdGC0YzQn9C70LDQvdCf0J7QmtCe0LvQuNGH0LXRgdGC0LLRgyAgLSAg0JjRgdGC0LjQvdCwINC60L7Qs9C00LAg0YHRg9C80LzQsCDQutC+0LvQvtC90LrQuCBRdHR5X3BsYW4gPiAwCiAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAgaGF2ZV9tYXJrX3BsYW4gItCV0YHRgtGM0J/Qu9Cw0L3QmtCe0LTQvtCy0JzQsNGA0LrQuNGA0L7QstC60Lgg4oCTINCY0YHRgtC40L3QsCwg0LrQvtCz0LTQsCDQutC+0LvQuNGH0LXRgdGC0LLQviDRgdGC0YDQvtC6INGC0LDQsdC7LiBSU19kb2NzX2JhcmNvZGVzINGBINC30LDQtNCw0L3QvdGL0LwgaWRfZG9jINC4IGlzX3BsYW4gINCx0L7Qu9GM0YjQtSDQvdGD0LvRjy4KICAgICAgICAjINCf0YDQuNC30L3QsNC6IGhhdmVfemVyb19wbGFuICLQldGB0YLRjCDRgdGC0YDQvtC60Lgg0YLQvtCy0LDRgNCwINCyINC00L7QutGD0LzQtdC90YLQtSIg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC10YHRgtGMINC30LDQv9C+0LvQvdC10L3QvdGL0LUg0YHRgtGA0L7QutC4INGC0L7QstCw0YDQvtCyINCyINC00L7QutGD0LzQtdC90YLQtQogICAgICAgICMg0J/RgNC40LfQvdCw0LogItCa0L7QvdGC0YDQvtC70LjRgNC+0LLQsNGC0YwiICAtINC/0YDQuNC30L3QsNC6INC00LvRjyDQtNC+0LrRg9C80LXQvdGC0LAsINC90LDQtNC+INC70Lgg0LrQvtC90YLRgNC+0LvQuNGA0L7QstCw0YLRjAoKICAgICAgICBxdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfcXR0eV9zdHJpbmdfY291bnRfcXVlcnkoKQogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCB7J2lkX2RvYyc6IGlkX2RvY30pCiAgICAgICAgaWYgbm90IHJlczoKICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSByZXNbMF1bMF0gPiAwICAjINCSINC00L7QutGD0LzQtdC90YLQtSDQtdGB0YLRjCDRgdGC0YDQvtC60LgKICAgICAgICAgICAgaWYgaGF2ZV96ZXJvX3BsYW46CiAgICAgICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IHJlc1swXVsxXSA+IDAgICMg0JIg0LTQvtC60YPQvNC10L3RgtC1INC10YHRgtGMINC60L7Qu9Cy0L4g0L/Qu9Cw0L0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICAjINCV0YHRgtGMINC70Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1INC/0LvQsNC9INC/0L4g0LrQvtC00LDQvCDQvNCw0YDQutC40YDQvtCy0LrQuAogICAgICAgIHF0ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9oYXZlX21hcmtfY29kZXNfcXVlcnkoKQogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCB7J2lkX2RvYyc6IGlkX2RvYywgJ2lzX3BsYW4nOiAnMSd9KQogICAgICAgIGlmIG5vdCByZXM6CiAgICAgICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSByZXNbMF1bMF0gPiAwCiAgICBlbHNlOgogICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICBoYXZlX3plcm9fcGxhbiA9IEZhbHNlCiAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBGYWxzZQoKICAgIGhhc2hNYXAucHV0KCdoYXZlX3F0dHlfcGxhbicsIHN0cihoYXZlX3F0dHlfcGxhbikpCiAgICBoYXNoTWFwLnB1dCgnaGF2ZV96ZXJvX3BsYW4nLCBzdHIoaGF2ZV96ZXJvX3BsYW4pKQogICAgaGFzaE1hcC5wdXQoJ2hhdmVfbWFya19wbGFuJywgc3RyKGhhdmVfbWFya19wbGFuKSkKICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCdTRUxFQ1QgY29udHJvbCBmcm9tIFJTX2RvY3MgIFdIRVJFIGlkX2RvYyA9ID8nLCAoaWRfZG9jLCkpCiAgICAjINCV0YHRgtGMINC70Lgg0LrQvtC90YLRgNC+0LvRjCDQv9C70LDQvdCwINCyINC00L7QutGD0LzQtdC90YLQtQogICAgaWYgcmVzOgogICAgICAgIGlmIHJlc1swXVswXToKICAgICAgICAgICAgaWYgcmVzWzBdWzBdIGluIGZhbHNlVmFsdWVMaXN0OgogICAgICAgICAgICAgICAgY29udHJvbCA9ICdGYWxzZScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnVHJ1ZScKCiAgICAgICAgICAgICMgY29udHJvbCA9IHJlc1swXVswXSAjJ1RydWUnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29udHJvbCA9ICdGYWxzZScKICAgIGVsc2U6CiAgICAgICAgY29udHJvbCA9ICdGYWxzZScKCiAgICBoYXNoTWFwLnB1dCgnY29udHJvbCcsIGNvbnRyb2wpCiAgICBoYXNoTWFwLnB1dCgiZG9jX2JhcmNfZmxvdyIsIGpzb24uZHVtcHMoZG9jX2RldGFpbF9saXN0KSkKCiAgICBpZiBUcnVlIGluIChoYXZlX3F0dHlfcGxhbiwgaGF2ZV96ZXJvX3BsYW4sIGhhdmVfbWFya19wbGFuLCBjb250cm9sKToKICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0JTQsNC90L3Ri9C5INC00L7QutGD0LzQtdC90YIg0YHQvtC00LXRgNC20LjRgiDQv9C70LDQvdC+0LLRi9C1INGB0YLRgNC+0LrQuC4g0KHQv9C40YHQvtC6INGI0YLRgNC40YXQutC+0LTQvtCyINCyINC90LXQs9C+INC/0L7QvNC10YHRgtC40YLRjCDQvdC10LvRjNC30Y8nKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywn0JTQvtC60YPQvNC10L3RgtGLJykKCiAgICByZXR1cm4gaGFzaE1hcAoKZGVmIGJhcmNvZGVfZmxvd19saXN0ZW5lcihoYXNoTWFwLCAgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgnbGlzdGVuZXInKQogICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgoKICAgICAgICBwYXNzCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiQkFDS19CVVRUT04iOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fYmFyY29kZXMiOgogICAgICAgIHBhc3MKICAgICAgICAjaGFzaE1hcC5wdXQoIlNob3dEaWFsb2ciLCAi0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCIpCgogICAgIyBlbGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKCiAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJyBvciBoYXNoTWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgZG9jID0gdWlfZ2xvYmFsLlJzX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICBpZiBoYXNoTWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgICAgIGJhcmNvZGUgPSBoYXNoTWFwLmdldCgnZmxkX2JhcmNvZGUnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJhcmNvZGUgPSBoYXNoTWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQoKICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IGhhc2hNYXAuZ2V0KCdoYXZlX3F0dHlfcGxhbicpCiAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBoYXNoTWFwLmdldCgnaGF2ZV96ZXJvX3BsYW4nKQogICAgICAgIGhhdmVfbWFya19wbGFuID0gaGFzaE1hcC5nZXQoJ2hhdmVfbWFya19wbGFuJykKICAgICAgICBjb250cm9sID0gaGFzaE1hcC5nZXQoJ2NvbnRyb2wnKQoKICAgICAgICBpZiBiYXJjb2RlOgogICAgICAgICAgICBxdGV4dCA9ICcnJwogICAgICAgICAgICBJTlNFUlQgSU5UTyBSU19iYXJjX2Zsb3cgKGlkX2RvYywgYmFyY29kZSkgVkFMVUVTICg/LD8pCiAgICAgICAgICAgICcnJwogICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwoZG9jLmlkX2RvYywgYmFyY29kZSkpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RvY19tYXJrX3ZlcmlmaWVkJzoKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGRvYy5tYXJrX3ZlcmlmaWVkKGRvYywgMSkKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgtGLIikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiB0aW1lcl91cGRhdGUoaGFzaE1hcCwgIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIHVybCA9IGdldF9odHRwX3NldHRpbmdzKGhhc2hNYXApCiAgICAjdXJsID0gJ2h0dHA6Ly8xOTIuMTY4LjEuNzcvTlNJL2hzL3NpbXBsZV9hY2NvdW50aW5nL2RhdGEnCgogICAgI2hhc2hNYXAucHV0KCd0b2FzdCcsICfQntCx0LzQtdC9JykgI3VybCkKICAgIHRyeToKICAgICAgICByZXN1bHQgPSBodHRwX2V4Y2hhbmdlLnNlcnZlcl9sb2FkX2RhdGEodXJsKQogICAgZXhjZXB0OgogICAgICAgIHJhaXNlICfQntGI0LjQsdC60LAg0LfQsNC/0YDQvtGB0LAg0LogSFRUUCcKICAgIGlmIHJlc3VsdFsnc3RhdHVzX2NvZGUnXSA9PTIwMDoKICAgICAgICBpZiByZXN1bHQuZ2V0KCdiYXRjaCcpIGlzIG5vdCBOb25lOgogICAgICAgICAgICByc19zZXR0aW5ncy5wdXQoJ2JhdGNoJywgcmVzdWx0LmdldCgnYmF0Y2gnKSxUcnVlKQogICAgICAgICAgICByc19zZXR0aW5ncy5wdXQoJ251bWJlcl9vZl9yZWNlaXZlZCcsJzAnLCBUcnVlKQoKICAgICAgICBpZiByZXN1bHQuZ2V0KCdyZXNfZm9yX3NxbCcpIGlzIG5vdCBOb25lOgoKICAgICAgICAgICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCdiYXRjaCcpIGlzIG5vdCBOb25lOiAgI9Cc0Ysg0LLRi9C/0L7Qu9C90Y/QtdC8INC/0LDQutC10YIg0LfQsNCz0YDRg9C30LrQuCwg0LTQsNC90L3Ri9C1INGA0LDQt9Cx0LjRgtGLINC90LAg0L3QtdGB0LrQvtC70YzQutC+INGE0LDQudC70L7Qsiwg0LjRhSDQutC+0LvQuNGH0LXRgdGC0LLQviDQsiBiYXRjaAogICAgICAgICAgICAgICAgbnVtYmVyX29mX3JlY2VpdmVkID0gMCBpZiByc19zZXR0aW5ncy5nZXQoJ251bWJlcl9vZl9yZWNlaXZlZCcpPT0gJ25vdCBmb3VuZCcgZWxzZSBpbnQocnNfc2V0dGluZ3MuZ2V0KCdudW1iZXJfb2ZfcmVjZWl2ZWQnKSkKICAgICAgICAgICAgICAgIHRvdGFsX3JlY2VpdmVkID0gaW50KHJzX3NldHRpbmdzLmdldCgnYmF0Y2gnKSkKICAgICAgICAgICAgICAgIG51bWJlcl9vZl9yZWNlaXZlZCA9KzEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRvdGFsX3JlY2VpdmVkID0gTm9uZQoKICAgICAgICAgICAgc3FsX2Vycm9yID0gRmFsc2UKICAgICAgICAgICAgZXJyb3JfcG9vbCA9IFtdCiAgICAgICAgICAgIGZvciBrZXkgaW4gcmVzdWx0WydyZXNfZm9yX3NxbCddOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KGtleSkKICAgICAgICAgICAgICAgICAgICAjIHJldHVybiAnb2snCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgc3FsX2Vycm9yID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGVycm9yX3Bvb2wuYXBwZW5kKGUuYXJnc1swXSkKCgogICAgICAgICAgICBpZiB0b3RhbF9yZWNlaXZlZDoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQmNC00LXRgiDQt9Cw0LPRgNGD0LfQutCwINCx0L7Qu9GM0YjQvtCz0L4g0L7QsdGK0LXQvNCwINC00LDQvdC90YvRhS4g0J/QvtC70YPRh9C10L3QviAnKyBzdHIobnVtYmVyX29mX3JlY2VpdmVkKjUwMDAwKSArICfQuNC3LCDQv9GA0LjQvNC10YDQvdC+ICcrIHN0cih0b3RhbF9yZWNlaXZlZCo1MDAwMCkpCiAgICAgICAgICAgICAgICByc19zZXR0aW5ncy5wdXQoJ251bWJlcl9vZl9yZWNlaXZlZCcsc3RyKG51bWJlcl9vZl9yZWNlaXZlZCksIFRydWUpCgogICAgICAgICAgICBpZiBzcWxfZXJyb3I6CiAgICAgICAgICAgICAgICByc19zZXR0aW5ncy5wdXQoJ2Vycm9yX2xvZycsIHN0cihlcnJvcl9wb29sKSwgVHJ1ZSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQn9GA0Lgg0LfQsNCz0YDRg9C30LrQtSDQsdGL0LvQuCDQvtGI0LjQsdC60LguINCf0YDQvtCy0LXRgNGM0YLQtSDQuNGFINCyINC90LDRgdGC0YDQvtC50LrQsNGFICjQutC90L7Qv9C60LAg0L/QvtGB0LzQvtGC0YDQtdGC0Ywg0L7RiNC40LHQutC4KScpCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfc2NyZWVuX25hbWUnKSA9PSAn0JTQvtC60YPQvNC10L3RgtGLJzoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9CU0L7QutGD0LzQtdC90YLRiycpCiAgICAgICAgICAgICNkb2NzX29uX3N0YXJ0KGhhc2hNYXApCiAgICAgICAgI3RpbGVzX29uX3N0YXJ0KGhhc2hNYXApCiAgICAgICAgICAgIGRvY3NfYWRyX29uX3N0YXJ0KGhhc2hNYXApCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdSZWZyZXNoU2NyZWVuJywnJykKCiAgICBlbHNlOgoKICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCBzdHIocmVzdWx0WydlcnJvcl9wb29sJ10pKQoKICAgIHF0ZXh0ID0gJycnU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2RvY3MgV0hFUkUgdmVyaWZpZWQgPSAxICBhbmQgKHNlbnQgPD4gMSBvciBzZW50IGlzIG51bGwpCiAgICAgICAgICAgICAgICBVTklPTgogICAgICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2Fkcl9kb2NzIFdIRVJFIHZlcmlmaWVkID0gMSAgYW5kIChzZW50IDw+IDEgb3Igc2VudCBpcyBudWxsKScnJwogICAgcmVzICA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LE5vbmUsVHJ1ZSkKCiAgICBpZiByZXM6CiAgICAgICAgZG9jX2xpc3QgPSBbXQogICAgICAgIGZvciBlbCBpbiByZXM6CiAgICAgICAgICAgIGRvY19saXN0LmFwcGVuZCgnIicrIGVsWydpZF9kb2MnXSsnIicpCiAgICAgICAgZG9jX2luX3N0ciA9ICcsJy5qb2luKGRvY19saXN0KQogICAgICAgICNodHBwYXJhbXMgPSB7J3VzZXJuYW1lJzpoYXNoTWFwLmdldCgnb25saW5lVXNlcicpLCAncGFzc3dvcmQnOmhhc2hNYXAuZ2V0KCdvbmxpbmVQYXNzJyksICd1cmwnOnVybH0KICAgICAgICBhbnN3ZXIgPSBodHRwX2V4Y2hhbmdlLnBvc3RfY2hhbmdlc190b19zZXJ2ZXIoZG9jX2luX3N0ciAsIHVybCkKICAgICAgICBpZiBhbnN3ZXIuZ2V0KCdFcnJvcicpIGlzIG5vdCBOb25lOgogICAgICAgICAgICByc19zZXR0aW5ncy5wdXQoJ2Vycm9yX2xvZycsIHN0cihhbnN3ZXIuZ2V0KCdFcnJvcicpKSwgVHJ1ZSkKICAgICAgICBlbHNlOgoKICAgICAgICAgICAgcXRleHQgPSBmJ1VQREFURSBSU19kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2Fkcl9kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgc2V0dGluZ3NfZXJyb3JzX29uX3N0YXJ0KGhhc2hNYXAsICBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBlcnIgPSByc19zZXR0aW5ncy5nZXQoJ2Vycm9yX2xvZycpCiAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbG9nJywgZXJyKQogICAgcmV0dXJuIGhhc2hNYXAKCmRlZiBzZXR0aW5nc19lcnJvcnNfb25fY2xpY2soaGFzaE1hcCwgIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykKICAgIGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKICAgICAgICAjaGFzaE1hcC5wdXQoJ0ZpbmlzaFByb2Nlc3MnLCAnJykKCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fY2xlYXJfZXJyJzoKICAgICAgICByc19zZXR0aW5ncy5wdXQoJ2Vycm9yX2xvZycsJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2Vycm9yX2xvZycsJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1JlZnJlc2hTY3JlZW4nLCcnKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCk6CiAgICBodHRwX3NldHRpbmdzID0gewogICAgJ3VybCcgOiByc19zZXR0aW5ncy5nZXQoIlVSTCIpLAogICAgJ3VzZXInIDogcnNfc2V0dGluZ3MuZ2V0KCdVU0VSJyksCiAgICAncGFzcycgOiByc19zZXR0aW5ncy5nZXQoJ1BBU1MnKSwKICAgICdkZXZpY2VfbW9kZWwnIDogaGFzaE1hcC5nZXQoJ0RFVklDRV9NT0RFTCcpLAogICAgJ2FuZHJvaWRfaWQnOmhhc2hNYXAuZ2V0KCdBTkRST0lEX0lEJyksCiAgICAndXNlcl9uYW1lJzogcnNfc2V0dGluZ3MuZ2V0KCd1c2VyX25hbWUnKX0KICAgIHJldHVybiBodHRwX3NldHRpbmdzCgpkZWYgaHR0cF9zZXR0aW5nc19vbl9zdGFydChoYXNoTWFwLCAgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgdXJsID0gaGFzaE1hcC5nZXQoJ3VybCcpCiAgICBoYXNoTWFwLnB1dCgnYnRuX3Rlc3RfY29ubmVjdGlvbicsICfQotC10YHRgiDRgdC+0LXQtNC40L3QtdC90LjRjycpCiAgICBpZiB1cmwgPT0gJycgb3IgJ25vdCBmb3VuZCc6ICAj0J7QsdC90L7QstC70Y/QtdC8INGC0L7Qu9GM0LrQviDQtdGB0LvQuCDRgNCw0L3QtdC1INC90LUg0YPRgdGC0LDQvdC+0LLQu9C10L3RiwogICAgICAgIGh0dHBfc2V0dGluZ3MgPSBnZXRfaHR0cF9zZXR0aW5ncyhoYXNoTWFwKQogICAgICAgIGhhc2hNYXAucHV0KCd1cmwnLCAgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VybCcsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1cmwnXSwgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkgIyAgKQogICAgICAgIGhhc2hNYXAucHV0KCd1c2VyJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VzZXInLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sndXNlciddLCBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKQogICAgICAgIGhhc2hNYXAucHV0KCdwYXNzJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3Bhc3MnLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sncGFzcyddLCBwYXNzd29yZD1UcnVlKS50b19qc29uKCkpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3VzZXJfbmFtZScsdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VzZXJfbmFtZScsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1c2VyX25hbWUnXSwgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGh0dHBfc2V0dGluZ3Nfb25fY2xpY2soaGFzaE1hcCwgIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykKICAgIGlmIGxpc3RlbmVyID09ICdidG5fc2F2ZSc6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdVUkwnLCBoYXNoTWFwLmdldCgndXJsJyksVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoJ1VTRVInLCBoYXNoTWFwLmdldCgndXNlcicpLCBUcnVlKQogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnUEFTUycsIGhhc2hNYXAuZ2V0KCdwYXNzJyksIFRydWUpCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCd1c2VyX25hbWUnLCBoYXNoTWFwLmdldCgndXNlcl9uYW1lJyksIFRydWUpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2NhbmNlbCc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCiAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICBiYXJjb2RlID0gaGFzaE1hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhMicpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBiYXJjX3N0cnVjdCA9IGpzb24ubG9hZHMoYmFyY29kZSkKCiAgICAgICAgICAgIHJzX3NldHRpbmdzLnB1dCgnVVJMJywgYmFyY19zdHJ1Y3QuZ2V0KCd1cmwnKSwgVHJ1ZSkKICAgICAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdVU0VSJywgYmFyY19zdHJ1Y3QuZ2V0KCd1c2VyJyksIFRydWUpCiAgICAgICAgICAgIHJzX3NldHRpbmdzLnB1dCgnUEFTUycsIGJhcmNfc3RydWN0LmdldCgncGFzcycpLCBUcnVlKQogICAgICAgICAgICByc19zZXR0aW5ncy5wdXQoJ3VzZXJfbmFtZScsIGJhcmNfc3RydWN0LmdldCgndXNlcl9uYW1lJyksIFRydWUpCgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndXJsJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VybCcsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3VybCcpKS50b19qc29uKCkpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd1c2VyJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VzZXInLCBkZWZhdWx0X3RleHQ9YmFyY19zdHJ1Y3QuZ2V0KCd1c2VyJykpLnRvX2pzb24oKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3Bhc3MnLCB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0ncGFzcycsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3Bhc3MnKSkudG9fanNvbigpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgndXNlcl9uYW1lJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VzZXJfbmFtZScsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3VzZXJfbmFtZScpKS50b19qc29uKCkpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0L3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIgUVIt0LrQvtC00LAnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Rlc3RfY29ubmVjdGlvbic6CiAgICAgICAgIy9jb21tdW5pY2F0aW9uX3Rlc3QKICAgICAgICBodHRwID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKICAgICAgICByID0gcmVxdWVzdHMuZ2V0KGh0dHBbJ3VybCddICsgJy9zaW1wbGVfYWNjb3VudGluZy9jb21tdW5pY2F0aW9uX3Rlc3Q/YW5kcm9pZF9pZD0nICsgaHR0cFsnYW5kcm9pZF9pZCddLCBhdXRoPUhUVFBCYXNpY0F1dGgoaHR0cFsndXNlciddLCBodHRwWydwYXNzJ10pLAogICAgICAgICAgICAgaGVhZGVycz17J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9dXRmLTgnfSwKICAgICAgICAgICAgIHBhcmFtcz17J3VzZXJfbmFtZSc6IGh0dHBbJ3VzZXJfbmFtZSddLCAnZGV2aWNlX21vZGVsJzogaHR0cFsnZGV2aWNlX21vZGVsJ119KQogICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnYnRuX3Rlc3RfY29ubmVjdGlvbicsICfQodC+0LXQtNC40L3QtdC90LjQtSDRg9GB0YLQsNC90L7QstC70LXQvdC+JykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Ch0L7QtdC00LjQvdC10L3QuNC1INGD0YHRgtCw0L3QvtCy0LvQtdC90L4nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdidG5fdGVzdF9jb25uZWN0aW9uJywgJ9Ci0LXRgdGCINGB0L7QtdC00LjQvdC10L3QuNGPJykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Cd0LUg0YPQtNCw0LvQvtGB0Ywg0YPRgdGC0LDQvdC+0LLQuNGC0Ywg0YHQvtC10LTQuNC90LXQvdC40LUnKQoKICAgIHJldHVybiBoYXNoTWFwCgojINCX0LDQv9C+0LvQvdC10L3QuNC1INGB0L/QuNGB0LrQsCDQtNC+0LrRg9C80LXQvdGC0L7QsgpkZWYgcmVmaWxsX2Fkcl9kb2NzX2xpc3QoZmlsdGVyPScnKToKICAgIGRvY19saXN0ID0gdWlfZm9ybV9kYXRhLmdldF9kb2NfY2FyZChyc19zZXR0aW5ncywgJzvQntGC0LrRgNGL0YLRjCDQvtGC0LHQvtGAO9Ce0YLQutGA0YvRgtGMINGA0LDQt9C80LXRidC10L3QuNC1JykKICAgIGRvY19saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXSA9IFtdCgogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfYWRyX2RvY19xdWVyeShmaWx0ZXIpCgogICAgaWYgZmlsdGVyID09IE5vbmUgb3IgZmlsdGVyID09ICcnIG9yIGZpbHRlciA9PSAn0JLRgdC1JzoKICAgICAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCkKICAgIGVsc2U6CiAgICAgICAgcmVzdWx0cyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChmaWx0ZXIsKSkKCiAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgY29tcGxldGVkID0gJ3RydWUnIGlmIHJlY29yZFs2XSA9PSAxIGVsc2UgJ2ZhbHNlJwogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiA9ICd0cnVlJyBpZiByZWNvcmRbOF0gPT0gMSBlbHNlICdmYWxzZScKCiAgICAgICAgcHJvZHVjdF9yb3cgPSB7CiAgICAgICAgICAgICdjb21wbGV0ZWQnOiBjb21wbGV0ZWQsCiAgICAgICAgICAgICd0eXBlJzogc3RyKHJlY29yZFsxXSksCiAgICAgICAgICAgICdudW1iZXInOiBzdHIocmVjb3JkWzJdKSwKICAgICAgICAgICAgJ2RhdGEnOiBzdHIocmVjb3JkWzNdKSwKICAgICAgICAgICAgJ2tleSc6IHJlY29yZFswXSwKICAgICAgICAgICAgJ3dhcmVob3VzZSc6IHJlY29yZFs1XSwKICAgICAgICAgICAgJ2FkZF9tYXJrX3NlbGVjdGlvbic6IGFkZF9tYXJrX3NlbGVjdGlvbgogICAgICAgIH0KICAgICAgICBkb2NfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10uYXBwZW5kKHByb2R1Y3Rfcm93KQoKICAgIHJldHVybiBqc29uLmR1bXBzKGRvY19saXN0KQoKCmRlZiBkb2NzX2Fkcl9vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICAjINCX0LDQv9C+0LvQvdC40Lwg0L/QvtC70LUg0YTQuNC70YzRgtGA0LAg0L/QviDQstC40LTRgyDQtNC+0LrRg9C80LXQvdGC0L7QsgogICAgZG9jX3R5cGVfbGlzdCA9IFsn0JLRgdC1Jywn0J7RgtCx0L7RgCcsJ9Cg0LDQt9C80LXRidC10L3QuNC1Jywn0J/QtdGA0LXQvNC10YnQtdC90LjQtSddCiAgICBoYXNoTWFwLnB1dCgnZG9jX2Fkcl90eXBlX3NlbGVjdCcsICc7Jy5qb2luKGRvY190eXBlX2xpc3QpKQoKICAgICNoYXNoTWFwLnB1dCgnZmxkX251bWJlcicsJzEnKQoKICAgICMgaGFzaE1hcC5wdXQoJ2RvY190eXBlX2NsaWNrJywgJ9CS0YHQtScpCiAgICAjINCV0YHQu9C4INCS0YvQt9C+0LIg0Y3QutGA0LDQvdCwINC40Lcg0LzQtdC90Y4g0L/Qu9C40YLQvtC6IC0g0L7QsdGA0LDQsdC+0YLQsNC10LwKCiAgICAjINCf0LXRgNC10LfQsNC/0L7Qu9C90LjQvCDRgdC/0LjRgdC+0Log0LTQvtC60YPQvNC10L3RgtC+0LIKICAgIGlmIGhhc2hNYXAuZ2V0KCdkb2NfYWRyX3R5cGVfY2xpY2snKSA9PSBOb25lOgogICAgICAgIGxzID0gcmVmaWxsX2Fkcl9kb2NzX2xpc3QoKQogICAgZWxzZToKICAgICAgICBscyA9IHJlZmlsbF9hZHJfZG9jc19saXN0KGhhc2hNYXAuZ2V0KCdkb2NfYWRyX3R5cGVfY2xpY2snKSkKICAgIGhhc2hNYXAucHV0KCJkb2NBZHJDYXJkcyIsIGxzKQoKICAgIHJldHVybiBoYXNoTWFwCgpkZWYgb3Blbl9hZHJfZG9jX3RhYmxlKGhhc2hNYXAsIGZpbHRlciA9ICcnKToKICAgICMg0J3QsNGF0L7QtNC40LwgSUQg0LTQvtC60YPQvNC10L3RgtCwCiAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgiZG9jQWRyQ2FyZHMiKSkKICAgIGN1cnJlbnRfZG9jID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0cildCgogICAgIyBpZF9kb2MgPSBjdXJyZW50X2RvY1sna2V5J10KICAgIGhhc2hNYXAucHV0KCdpZF9kb2MnLCBjdXJyZW50X2RvY1sna2V5J10pCiAgICBoYXNoTWFwLnB1dCgnZG9jX3R5cGUnLCBjdXJyZW50X2RvY1sndHlwZSddKQogICAgaGFzaE1hcC5wdXQoJ2RvY19uJywgY3VycmVudF9kb2NbJ251bWJlciddKQogICAgaGFzaE1hcC5wdXQoJ2RvY19kYXRlJywgY3VycmVudF9kb2NbJ2RhdGEnXSkKICAgIGhhc2hNYXAucHV0KCd3YXJlaG91c2UnLCBjdXJyZW50X2RvY1snd2FyZWhvdXNlJ10pCiAgICBmaWx0ZXIgPSAnaW4nICBpZiBjdXJyZW50X2RvY1sndHlwZSddID09ICfQoNCw0LfQvNC10YnQtdC90LjQtScgZWxzZSAnb3V0JwogICAgaWYgZmlsdGVyOgogICAgICAgIGhhc2hNYXAucHV0KCd0YWJsZV90eXBlX2ZpbHRlcicsIGZpbHRlcikKCgoKZGVmIGRvY3NfYWRyX29uX3NlbGVjdChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICAgICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgibGlzdGVuZXIiKQoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgb3Blbl9hZHJfZG9jX3RhYmxlKGhhc2hNYXApCiAgICAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJkb2NfYWRyX3R5cGVfY2xpY2siOgoKICAgICAgICAgICAgbHMgPSByZWZpbGxfYWRyX2RvY3NfbGlzdChoYXNoTWFwLmdldCgnZG9jX2Fkcl90eXBlX2NsaWNrJykpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdkb2NDYXJkcycsIGxzKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgICAgIGxheW91dF9saXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsYXlvdXRfbGlzdGVuZXInKQogICAgICAgICAgICAjINCd0LDRhdC+0LTQuNC8IElEINC00L7QutGD0LzQtdC90YLQsAogICAgICAgICAgICBjdXJyZW50X2RvYyA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImNhcmRfZGF0YSIpKQogICAgICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfYWRyX2RvYwogICAgICAgICAgICBkb2MuaWRfZG9jID0gY3VycmVudF9kb2NbJ2tleSddCgogICAgICAgICAgICBpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ0NoZWNrQm94MSc6CiAgICAgICAgICAgICAgICBpZiBjdXJyZW50X2RvY1snY29tcGxldGVkJ10gPT0gJ2ZhbHNlJzoKICAgICAgICAgICAgICAgICAgICBkb2MubWFya192ZXJpZmllZChkb2MsIDEpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGRvYy5tYXJrX3ZlcmlmaWVkKGRvYywgMCkKCiAgICAgICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQn9C+0LTRgtCy0LXRgNC00LjRgtGMJzoKICAgICAgICAgICAgICAgIGRvYy5tYXJrX3ZlcmlmaWVkKGRvYywgMSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9CU0L7QutGD0LzQtdC90YLRiycpCiAgICAgICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICAgICAgZG9jLmNsZWFyX2JhcmNvZGVfZGF0YShkb2MpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0JTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCDQuCDQvNCw0YDQutC40YDQvtCy0LrQuCDQvtGH0LjRidC10L3RiycpCiAgICAgICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQo9C00LDQu9C40YLRjCc6CiAgICAgICAgICAgICAgICBkb2MuZGVsZXRlX2RvYyhkb2MpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICAgICAgZG9jLmRlbGV0ZV9kb2MoZG9jKQogICAgICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0J7RgtC60YDRi9GC0Ywg0L7RgtCx0L7RgCc6CgogICAgICAgICAgICAgICAgb3Blbl9hZHJfZG9jX3RhYmxlKGhhc2hNYXAsICdvdXQnKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0J7RgtC60YDRi9GC0Ywg0YDQsNC30LzQtdGJ0LXQvdC40LUnOgogICAgICAgICAgICAgICAgb3Blbl9hZHJfZG9jX3RhYmxlKGhhc2hNYXAsICdpbicpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9hZGRfZG9jIjoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QvtCy0YvQuSDQtNC+0LrRg9C80LXQvdGCJykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cd0L7QstGL0Lkg0LTQvtC60YPQvNC10L3RgicpCiAgICAgICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgbmV3X2Fkcl9kb2Nfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2RvY19hZHJfdHlwZV9zZWxlY3QnKSA9PSBOb25lOgogICAgICAgICMg0JfQsNC/0L7Qu9C90LjQvCDQv9C+0LvQtSDRhNC40LvRjNGC0YDQsCDQv9C+INCy0LjQtNGDINC00L7QutGD0LzQtdC90YLQvtCyCiAgICAgICAgZG9jX3R5cGVfbGlzdCA9IFsn0J7RgtCx0L7RgCcsICfQoNCw0LfQvNC10YnQtdC90LjQtScsICfQn9C10YDQtdC80LXRidC10L3QuNC1J10KICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2Fkcl90eXBlX3NlbGVjdCcsICc7Jy5qb2luKGRvY190eXBlX2xpc3QpKQoKCiAgICBpZiBoYXNoTWFwLmdldCgnd2FyZWhvdXNlJykgPT0gTm9uZToKICAgICAgICAjZmxkX2NvdW50cmFnZW50ID0gdWlfZ2xvYmFsLmdldF9uYW1lX2xpc3QoJ1JTX3dhcmVob3VzZXMnKQogICAgICAgIGhhc2hNYXAucHV0KCd3YXJlaG91c2UnLCAn0KHQutC70LDQtCcpICNkb2Nfd2FyZWhvdXNlCgogICAgaWYgbm90IGhhc2hNYXAuY29udGFpbnNLZXkoJ2RvY19kYXRlJyk6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY19kYXRlJywgJzAxLjAxLjIwMjInKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIG5ld19hZHJfZG9jX29uX3NlbGVjdChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCiAgICB0eXBlID0gaGFzaE1hcC5nZXQoJ2RvY190eXBlX2NsaWNrJykKICAgIGlmIG5vdCB0eXBlIG9yIHR5cGU9PSfQktGB0LUnOgogICAgICAgIHR5cGUgPSAn0J7RgtCx0L7RgCcKICAgIGZsZF9udW1iZXIgPSBoYXNoTWFwLmdldCgnZmxkX251bWJlcicpCgogICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgaWYgbm90IGZsZF9udW1iZXI6CgogICAgICAgICAgICBpZCA9IHVpX2dsb2JhbC5Sc19hZHJfZG9jLmdldF9uZXdfaWQoMSkKICAgICAgICAgICAgIyBpZCA9IChmJ3tpZDowNH0nKQogICAgICAgICAgICAjIGlkID0gInswOjA+NH0iLmZvcm1hdChpZCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZCA9IGZsZF9udW1iZXIKCiAgICAgICAgdHJ5OgogICAgICAgICAgICB1aV9nbG9iYWwuUnNfYWRyX2RvYy5hZGQoJzAxJywgKGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLCAgIyBoYXNoTWFwLmdldCgnZmxkX251bWJlcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLmdldCgnZmxkX2RhdGEnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpX2dsb2JhbC5nZXRfYnlfbmFtZShoYXNoTWFwLmdldCgnZG9jX3dhcmVob3VzZScpLCAnUlNfd2FyZWhvdXNlcycpKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0JTQvtC60YPQvNC10L3RgtGLJykKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQndC+0LzQtdGAINC00L7QutGD0LzQtdC90YLQsCDQvdC10YPQvdC40LrQsNC70LXQvSEnKQoKCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fY2FuY2VsJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnZmxkX2RhdGEnOgogICAgICAgIGhhc2hNYXAucHV0KCdkb2NfZGF0ZScsIGhhc2hNYXAuZ2V0KCdmbGRfZGF0YScpKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSdidG5fc2VsZWN0X3dhcmVob3VzZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfd2FyZWhvdXNlcycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfY2VsbF92YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCAnbmFtZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9jZWxsX3ZhbHVlJzoKICAgICAgICBpZiBoYXNoTWFwLmdldCgndGFibGVfZm9yX3NlbGVjdCcpID09ICdSU193YXJlaG91c2VzJzoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3dhcmVob3VzZScsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkgICMgZmxkX2NvdW50cmFnZW50CgogICAgcmV0dXJuIGhhc2hNYXAKCmRlZiB1bml2ZXJzYWxfY2FyZHNfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgZmlsdGVyX3ZhbHVlID1oYXNoTWFwLmdldCgnU2VhcmNoU3RyaW5nJykKICAgIGlmIGZpbHRlcl92YWx1ZToKICAgICAgIGZpbHRlcl9maWVsZHMgPSBoYXNoTWFwLmdldCgnZmlsdGVyX2ZpZWxkcycpLnNwbGl0KCc7JykKICAgIGVsc2U6CiAgICAgICAgZmlsdGVyX2ZpZWxkcyA9IGxpc3QoKQogICAgaGFzaE1hcC5wdXQoJ2NhcmRzJywgZ2V0X3RhYmxlX2NhcmRzKGhhc2hNYXAuZ2V0KCd0YWJsZV9mb3Jfc2VsZWN0JyksZmlsdGVyX2ZpZWxkcyxmaWx0ZXJfdmFsdWUpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHVuaXZlcnNhbF9jYXJkc19saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgibGlzdGVuZXIiKQoKICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImNhcmRzIikpCiAgICAgICAgY3VycmVudF9lbGVtID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0cildCiAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ1NlYXJjaFN0cmluZycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRfaWQnLGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRfbmFtZScsIGN1cnJlbnRfZWxlbVsnbmFtZSddKQogICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzUmVzdWx0JywgJycpCgoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X2NhcmQgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJjdXJyZW50X2NhcmQiKSkKCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnJlbW92ZSgnU2VhcmNoU3RyaW5nJykKICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9pZCcsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzUmVzdWx0JywgJycpCiAgICBlbGlmIGxpc3RlbmVyID09ICdTZWFyY2gnOgogICAgICAgIGZpbHRlcl92YWx1ZSA9IGhhc2hNYXAuZ2V0KCdTZWFyY2hTdHJpbmcnKQogICAgICAgIGlmIGxlbihmaWx0ZXJfdmFsdWUpID4gMjoKICAgICAgICAgICAgZmlsdGVyX2ZpZWxkcyA9IGhhc2hNYXAuZ2V0KCdmaWx0ZXJfZmllbGRzJykuc3BsaXQoJzsnKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY2FyZHMnLCBnZXRfdGFibGVfY2FyZHMoaGFzaE1hcC5nZXQoJ3RhYmxlX2Zvcl9zZWxlY3QnKSwgZmlsdGVyX2ZpZWxkcywgZmlsdGVyX3ZhbHVlKSkKCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdSZWZyZXNoU2NyZWVuJywnJykKICAgICAgICAjdW5pdmVyc2FsX2NhcmRzX29uX3N0YXJ0KGhhc2hNYXApCgogICAgcmV0dXJuIGhhc2hNYXAKCgojINCU0L7QsdCw0LLQu9C10L0g0L/QsNGA0LDQvNC10YLRgCAibm9fbGFiZWwiCmRlZiBnZXRfdGFibGVfY2FyZHModGFibGVfbmFtZTogc3RyLCBmaWx0ZXJfZmllbGRzPWxpc3QoKSwgZmlsdGVyX3ZhbHVlPScnLCBleGNsdWRlX2xpc3Q9bGlzdCgpLCBub19sYWJlbD1GYWxzZSk6CiAgICAjINCf0L7Qu9GD0YfQuNC8INGB0L/QuNGB0L7QuiDQv9C+0LvQtdC5INGC0LDQsdC70LjRhtGLCiAgICAjIHRhYmxlX25hbWUgPSAnUlNfZ29vZHMnCiAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChmIlBSQUdNQSB0YWJsZV9pbmZvKHt0YWJsZV9uYW1lfSkiKQogICAgZmllbGRzID0gW2ZbMV0gZm9yIGYgaW4gcmVzXQogICAgIyDQodC70L7QstCw0YDRjCDRgNGD0YHRgdC60LjRhSDQuNC80LXQvSDQv9C+0LvQtdC5CiAgICBhbGlhc2VzID0gdWlfZm9ybV9kYXRhLmZpZWxkc19hbGlhc19kaWN0KCkKICAgICMg0KHQu9C+0LLQsNGA0Ywg0L/QvtC70LXQuS3RgdGB0YvQu9C+0Log0L3QsCDRgtCw0LHQu9C40YbRiwogICAgdGFibGVzX2RpY3QgPSB1aV9mb3JtX2RhdGEudGFibGVfbmFtZXNfZGljdCgpCgogICAgIyDQodC+0LfQtNCw0LTQuNC8INC30LDQv9GA0L7RgSDQuiDRgtCw0LHQu9C40YbQtS4g0KHRgdGL0LvQvtGH0L3Ri9C1INC/0L7Qu9GPINC30LDQvNC10L3QuNC8INC90LAg0L3QsNC40LzQtdC90L7QstCw0L3QuNC1INC40Lcg0YHQstGP0LfQsNC90L3Ri9GFINGC0LDQsdC70LjRhgogICAgY2FyZF9lbGVtID0gdWlfZm9ybV9kYXRhLmdldF9lbGVtX2RpY3QoMjQpCiAgICBjYXJkcyA9IHVpX2Zvcm1fZGF0YS5nZXRfdW5pdmVyc2FsX2NhcmQoKQoKICAgIHFmaWVsZF90ZXh0ID0gW10KICAgIGxlZnRfam9pbnNfbGlzdCA9IFtdCiAgICBmb3IgZWwgaW4gZmllbGRzOgogICAgICAgIGlmIGVsIG5vdCBpbiBleGNsdWRlX2xpc3Q6CiAgICAgICAgICAgIGxpbmtfdGFibGVfbmFtZSA9IHRhYmxlc19kaWN0LmdldChlbCkKICAgICAgICAgICAgcWZpZWxkX3RleHQuYXBwZW5kKHRhYmxlX25hbWUgKyAnLicgKyBlbCkKCiAgICAgICAgICAgICMg0JTQvtC/0L7Qu9C90LjQvCDQstGL0YXQvtC00L3Rg9GOINGB0YLRgNGD0LrRgtGD0YDRgyDQv9C+0LvRj9C80Lgg0YLQsNCx0LvQuNGG0Ys6CiAgICAgICAgICAgIGFsaWFzZXNfZWxlbSA9IGFsaWFzZXMuZ2V0KGVsKQogICAgICAgICAgICBpZiBhbGlhc2VzX2VsZW06ICAjINCU0LvRjyDRjdGC0L7Qs9C+INC/0L7Qu9GPINC/0YDQtdC00YPRgdC80L7RgtGA0LXQvdCwINC90LDRgdGC0YDQvtC50LrQsAogICAgICAgICAgICAgICAgaWYgbm90IGFsaWFzZXNfZWxlbVsnbmFtZSddID09ICdrZXknOiAgIyDQlNC70Y8g0LrQu9GO0YfQsCDQvdCw0YHRgtGA0L7QudC60Lgg0L3QtSDQvdGD0LbQvdGLCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IG5vX2xhYmVsOgogICAgICAgICAgICAgICAgICAgICAgICAjINC00L7QsdCw0LLQuNC8INC+0L/QuNGB0LDQvdC40LUg0L/QvtC70Y86Li4uCiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVmFsdWUnXSA9IGFsaWFzZXNfZWxlbVsnbmFtZSddCiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVGV4dFNpemUnXSA9IHJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpICAjIGFsaWFzZXNfZWxlbVsndGV4dF9zaXplJ10KICAgICAgICAgICAgICAgICAgICAgICAgY2FyZF9lbGVtWydUZXh0Qm9sZCddID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2xheW91dCddWydFbGVtZW50cyddWzBdWydFbGVtZW50cyddWzBdWydFbGVtZW50cyddLmFwcGVuZChjYXJkX2VsZW0uY29weSgpKQoKICAgICAgICAgICAgICAgICAgICAjINCi0LXQv9C10YDRjCDRgdCw0LzQviDQv9C+0LvQtToKICAgICAgICAgICAgICAgICAgICBjYXJkX2VsZW1bJ1ZhbHVlJ10gPSAnQCcgKyBlbAogICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVGV4dFNpemUnXSA9IHJzX3NldHRpbmdzLmdldChhbGlhc2VzX2VsZW1bJ3RleHRfc2l6ZSddKQogICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVGV4dEJvbGQnXSA9IGFsaWFzZXNfZWxlbVsnVGV4dEJvbGQnXQogICAgICAgICAgICBlbHNlOiAgIyDQmNC90LDRh9C1INC/0YDQvtGB0YLQviDQtNC+0LHQsNCy0LjQvCDQtdCz0L4g0YHQviDRgdGC0LDQvdC00LDRgNGC0L3Ri9C80Lgg0L3QsNGB0YLRgNC+0LnQutCw0LzQuAogICAgICAgICAgICAgICAgY2FyZF9lbGVtWydWYWx1ZSddID0gJ0AnICsgZWwKCiAgICAgICAgICAgIGlmIGxpbmtfdGFibGVfbmFtZToKICAgICAgICAgICAgICAgICMg0K3RgtC+INGB0YHRi9C70LrQsCDQvdCwINGC0LDQsdC70LjRhtGDCiAgICAgICAgICAgICAgICBxZmllbGRfdGV4dC5hcHBlbmQobGlua190YWJsZV9uYW1lICsgZicubmFtZSBhcyB7bGlua190YWJsZV9uYW1lfV9uYW1lJykKICAgICAgICAgICAgICAgIGxlZnRfam9pbnNfbGlzdC5hcHBlbmQoZicnJwogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiB7bGlua190YWJsZV9uYW1lfQogICAgICAgICAgICAgICAgICAgIE9OIHtsaW5rX3RhYmxlX25hbWV9LmlkID0ge3RhYmxlX25hbWV9LntlbH0KICAgICAgICAgICAgICAgICAgICAnJycpCiAgICAgICAgICAgICAgICBjYXJkX2VsZW1bCiAgICAgICAgICAgICAgICAgICAgJ1ZhbHVlJ10gPSBmJ0B7bGlua190YWJsZV9uYW1lfV9uYW1lJyAgIyDQotCw0Log0LrQsNC6INC/0L7Qu9C1INGB0YHRi9C70L7Rh9C90L7QtSAtINC/0LXRgNC10LjQvNC10L3Rg9C10Lwg0LXQs9C+INC60LDQuiDQsiDQt9Cw0L/RgNC+0YHQtQoKICAgICAgICAgICAgIyDQlNC+0LHQsNCy0LjQvCDQv9C+0LvQtSDQsiDQutCw0YDRgtC+0YfQutC4CiAgICAgICAgICAgIGNhcmRzWydjdXN0b21jYXJkcyddWydsYXlvdXQnXVsnRWxlbWVudHMnXVswXVsnRWxlbWVudHMnXVswXVsnRWxlbWVudHMnXS5hcHBlbmQoY2FyZF9lbGVtLmNvcHkoKSkKCiAgICBxdGV4dCA9ICdTZWxlY3QgJyArICcsJy5qb2luKHFmaWVsZF90ZXh0KSArIGYnIEZST00ge3RhYmxlX25hbWV9ICcgKyAnICcuam9pbihsZWZ0X2pvaW5zX2xpc3QpCiAgICAjINCV0YHQu9C4INC10YHRgtGMINGE0LjQu9GM0YLRgNGLL9C+0YLQsdC+0YDRiyAtINC00L7QsdCw0LLQuNC8INC40YUg0LIg0LfQsNC/0YDQvtGBCiAgICBpZiBmaWx0ZXJfdmFsdWU6CiAgICAgICAgIyBjb25kaXRpb25zID0gW2Yie2ZpZWxkfSBMSUtFICcle2ZpbHRlcl92YWx1ZX0lJyIgZm9yIGZpZWxkIGluIGZpbHRlcl9maWVsZHNdCiAgICAgICAgY29uZGl0aW9ucyA9IFtmInt0YWJsZV9uYW1lfS57ZmllbGR9IExJS0UgJyV7ZmlsdGVyX3ZhbHVlfSUnIiBmb3IgZmllbGQgaW4gZmlsdGVyX2ZpZWxkc10KICAgICAgICBxdGV4dCA9IHF0ZXh0ICsgZiIgV0hFUkUgeycgT1IgJy5qb2luKGNvbmRpdGlvbnMpfSIKICAgIHJlc19xdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCBOb25lLCBUcnVlKQogICAgIyBzZXR0aW5nc19nbG9iYWwuZ2V0CgogICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddID0gW10KCiAgICBmb3IgaSBpbiByZXNfcXVlcnk6CiAgICAgICAgcHJvZHVjdF9yb3cgPSB7fQogICAgICAgIGZvciB4IGluIGk6CiAgICAgICAgICAgIGlmIHggPT0gJ2lkJzoKICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93WydrZXknXSA9IHN0cihpW3hdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJvZHVjdF9yb3dbeF0gPSBzdHIoaVt4XSkKCiAgICAgICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICByZXR1cm4ganNvbi5kdW1wcyhjYXJkcykKCgpkZWYgb3Blbl93aF9saXN0X29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICBqID0geyJjdXN0b21jYXJkcyI6IHsKICAgICAgICAgICAgIm9wdGlvbnMiOiB7CiAgICAgICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAgICAgInNhdmVfcG9zaXRpb24iOiBUcnVlCgogICAgICAgICAgICB9LAogICAgICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQG5hbWUiLAogICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiLTEiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiM2RjkzOTMiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CgogICAgICAgIH0KICAgIH0KCiAgICBqWyJjdXN0b21jYXJkcyJdWyJjYXJkc2RhdGEiXSA9IFtdCgogICAgcXVlcnlfdGV4dCA9ICJTRUxFQ1QgKiBGUk9NIFJTX3dhcmVob3VzZXMiCiAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCkKCiAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgYyA9IHsia2V5Ijogc3RyKHJlY29yZFswXSksICJuYW1lIjogc3RyKHJlY29yZFsxXSl9CiAgICAgICAgalsiY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0uYXBwZW5kKGMpCgogICAgaWYgbm90IGhhc2hNYXAuY29udGFpbnNLZXkoIndoX2NhcmRzIik6CiAgICAgICAgaGFzaE1hcC5wdXQoIndoX2NhcmRzIiwganNvbi5kdW1wcyhqLCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdldF9yZW1haW5zKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICBodHRwID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKCiAgICAiIiJpZiBoYXNoTWFwLmdldCgnZ29vZHNfY3VzdG9tX3RhYmxlJyk6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2Vycm9yX21zZycsICcnKSIiIgoKICAgICMgaWRlbnRpZnlfYmFyY29kZV9yZW1haW5zKGhhc2hNYXApCgogICAgaWYgaGFzaE1hcC5nZXQoJ2dvb2RfYXJ0X2lucHV0Jykgb3IgaGFzaE1hcC5nZXQoJ2NlbGxfaW5wdXQnKToKICAgICAgICBpZGVudGlmeV9pbnB1dF90ZXh0KGhhc2hNYXApCgogICAgaWYgbm90IChoYXNoTWFwLmdldCgnZ29vZF9hcnRfaW5wdXQnKSBvciBoYXNoTWFwLmdldCgnd2hfc2VsZWN0Jykgb3IgaGFzaE1hcC5nZXQoJ2NlbGxfaW5wdXQnKSBvciBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfY2VsbF9pZCcpKToKICAgICAgICBoYXNoTWFwLnB1dCgnZ29vZHNfY3VzdG9tX3RhYmxlJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ29iamVjdF9uYW1lJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2NlbGxfbmFtZScsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl9tc2cnLCAi0JTQvtC70LbQtdC9INCx0YvRgtGMINCy0YvQsdGA0LDQvSDRgdC60LvQsNC0LCDRgtC+0LLQsNGAINC40LvQuCDRj9GH0LXQudC60LAiKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCJlcnJvcl9tc2ciKToKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd19lcnJvcl9tc2ciLCAiMSIpCiAgICBlbHNlOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93X2Vycm9yX21zZyIsICItMSIpCgogICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2NlbGxfaWQnKToKCiAgICAgICAgZ2V0X3JlbWFpbnNfdXJsID0gaHR0cFsndXJsJ10gKyAnL3NpbXBsZV9hY2NvdW50aW5nL2dvb2RfYmFsYW5jZXMvY2VsbHM/JwoKICAgICAgICBwYXJhbXMgPSB7J2FuZHJvaWRfaWQnOiBodHRwWydhbmRyb2lkX2lkJ10sICdpZF9jZWxsJzogaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2NlbGxfaWQnKX0KCiAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlID0geyJjdXN0b210YWJsZSI6IHsKICAgICAgICAgICAgIm9wdGlvbnMiOiB7CiAgICAgICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAgICAgInNhdmVfcG9zaXRpb24iOiBUcnVlCiAgICAgICAgICAgIH0sCgogICAgICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCv0YfQtdC50LrQsCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAiU3Ryb2tlV2lkdGgiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICLQotC+0LLQsNGAIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCa0L7Qu9C40YfQtdGB0YLQstC+IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LgiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB9CgoKCiAgICAgICAgdGJvZHlfbGF5b3V0ID0gewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIlN0cm9rZVdpZHRoIjogIjEiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBjZWxsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiMTQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAiUGFkZGluZyI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAiU3Ryb2tlV2lkdGgiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGl0ZW0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNGMEY4RkYiLAogICAgICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCgogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcXVhbnRpdHkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNGMEY4RkYiLAogICAgICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCgogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcHJvcGVydGllcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0KCiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfbmFtZScsIGhhc2hNYXAuZ2V0KCdjZWxsX2lucHV0JykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfc2VsZWN0ZWRfY2VsbF9uYW1lJywgJzEnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX3doX25hbWUnLCAnLTEnKQoKICAgICAgICBpZiBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpOgogICAgICAgICAgICBwYXJhbXNbJ2lkX2dvb2QnXSA9IGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9nb29kX2lkJykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX29iamVjdF9uYW1lJywgaGFzaE1hcC5nZXQoJ29iamVjdF9uYW1lJykgKyAiLCAiICsgaGFzaE1hcC5nZXQoJ2dvb2RfY29kZScpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd19zZWxlY3RlZF9vYmplY3RfbmFtZScsICcxJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd19zZWxlY3RlZF9vYmplY3RfbmFtZScsICctMScpCgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdiYXJjb2RlX2luZm8nKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfYmFyY29kZV9pbmZvJywgJzEnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93X2JhcmNvZGVfaW5mbycsICctMScpCgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX2NlbGxfbmFtZScsICcxJykKCiAgICAgICAgciA9IHJlcXVlc3RzLmdldChnZXRfcmVtYWluc191cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoPUhUVFBCYXNpY0F1dGgoaHR0cFsndXNlciddLCBodHRwWydwYXNzJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycz17J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9dXRmLTgnfSwKICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcz1wYXJhbXMpCgogICAgICAgIGpzb25fcmVzcG9uc2UgPSBqc29uLmxvYWRzKHIudGV4dC5lbmNvZGUoInV0Zi04IikpCgogICAgICAgIHZhbHVlcyA9IDAKICAgICAgICBmb3IgZWxlbWVudCBpbiBqc29uX3Jlc3BvbnNlOgogICAgICAgICAgICBpZiBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdOgogICAgICAgICAgICAgICAgdmFsdWVzICs9IDEKCiAgICAgICAgaWYgdmFsdWVzID09IDA6CiAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDMpCiAgICAgICAgICAgIHRib2R5X2xheW91dFsnRWxlbWVudHMnXS5wb3AoMykKCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2dvb2RfaWQnKToKICAgICAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlWydjdXN0b210YWJsZSddWydsYXlvdXQnXVsnRWxlbWVudHMnXS5wb3AoMSkKICAgICAgICAgICAgdGJvZHlfbGF5b3V0WydFbGVtZW50cyddLnBvcCgxKQoKICAgICAgICBnb29kc19jdXN0b21fdGFibGVbJ2N1c3RvbXRhYmxlJ11bJ2xheW91dCddWydFbGVtZW50cyddLnBvcCgwKQogICAgICAgIHRib2R5X2xheW91dFsnRWxlbWVudHMnXS5wb3AoMCkKCiAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlWyJjdXN0b210YWJsZSJdWyJ0YWJsZWRhdGEiXSA9IFt7fV0KCiAgICAgICAgaSA9IDAKICAgICAgICBmb3IgZWxlbWVudCBpbiBqc29uX3Jlc3BvbnNlOgoKICAgICAgICAgICAgYyA9IHsia2V5Ijogc3RyKGkpLCAiaXRlbSI6IGdldF9uYW1lX2J5X2lkKCJSU19nb29kcyIsIGVsZW1lbnRbImlkX2dvb2QiXSksCiAgICAgICAgICAgICAgICAgInF1YW50aXR5IjogZWxlbWVudFsncXR0eSddLCAnX2xheW91dCc6IHRib2R5X2xheW91dCwKICAgICAgICAgICAgICAgICAnY2VsbCc6IGdldF9uYW1lX2J5X2lkKCJSU19jZWxscyIsIGVsZW1lbnRbImlkX2NlbGwiXSl9CgogICAgICAgICAgICBpZiBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBjWydwcm9wZXJ0aWVzJ10gPSAnJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY1sncHJvcGVydGllcyddID0gZ2V0X25hbWVfYnlfZmllbGQoIlJTX3Byb3BlcnRpZXMiLCAnaWQnLCBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdKQogICAgICAgICAgICBpZiBoYXNoTWFwLmdldCgncHJvcGVydHlfaWQnKToKICAgICAgICAgICAgICAgIGlmIGVsZW1lbnRbImlkX3Byb3BlcnR5Il0gPT0gaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgICAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlWyJjdXN0b210YWJsZSJdWyJ0YWJsZWRhdGEiXS5hcHBlbmQoYykKICAgICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsiY3VzdG9tdGFibGUiXVsidGFibGVkYXRhIl0uYXBwZW5kKGMpCiAgICAgICAgICAgICAgICBpICs9IDEKCiAgICBlbHNlOgoKICAgICAgICBpZiBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpIG9yIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF93YXJlaG91c2VfaWQnKToKCiAgICAgICAgICAgIGdldF9yZW1haW5zX3VybCA9IGh0dHBbJ3VybCddICsgJy9zaW1wbGVfYWNjb3VudGluZy9nb29kX2JhbGFuY2VzL3dhcmVob3VzZXM/JwoKICAgICAgICAgICAgcGFyYW1zID0geydhbmRyb2lkX2lkJzogaHR0cFsnYW5kcm9pZF9pZCddfQoKICAgICAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlID0geyJjdXN0b210YWJsZSI6IHsKICAgICAgICAgICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAgICAgICAgICJzZWFyY2hfZW5hYmxlZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgInNhdmVfcG9zaXRpb24iOiBUcnVlCiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgICJsYXlvdXQiOiB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUGFkZGluZyI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAi0KHQutC70LDQtCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNGMEY4RkYiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3Ryb2tlV2lkdGgiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCi0L7QstCw0YAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlN0cm9rZVdpZHRoIjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICLQmtC+0LvQuNGH0LXRgdGC0LLQviIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNGMEY4RkYiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3Ryb2tlV2lkdGgiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LgiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGJvZHlfbGF5b3V0ID0gewogICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkB3YXJlaG91c2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBpdGVtIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAiU3Ryb2tlV2lkdGgiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcXVhbnRpdHkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBwcm9wZXJ0aWVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpOgogICAgICAgICAgICAgICAgcGFyYW1zWydpZF9nb29kJ10gPSBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLCBoYXNoTWFwLmdldCgnb2JqZWN0X25hbWUnKSArICIsICIgKyBoYXNoTWFwLmdldCgnZ29vZF9jb2RlJykpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd19zZWxlY3RlZF9vYmplY3RfbmFtZScsICcxJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX29iamVjdF9uYW1lJywgJy0xJykKCiAgICAgICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF93YXJlaG91c2VfaWQnKToKICAgICAgICAgICAgICAgIHBhcmFtc1snaWRfd2FyZWhvdXNlJ10gPSBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfd2FyZWhvdXNlX2lkJykKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF93aF9uYW1lJywgaGFzaE1hcC5nZXQoJ3doX3NlbGVjdCcpKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfc2VsZWN0ZWRfd2hfbmFtZScsICcxJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX3doX25hbWUnLCAnLTEnKQoKICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2JhcmNvZGVfaW5mbycpOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfYmFyY29kZV9pbmZvJywgJzEnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfYmFyY29kZV9pbmZvJywgJy0xJykKCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX2NlbGxfbmFtZScsICctMScpCgoKICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldChnZXRfcmVtYWluc191cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aD1IVFRQQmFzaWNBdXRoKGh0dHBbJ3VzZXInXSwgaHR0cFsncGFzcyddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPXsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD11dGYtOCd9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcz1wYXJhbXMpCgogICAgICAgICAgICBqc29uX3Jlc3BvbnNlID0ganNvbi5sb2FkcyhyLnRleHQuZW5jb2RlKCJ1dGYtOCIpKQoKICAgICAgICAgICAgdmFsdWVzID0gMAogICAgICAgICAgICBmb3IgZWxlbWVudCBpbiBqc29uX3Jlc3BvbnNlOgogICAgICAgICAgICAgICAgaWYgZWxlbWVudFsiaWRfcHJvcGVydHkiXToKICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgKz0gMQoKICAgICAgICAgICAgaWYgdmFsdWVzID09IDA6CiAgICAgICAgICAgICAgICBnb29kc19jdXN0b21fdGFibGVbJ2N1c3RvbXRhYmxlJ11bJ2xheW91dCddWydFbGVtZW50cyddLnBvcCgzKQogICAgICAgICAgICAgICAgdGJvZHlfbGF5b3V0WydFbGVtZW50cyddLnBvcCgzKQoKICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2dvb2RfaWQnKToKICAgICAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDEpCiAgICAgICAgICAgICAgICB0Ym9keV9sYXlvdXRbJ0VsZW1lbnRzJ10ucG9wKDEpCgogICAgICAgICAgICBpZiBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfd2FyZWhvdXNlX2lkJyk6CiAgICAgICAgICAgICAgICBnb29kc19jdXN0b21fdGFibGVbJ2N1c3RvbXRhYmxlJ11bJ2xheW91dCddWydFbGVtZW50cyddLnBvcCgwKQogICAgICAgICAgICAgICAgdGJvZHlfbGF5b3V0WydFbGVtZW50cyddLnBvcCgwKQoKICAgICAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlWyJjdXN0b210YWJsZSJdWyJ0YWJsZWRhdGEiXSA9IFt7fV0KCiAgICAgICAgICAgIGkgPSAwCgogICAgICAgICAgICBmb3IgZWxlbWVudCBpbiBqc29uX3Jlc3BvbnNlOgoKICAgICAgICAgICAgICAgIGMgPSB7ImtleSI6IHN0cihpKSwgIml0ZW0iOiBnZXRfbmFtZV9ieV9pZCgiUlNfZ29vZHMiLCBlbGVtZW50WyJpZF9nb29kIl0pLAogICAgICAgICAgICAgICAgICAgICAicXVhbnRpdHkiOiBlbGVtZW50WydxdHR5J10sICdfbGF5b3V0JzogdGJvZHlfbGF5b3V0LAogICAgICAgICAgICAgICAgICAgICAnd2FyZWhvdXNlJzogZ2V0X25hbWVfYnlfaWQoIlJTX3dhcmVob3VzZXMiLCBlbGVtZW50WyJpZF93YXJlaG91c2UiXSl9CgogICAgICAgICAgICAgICAgaWYgZWxlbWVudFsiaWRfcHJvcGVydHkiXSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgIGNbJ3Byb3BlcnRpZXMnXSA9ICcnCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGNbJ3Byb3BlcnRpZXMnXSA9IGdldF9uYW1lX2J5X2ZpZWxkKCJSU19wcm9wZXJ0aWVzIiwgJ2lkJywgZWxlbWVudFsiaWRfcHJvcGVydHkiXSkKICAgICAgICAgICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdwcm9wZXJ0eV9pZCcpOgogICAgICAgICAgICAgICAgICAgIGlmIGVsZW1lbnRbImlkX3Byb3BlcnR5Il0gPT0gaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgICAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsiY3VzdG9tdGFibGUiXVsidGFibGVkYXRhIl0uYXBwZW5kKGMpCiAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBnb29kc19jdXN0b21fdGFibGVbImN1c3RvbXRhYmxlIl1bInRhYmxlZGF0YSJdLmFwcGVuZChjKQogICAgICAgICAgICAgICAgICAgIGkgKz0gMQoKICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlJywgJycpCgogICAgaWYgbGVuKGdvb2RzX2N1c3RvbV90YWJsZVsiY3VzdG9tdGFibGUiXVsidGFibGVkYXRhIl0pIDwgMjoKICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgItCi0L7QstCw0YAg0L3QtSDQvdCw0LnQtNC10L0iKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93X2Vycm9yX21zZycsICcxJykKCiAgICBoYXNoTWFwLnB1dCgiZ29vZHNfY3VzdG9tX3RhYmxlIiwganNvbi5kdW1wcyhnb29kc19jdXN0b21fdGFibGUpKQoKICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0LDQsdC70LjRhtCwINC+0YHRgtCw0YLQutC+0LIiKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGlkZW50aWZ5X2lucHV0X3RleHQoaGFzaE1hcCk6CgogICAgZ29vZF9hcnRfaW5wdXQgPSBoYXNoTWFwLmdldCgnZ29vZF9hcnRfaW5wdXQnKQogICAgY2VsbF9pbnB1dCA9IGhhc2hNYXAuZ2V0KCdjZWxsX2lucHV0JykKCiAgICBpZiBnb29kX2FydF9pbnB1dCBhbmQgbm90IGhhc2hNYXAuZ2V0KCdyZXR1cm5fdG9fZ29vZF9jYXJkJyk6CgogICAgICAgIGdvb2RfbmFtZSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgbmFtZSBGUk9NIFJTX2dvb2RzIHdoZXJlIGFydCA9ICciICsgZ29vZF9hcnRfaW5wdXQgKyAiJyIpCgogICAgICAgIGlmIGxlbihnb29kX25hbWUpID4gMDoKCiAgICAgICAgICAgIGdvb2RfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIGlkLGNvZGUgRlJPTSBSU19nb29kcyB3aGVyZSBhcnQgPSAnIiArIGdvb2RfYXJ0X2lucHV0ICsgIiciKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfZ29vZF9pZCcsIGdvb2RfcXVlcnlbMF1bMF0pCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdnb29kX2NvZGUnLCBnb29kX3F1ZXJ5WzBdWzFdKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnb2JqZWN0X25hbWUnLCBzdHIoZ29vZF9uYW1lKS5zcGxpdCgiJyIpWzFdKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdnb29kX2FydF9pbnB1dCcsIGhhc2hNYXAuZ2V0KCdnb29kX2FydF9pbnB1dCcpKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgIiDQotC+0LLQsNGAINGBINCw0YDRgtC40LrRg9C70L7QvCAiICsgIiciICsgZ29vZF9hcnRfaW5wdXQgKyAiJyIgKyAiINC90LUg0L3QsNC50LTQtdC9IikKICAgICAgICAgICAgIyBoYXNoTWFwLnB1dCgnb2JqZWN0X25hbWUnLCAiIikKCiAgICBpZiBjZWxsX2lucHV0OgoKICAgICAgICBjZWxsX2lkID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBpZCBGUk9NIFJTX2NlbGxzIHdoZXJlIG5hbWUgPSAnIiArIGNlbGxfaW5wdXQgKyAiJyIpCgogICAgICAgIGlmIGxlbihjZWxsX2lkKSA+IDA6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9jZWxsX2lkJywgc3RyKGNlbGxfaWQpLnNwbGl0KCInIilbMV0pCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdjZWxsX25hbWUnLCBjZWxsX2lucHV0KQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCdlcnJvcl9tc2cnLCAiIikKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2Vycm9yX21zZycpOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2Vycm9yX21zZycsIGhhc2hNYXAuZ2V0KCdlcnJvcl9tc2cnKSArICJcbiIgKyAiINCv0YfQtdC50LrQsCBjINC40LzQtdC90LXQvCAiICsgIiciICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxfaW5wdXQgKyAiJyIgKyAiINC90LUg0L3QsNC50LTQtdC90LAiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2Vycm9yX21zZycsICIg0K/Rh9C10LnQutCwIGMg0LjQvNC10L3QtdC8ICIgKyAiJyIgKyBjZWxsX2lucHV0ICsgIiciICsgIiDQvdC1INC90LDQudC00LXQvdCwIikKICAgICAgICAgICAgIyBoYXNoTWFwLnB1dCgnY2VsbF9uYW1lJywgIiIpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgaWRlbnRpZnlfYmFyY29kZV9yZW1haW5zKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICBoYXNoTWFwLnB1dCgnYmFyY29kZV9pbmZvJywgc3RyKGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykpKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdiYXJjb2RlJyk6CiAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykKCiAgICAgICAgZ29vZF9pZCA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgaWRfZ29vZCBGUk9NIFJTX2JhcmNvZGVzIHdoZXJlIGJhcmNvZGUgPSAnIiArIGJhcmNvZGUgKyAiJyIpCgogICAgICAgIHByb3BlcnRpZXNfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgKICAgICAgICAgICAgIlNFTEVDVCBpZF9wcm9wZXJ0eSBGUk9NIFJTX2JhcmNvZGVzIHdoZXJlIGJhcmNvZGUgPSAnIiArIGJhcmNvZGUgKyAiJyIpCgogICAgICAgIGlmIHByb3BlcnRpZXNfcXVlcnk6CiAgICAgICAgICAgIHByb3BlcnR5X2lkID0gc3RyKHByb3BlcnRpZXNfcXVlcnkpLnNwbGl0KCInIilbMV0KICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3Byb3BlcnR5X2lkJywgcHJvcGVydHlfaWQpCgogICAgICAgIGlmIGxlbihnb29kX2lkKSA+IDA6CgogICAgICAgICAgICBnb29kX25hbWUgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIG5hbWUgRlJPTSBSU19nb29kcyB3aGVyZSBpZCA9ICciICsgc3RyKGdvb2RfaWQpLnNwbGl0KCInIilbMV0gKyAiJyIpCgogICAgICAgICAgICBnb29kX2FydCA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgYXJ0IEZST00gUlNfZ29vZHMgd2hlcmUgaWQgPSAnIiArIHN0cihnb29kX2lkKS5zcGxpdCgiJyIpWzFdICsgIiciKQoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2dvb2RfaWQnLCBzdHIoZ29vZF9pZCkuc3BsaXQoIiciKVsxXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2dvb2RfYXJ0X2lucHV0Jywgc3RyKGdvb2RfYXJ0KS5zcGxpdCgiJyIpWzFdKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnb2JqZWN0X25hbWUnLCBzdHIoZ29vZF9uYW1lKS5zcGxpdCgiJyIpWzFdKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCgogICAgICAgIGVsc2U6CgogICAgICAgICAgICBjZWxsX2lkID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBpZCBGUk9NIFJTX2NlbGxzIHdoZXJlIGJhcmNvZGUgPSAnIiArIGJhcmNvZGUgKyAiJyIpCgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgYmFyY29kZSkKCiAgICAgICAgICAgIGlmIGxlbihjZWxsX2lkKSA+IDA6CgogICAgICAgICAgICAgICAgY2VsbF9uYW1lID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBuYW1lIEZST00gUlNfY2VsbHMgd2hlcmUgaWQgPSAnIiArIHN0cihjZWxsX2lkKS5zcGxpdCgiJyIpWzFdICsgIiciKQoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9jZWxsX2lkJywgc3RyKGNlbGxfaWQpLnNwbGl0KCInIilbMV0pCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9uYW1lJywgc3RyKGNlbGxfbmFtZSkuc3BsaXQoIiciKVsxXSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl9tc2cnLCAiIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdvYmplY3RfbmFtZScsICIiKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2Vycm9yX21zZycsICLQqNGC0YDQuNGF0LrQvtC0INC90LUg0YDQsNGB0L/QvtC30L3QsNC9IikKCiAgICBnZXRfcmVtYWlucyhoYXNoTWFwKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGJhY2tfdG9fcmVtYWlucyhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBoYXNoTWFwLnB1dCgnd2hfc2VsZWN0JywgJycpCiAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfd2FyZWhvdXNlX2lkJywgJycpCiAgICBoYXNoTWFwLnB1dCgiQmFja1NjcmVlbiIsICIiKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByaWNlX3R5cGVzX2xpc3Rfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGogPSB7ImN1c3RvbWNhcmRzIjogewogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKCiAgICAgICAgfSwKICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAbmFtZSIsCiAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiLTEiLAogICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIzZGOTM5MyIsCiAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0KCiAgICB9CiAgICB9CgogICAgalsiY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0gPSBbXQoKICAgIHF1ZXJ5X3RleHQgPSAiU0VMRUNUICogRlJPTSBSU19wcmljZV90eXBlcyIKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0KQoKICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICBjID0geyJrZXkiOiBzdHIocmVjb3JkWzBdKSwgIm5hbWUiOiBzdHIocmVjb3JkWzFdKX0KICAgICAgICBqWyJjdXN0b21jYXJkcyJdWyJjYXJkc2RhdGEiXS5hcHBlbmQoYykKCiAgICBpZiBub3QgaGFzaE1hcC5jb250YWluc0tleSgicHJpY2VfdHlwZV9jYXJkcyIpOgogICAgICAgIGhhc2hNYXAucHV0KCJwcmljZV90eXBlX2NhcmRzIiwganNvbi5kdW1wcyhqLCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByb3BlcnR5X2xpc3Rfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGogPSB7ImN1c3RvbWNhcmRzIjogewogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKCiAgICAgICAgfSwKICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAbmFtZSIsCiAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiLTEiLAogICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIzZGOTM5MyIsCiAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0KCiAgICB9CiAgICB9CgogICAgalsiY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0gPSBbXQoKICAgIHF1ZXJ5X3RleHQgPSAiU0VMRUNUICogRlJPTSBSU19wcm9wZXJ0aWVzIFdIRVJFIGlkX293bmVyID0gJyIgKyBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9pZCcpICsgIiciCiAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCkKCiAgICBpZiBsZW4ocmVzdWx0cykgPiAwOgogICAgICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICAgICAgYyA9IHsia2V5Ijogc3RyKHJlY29yZFswXSksICJuYW1lIjogc3RyKHJlY29yZFsyXSl9CiAgICAgICAgICAgIGpbImN1c3RvbWNhcmRzIl1bImNhcmRzZGF0YSJdLmFwcGVuZChjKQoKICAgICAgICBpZiBub3QgaGFzaE1hcC5jb250YWluc0tleSgicHJvcGVydHlfY2FyZHMiKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnR5X2NhcmRzIiwganNvbi5kdW1wcyhqLCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpKQoKICAgIGVsc2U6CiAgICAgICAgaGFzaE1hcC5wdXQoInRvYXN0IiwgItCU0LvRjyDQtNCw0L3QvdC+0LPQviDRgtC+0LLQsNGA0LAg0L3QtdGCINGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC6IikKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQn9GA0L7QstC10YDQutCwINGG0LXQvSIpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgdW5pdF9saXN0X29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICBqID0geyJjdXN0b21jYXJkcyI6IHsKICAgICAgICAib3B0aW9ucyI6IHsKICAgICAgICAgICAgInNlYXJjaF9lbmFibGVkIjogVHJ1ZSwKICAgICAgICAgICAgInNhdmVfcG9zaXRpb24iOiBUcnVlCgogICAgICAgIH0sCiAgICAgICAgImxheW91dCI6IHsKICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQG5hbWUiLAogICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIi0xIiwKICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiM2RjkzOTMiLAogICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICB9CgogICAgfQogICAgfQoKICAgIGpbImN1c3RvbWNhcmRzIl1bImNhcmRzZGF0YSJdID0gW10KCiAgICBxdWVyeV90ZXh0ID0gIlNFTEVDVCAqIEZST00gUlNfdW5pdHMgV0hFUkUgaWRfb3duZXIgPSAnIiArIGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJykgKyAiJyIKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0KQoKICAgIGlmIGxlbihyZXN1bHRzKSA+IDA6CiAgICAgICAgZm9yIHJlY29yZCBpbiByZXN1bHRzOgogICAgICAgICAgICBjID0geyJrZXkiOiBzdHIocmVjb3JkWzBdKSwgIm5hbWUiOiBzdHIocmVjb3JkWzNdKX0KICAgICAgICAgICAgalsiY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0uYXBwZW5kKGMpCgogICAgICAgIGlmIG5vdCBoYXNoTWFwLmNvbnRhaW5zS2V5KCJ1bml0X2NhcmRzIik6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJ1bml0X2NhcmRzIiwganNvbi5kdW1wcyhqLCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpKQoKICAgIGVsc2U6CiAgICAgICAgaGFzaE1hcC5wdXQoInRvYXN0IiwgItCU0LvRjyDQtNCw0L3QvdC+0LPQviDRgtC+0LLQsNGA0LAg0L3QtdGCINCy0YvQsdC+0YDQsCDRg9C/0LDQutC+0LLQutC4IikKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQn9GA0L7QstC10YDQutCwINGG0LXQvSIpCgoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdldF9wcmljZXMoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGh0dHAgPSBnZXRfaHR0cF9zZXR0aW5ncyhoYXNoTWFwKQoKICAgIHByaWNlc19jdXN0b21fdGFibGUgPSB7ImN1c3RvbXRhYmxlIjogewogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgICAgICB9LAoKICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIlN0cm9rZVdpZHRoIjogIjEiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCi0L7QstCw0YAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIlN0cm9rZVdpZHRoIjogIjEiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LgiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIlN0cm9rZVdpZHRoIjogIjEiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCm0LXQvdCwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNGMEY4RkYiLAogICAgICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCgogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICLQotC40L8g0YbQtdC90YsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIlN0cm9rZVdpZHRoIjogIjEiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCj0L/QsNC60L7QstC60LAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0KICAgIH0KICAgIH0KCiAgICB0Ym9keV9sYXlvdXQgPSB7CiAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAiUGFkZGluZyI6ICIwIiwKICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGdvb2QiLAogICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiMTQiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAiUGFkZGluZyI6ICIwIiwKICAgICAgICAgICAgICAgICJTdHJva2VXaWR0aCI6ICIxIiwKICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHByb3BlcnR5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE0IiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNGMEY4RkYiLAogICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAiU3Ryb2tlV2lkdGgiOiAiMSIsCiAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCgogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBwcmljZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgIlN0cm9rZVdpZHRoIjogIjEiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcHJpY2VfdHlwZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgIlN0cm9rZVdpZHRoIjogIjEiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAdW5pdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0KICAgICAgICBdCiAgICB9CgogICAgZ2V0X2dvb2RfYnlfYXJ0KGhhc2hNYXApCgogICAgaWYgaGFzaE1hcC5nZXQoJ2JhcmNvZGVfaW5mbycpOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93X2JhcmNvZGVfaW5mbycsICcxJykKICAgIGVsc2U6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfYmFyY29kZV9pbmZvJywgJy0xJykKCiAgICBpZiBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9pZCcpOiAgIyDQldGB0LvQuCDQvdCw0LnQtNC10L0g0YHQvtC+0YLQstC10YLRgdGC0LLRg9GO0YnQuNC5INGC0L7QstCw0YAKCiAgICAgICAgZ2V0X3ByaWNlc191cmwgPSBodHRwWyd1cmwnXSArICcvc2ltcGxlX2FjY291bnRpbmcvZ29vZF9wcmljZXM/JwoKICAgICAgICBwYXJhbXMgPSB7J2FuZHJvaWRfaWQnOiBodHRwWydhbmRyb2lkX2lkJ10sICdpZF9nb29kJzogaGFzaE1hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKX0KCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgIHBhcmFtc1snaWRfcHJvcGVydHknXSA9IGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcpCgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdwcm9wZXJ0eV9pZCcpOiAgIyDQntGCINCo0JoKICAgICAgICAgICAgcGFyYW1zWydpZF9wcm9wZXJ0eSddID0gaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJykKCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX3VuaXRfaWQnKToKICAgICAgICAgICAgcGFyYW1zWydpZF91bml0J10gPSBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfdW5pdF9pZCcpCgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJyk6CiAgICAgICAgICAgIHBhcmFtc1snaWRfcHJpY2VfdHlwZSddID0gaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX3ByaWNlX3R5cGVfaWQnKQoKICAgICAgICByID0gcmVxdWVzdHMuZ2V0KGdldF9wcmljZXNfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgYXV0aD1IVFRQQmFzaWNBdXRoKGh0dHBbJ3VzZXInXSwgaHR0cFsncGFzcyddKSwKICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9eydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04J30sCiAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM9cGFyYW1zKQoKICAgICAgICBqc29uX3ByaWNlcyA9IGpzb24ubG9hZHMoci50ZXh0LmVuY29kZSgidXRmLTgiKSkKCiAgICAgICAgdW5pdF92YWx1ZXMgPSAwCiAgICAgICAgcHJvcGVydHlfdmFsdWVzID0gMAogICAgICAgIGZvciBlbGVtZW50IGluIGpzb25fcHJpY2VzOgogICAgICAgICAgICBpZiBlbGVtZW50WyJpZF91bml0Il06CiAgICAgICAgICAgICAgICB1bml0X3ZhbHVlcyArPSAxCiAgICAgICAgICAgIGlmIGVsZW1lbnRbJ2lkX3Byb3BlcnR5J106CiAgICAgICAgICAgICAgICBwcm9wZXJ0eV92YWx1ZXMgKz0gMQoKICAgICAgICBpZiB1bml0X3ZhbHVlcyA9PSAwOgogICAgICAgICAgICBwcmljZXNfY3VzdG9tX3RhYmxlWydjdXN0b210YWJsZSddWydsYXlvdXQnXVsnRWxlbWVudHMnXS5wb3AoNCkKICAgICAgICAgICAgdGJvZHlfbGF5b3V0WydFbGVtZW50cyddLnBvcCg0KQoKICAgICAgICBpZiBwcm9wZXJ0eV92YWx1ZXMgPT0gMDoKICAgICAgICAgICAgcHJpY2VzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDEpCiAgICAgICAgICAgIHRib2R5X2xheW91dFsnRWxlbWVudHMnXS5wb3AoMSkKCiAgICAgICAgcHJpY2VzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDApCiAgICAgICAgdGJvZHlfbGF5b3V0WydFbGVtZW50cyddLnBvcCgwKQoKICAgICAgICBwcmljZXNfY3VzdG9tX3RhYmxlWyJjdXN0b210YWJsZSJdWyJ0YWJsZWRhdGEiXSA9IFt7fV0KCiAgICAgICAgaSA9IDAKCiAgICAgICAgZm9yIGVsZW1lbnQgaW4ganNvbl9wcmljZXM6CgogICAgICAgICAgICBjID0geyJrZXkiOiBzdHIoaSksICJnb29kIjogZWxlbWVudFsiaWRfZ29vZCJdLCAicHJvcGVydHkiOiBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdLAogICAgICAgICAgICAgICAgICJwcmljZSI6IGVsZW1lbnRbJ3ByaWNlJ10sICJwcmljZV90eXBlIjogZWxlbWVudFsnaWRfcHJpY2VfdHlwZSddLCAidW5pdCI6IGVsZW1lbnRbImlkX3VuaXQiXSwKICAgICAgICAgICAgICAgICAnX2xheW91dCc6IHRib2R5X2xheW91dH0KCiAgICAgICAgICAgIGlmIGVsZW1lbnRbJ2lkX2dvb2QnXToKICAgICAgICAgICAgICAgIGNbJ2dvb2QnXSA9IGdldF9uYW1lX2J5X2lkKCJSU19nb29kcyIsIGVsZW1lbnRbImlkX2dvb2QiXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNbJ2dvb2QnXSA9ICIiCgogICAgICAgICAgICBpZiBlbGVtZW50WydpZF91bml0J106CiAgICAgICAgICAgICAgICBjWyd1bml0J10gPSBnZXRfbmFtZV9ieV9pZCgiUlNfdW5pdHMiLCBlbGVtZW50WyJpZF91bml0Il0pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjWyd1bml0J10gPSAiIgoKICAgICAgICAgICAgaWYgZWxlbWVudFsnaWRfcHJpY2VfdHlwZSddOgogICAgICAgICAgICAgICAgY1sncHJpY2VfdHlwZSddID0gZ2V0X25hbWVfYnlfaWQoIlJTX3ByaWNlX3R5cGVzIiwgZWxlbWVudFsiaWRfcHJpY2VfdHlwZSJdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY1sncHJpY2VfdHlwZSddID0gIiIKCiAgICAgICAgICAgIGlmIGVsZW1lbnRbImlkX3Byb3BlcnR5Il06ICAjINCf0L7RhdC+0LbQtSDQvtCx0YDQsNGJ0LXQvdC40LUg0L3QtSDQuiDRgtC+0Lkg0YLQsNCx0LvQuNGG0LUKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBjWydwcm9wZXJ0eSddID0gZ2V0X25hbWVfYnlfaWQoIlJTX3Byb3BlcnRpZXMiLCBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdKQogICAgICAgICAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CiAgICAgICAgICAgICAgICAgICAgY1sncHJvcGVydHknXSA9IGVsZW1lbnRbImlkX3Byb3BlcnR5Il0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNbJ3Byb3BlcnR5J10gPSAiIgoKICAgICAgICAgICAgcHJpY2VzX2N1c3RvbV90YWJsZVsiY3VzdG9tdGFibGUiXVsidGFibGVkYXRhIl0uYXBwZW5kKGMpCgogICAgICAgICAgICBpICs9IDEKCiAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19jdXN0b21fdGFibGUnLCBqc29uLmR1bXBzKHByaWNlc19jdXN0b21fdGFibGUpKQoKICAgICAgICBoYXNoTWFwLnB1dCgncHJpY2VzX2Vycm9yX21zZycsICIiKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0LDQsdC70LjRhtCwINGG0LXQvSIpCgogICAgZWxzZToKICAgICAgICBpZiBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19lcnJvcl9tc2cnLCAi0J3QtSDQvdCw0LnQtNC10L0g0YHQvtC+0YLQstC10YLRgdGC0LLRg9GO0YnQuNC5INGC0L7QstCw0YAiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcmljZXNfZXJyb3JfbXNnJywgItCd0LUg0YPQutCw0LfQsNC9INGC0L7QstCw0YAiKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdldF9nb29kX2J5X2FydChoYXNoTWFwKToKCiAgICAjIGhhc2hNYXAucHV0KCdpbnB1dF92YWx1ZScsIGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJykpCgogICAgaWYgbm90IGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJyk6CgogICAgICAgIGlmIGxlbihoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKSkgPiAwOgoKICAgICAgICAgICAgZ29vZF9pZF9xdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgaWQgRlJPTSBSU19nb29kcyB3aGVyZSBhcnQgPSAnIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKSArICInIikKCiAgICAgICAgICAgIGdvb2RfbmFtZV9xdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgbmFtZSxjb2RlIEZST00gUlNfZ29vZHMgd2hlcmUgYXJ0ID0gJyIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKSArICInIikKCiAgICAgICAgICAgIGlmIGxlbihnb29kX2lkX3F1ZXJ5KSA+IDA6CiAgICAgICAgICAgICAgICBnb29kX2lkID0gc3RyKGdvb2RfaWRfcXVlcnkpLnNwbGl0KCInIilbMV0KICAgICAgICAgICAgICAgIGdvb2RfbmFtZSA9IGdvb2RfbmFtZV9xdWVyeVswXVswXQogICAgICAgICAgICAgICAgZ29vZF9jb2RlID0gZ29vZF9uYW1lX3F1ZXJ5WzBdWzFdCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgiaW5wdXRfZ29vZF9pZCIsIGdvb2RfaWQpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgicHJpY2VzX29iamVjdF9uYW1lIiwgZ29vZF9uYW1lICsgIiwgIiArIGdvb2RfY29kZSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdnb29kX2NvZGUnLCBnb29kX2NvZGUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19lcnJvcl9tc2cnLCAi0KLQvtCy0LDRgCDQvdC1INCy0YvQsdGA0LDQvSIpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnZXRfbmFtZV9ieV9pZCh0YWJsZV9uYW1lLCByZWNvcmRfaWQpOgoKICAgIHF1ZXJ5ID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoCiAgICAgICAgIlNFTEVDVCBuYW1lIEZST00gIiArIHRhYmxlX25hbWUuc3RyaXAoJyJcJycpICsgIiB3aGVyZSBpZCA9ICciICsgcmVjb3JkX2lkICsgIiciKQogICAgaWYgdHlwZShxdWVyeSkgPT0gInN0ciI6CiAgICAgICAgcmV0dXJuIHN0cihxdWVyeSkuc3BsaXQoIiciKVsxXQogICAgZWxzZToKICAgICAgICByZXR1cm4gc3RyKHF1ZXJ5WzBdKS5zcGxpdCgiJyIpWzFdCgoKZGVmIGtpbGxfcmVtYWluc190YWJsZXMoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaGFzaE1hcC5wdXQoJ3doX3NlbGVjdCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ2dvb2RfYXJ0X2lucHV0JywgJycpCiAgICBoYXNoTWFwLnB1dCgnY2VsbF9pbnB1dCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ2NlbGxfbmFtZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ29iamVjdF9uYW1lJywgJycpCiAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgJycpCiAgICBoYXNoTWFwLnB1dCgnZ29vZHNfY3VzdG9tX3RhYmxlJywgJycpCiAgICBoYXNoTWFwLnB1dCgnYmFyY29kZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCAnJykKICAgIGhhc2hNYXAucHV0KCdnb29kX2NvZGUnLCAnJykKICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9vYmplY3RfbmFtZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3doX25hbWUnLCAnJykKICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF93YXJlaG91c2VfaWQnLCAnJykKICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlX2luZm8nLCAnJykKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGtpbGxfcHJpY2VfdGFibGVzKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGhhc2hNYXAucHV0KCdpbnB1dF9nb29kX2FydCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19vYmplY3RfbmFtZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3ByaWNlX3R5cGVfaWQnLCAnJykKICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcmljZV90eXBlX25hbWUnLCAnJykKICAgIGhhc2hNYXAucHV0KCdwcmljZV90eXBlX3NlbGVjdCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJywgJycpCiAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZScsICcnKQogICAgaGFzaE1hcC5wdXQoInByb3BlcnR5X3NlbGVjdCIsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfaWQnLCAiIikKICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF91bml0X25hbWUnLCAnJykKICAgIGhhc2hNYXAucHV0KCJ1bml0X3NlbGVjdCIsICIiKQogICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19jdXN0b21fdGFibGUnLCAnJykKICAgIGhhc2hNYXAucHV0KCdpbnB1dF9nb29kX2lkJywgJycpCiAgICBoYXNoTWFwLnB1dCgnYmFyY29kZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ2dvb2RfY29kZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGVfaW5mbycsICcnKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdvb2RzX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICBpZiBoYXNoTWFwLmdldCgncmV0dXJuX3RvX2dvb2RfY2FyZCcpOgogICAgICAgIGhhc2hNYXAucHV0KCcnKQoKICAgIGZpbHRlcl9maWVsZHMgPSBbXQogICAgZmlsdGVyX3ZhbHVlID0gJycKCiAgICBpZiBoYXNoTWFwLmdldCgndHlwZV9pZCcpOgogICAgICAgIGZpbHRlcl9maWVsZHMuYXBwZW5kKCd0eXBlX2dvb2QnKQogICAgICAgIGZpbHRlcl92YWx1ZSA9IGhhc2hNYXAuZ2V0KCd0eXBlX2lkJykKCiAgICBnb29kc19jYXJkc19qc29uID0gZ2V0X3RhYmxlX2NhcmRzKCdSU19nb29kcycsIGZpbHRlcl9maWVsZHMsIGZpbHRlcl92YWx1ZSwgZXhjbHVkZV9saXN0PVsnZGVzY3JpcHRpb24nXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9fbGFiZWw9VHJ1ZSkKICAgIGdvb2RzX2NhcmRzID0gbW9kaWZ5X2NhcmRzKGpzb24ubG9hZHMoZ29vZHNfY2FyZHNfanNvbiksIGhpZGVfbmFtZT1UcnVlLCB0aXRsZV9jb2xvcj0iIzdBMDA1QyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlX2JsYW5rPVRydWUsIGRpc2FibGVfb3ZlcnJpZGVfc2VhcmNoPVRydWUpCiAgICBoYXNoTWFwLnB1dCgnZ29vZHNfY2FyZHMnLCBqc29uLmR1bXBzKGdvb2RzX2NhcmRzKSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnb29kc19vbl9pbnB1dChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgibGlzdGVuZXIiKSA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2dvb2RfaWQnLCBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKSkKICAgICAgICBoYXNoTWFwLnB1dCgnYmFyY29kZScsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdub1JlZnJlc2gnLCAnJykKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQmtCw0YDRgtC+0YfQutCwINGC0L7QstCw0YDQsCIpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnc2VsZWN0X2dvb2RzX3R5cGUnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgItCS0YvQsdC+0YAiKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ2JhcmNvZGUnOgogICAgICAgIGlkZW50aWZ5X2JhcmNvZGVfZ29vZHMoaGFzaE1hcCkKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBpZGVudGlmeV9iYXJjb2RlX2dvb2RzKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdiYXJjb2RlJyk6CiAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykKCiAgICAgICAgZ29vZF9pZCA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgaWRfZ29vZCBGUk9NIFJTX2JhcmNvZGVzIHdoZXJlIGJhcmNvZGUgPSAnIiArIGJhcmNvZGUgKyAiJyIpCgogICAgICAgIHByb3BlcnRpZXNfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgKICAgICAgICAgICAgIlNFTEVDVCBpZF9wcm9wZXJ0eSBGUk9NIFJTX2JhcmNvZGVzIHdoZXJlIGJhcmNvZGUgPSAnIiArIGJhcmNvZGUgKyAiJyIpCgogICAgICAgIGlmIHByb3BlcnRpZXNfcXVlcnk6CiAgICAgICAgICAgIHByb3BlcnR5X2lkID0gc3RyKHByb3BlcnRpZXNfcXVlcnkpLnNwbGl0KCInIilbMV0KICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3Byb3BlcnR5X2lkJywgcHJvcGVydHlfaWQpCgogICAgICAgIGlmIGxlbihnb29kX2lkKSA+IDA6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9nb29kX2lkJywgc3RyKGdvb2RfaWQpLnNwbGl0KCInIilbMV0pCgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQmtCw0YDRgtC+0YfQutCwINGC0L7QstCw0YDQsCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2Vycm9yX3R4dCcsICfQotC+0LLQsNGAINC90LUg0YDQsNGB0L/QvtC30L3QsNC9INC/0L4g0YjRgtGA0LjRhdC60L7QtNGDJykKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnb29kX2NhcmRfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9nb29kX2lkJyk6CiAgICAgICAgc2VsZWN0ZWRfZ29vZF9pZCA9IGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9nb29kX2lkJykKCiAgICAgICAgcmVzdWx0X3JzX2dvb2RzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBuYW1lLGFydCxjb2RlLHR5cGVfZ29vZCxkZXNjcmlwdGlvbiBGUk9NIFJTX2dvb2RzIHdoZXJlIGlkID0gJyIgKyBzZWxlY3RlZF9nb29kX2lkICsgIiciKQoKICAgICAgICBnb29kX25hbWUgPSByZXN1bHRfcnNfZ29vZHNbMF1bMF0KICAgICAgICBnb29kX2FydCA9IHJlc3VsdF9yc19nb29kc1swXVsxXQogICAgICAgIGdvb2RfY29kZSA9IHJlc3VsdF9yc19nb29kc1swXVsyXQogICAgICAgIGdvb2RfdHlwZV9pZCA9IHJlc3VsdF9yc19nb29kc1swXVszXQogICAgICAgIGdvb2RfZGVzY3IgPSByZXN1bHRfcnNfZ29vZHNbMF1bNF0KCiAgICAgICAgZ29vZF90eXBlID0gZ2V0X25hbWVfYnlfaWQoJ1JTX3R5cGVzX2dvb2RzJywgZ29vZF90eXBlX2lkKQoKICAgICAgICBmaWxsX2VtcHR5X3ZhbHVlcyhoYXNoTWFwLCB7Imdvb2RfbmFtZSI6IGdvb2RfbmFtZSwgImdvb2RfYXJ0IjogZ29vZF9hcnQsICJnb29kX2NvZGUiOiBnb29kX2NvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJnb29kX2Rlc2NyIjogZ29vZF9kZXNjciwgImdvb2RfdHlwZSI6IGdvb2RfdHlwZX0sIHZhbHVlPSLQvtGC0YHRg9GC0YHRgtCy0YPQtdGCIikKCiAgICAgICAgZ2V0X2dvb2RfdmFyaWFudHMoaGFzaE1hcCkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnb29kX2NhcmRfb25fbG9hZChoYXNoTWFwLCAgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IEltcG9ydFV0aWxzIGFzIGl1Q2xhc3MKICAgIGZyb20gYW5kcm9pZC5ncmFwaGljcy5kcmF3YWJsZSBpbXBvcnQgR3JhZGllbnREcmF3YWJsZSBhcyBHcmFkaWVudERyYXdhYmxlCiAgICBmcm9tIGFuZHJvaWQuZ3JhcGhpY3MgaW1wb3J0IENvbG9yCgogICAgcHJpY2VzX2J0biA9IGl1Q2xhc3MuZ2V0VmlldygidG9fcHJpY2VzIikKICAgIHJlbWFpbnNfYnRuID0gaXVDbGFzcy5nZXRWaWV3KCJ0b19yZW1haW5zIikKCiAgICBzaGFwZSA9IEdyYWRpZW50RHJhd2FibGUoKSAgIyDQodC+0LfQtNCw0LXQvCDRhNC+0YDQvNGDCiAgICBzaGFwZS5zZXRTaGFwZShHcmFkaWVudERyYXdhYmxlLlJFQ1RBTkdMRSkKICAgIHNoYXBlLnNldENvcm5lclJhZGl1cyg1MCkKICAgIHNoYXBlLnNldENvbG9yKENvbG9yLldISVRFKQogICAgIyBzaGFwZS5zZXRDb2xvcnMoe0NvbG9yLnJnYigyNTEsIDE3NSwgNDYpLCBDb2xvci5yZ2IoMjMxLCAzMSwgODMpLCBDb2xvci5yZ2IoMzEsIDE4NSwgMjI1KX0pCiAgICAjIHNoYXBlLnNldEdyYWRpZW50VHlwZShHcmFkaWVudERyYXdhYmxlLkxJTkVBUl9HUkFESUVOVCkKICAgICMgc2hhcGUuc2V0T3JpZW50YXRpb24oR3JhZGllbnREcmF3YWJsZS5PcmllbnRhdGlvbi5CUl9UTCkKICAgICMgc2hhcGUuc2V0UGFkZGluZyg0MCwgMCwgMCwgMCkKCiAgICBwcmljZXNfYnRuLnNldEJhY2tncm91bmQoc2hhcGUpCiAgICBwcmljZXNfYnRuLnNldEVsZXZhdGlvbigxNSkgICMg0KLQtdC90YwKICAgIHJlbWFpbnNfYnRuLnNldEJhY2tncm91bmQoc2hhcGUpCiAgICByZW1haW5zX2J0bi5zZXRFbGV2YXRpb24oMTUpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZ29vZF9jYXJkX29uX2lucHV0KGhhc2hNYXAsICBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2JhcmNvZGUnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGUnLCAnJykKICAgICAgICBpZiBoYXNoTWFwLmdldCgnYmFyY29kZV9jYXJkcycpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnYmFyY29kZV9jYXJkcycsICcnKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdyZXR1cm5fdG9fZ29vZF9jYXJkJyk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdyZXR1cm5fdG9fZ29vZF9jYXJkJywgJycpCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2dvb2RfaWQnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2dvb2RfaWQnLCAnJykKICAgICAgICBpZiBoYXNoTWFwLmdldCgncHJvcGVydHlfaWQnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3Byb3BlcnR5X2lkJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0KLQvtCy0LDRgNGLINGB0L/QuNGB0L7QuiIpCiAgICBpZiBoYXNoTWFwLmdldCgibGlzdGVuZXIiKSA9PSAiVGlsZXNDbGljayI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0Jywgc3RyKGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF90aWxlX2tleScpKSkKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICd0b19wcmljZXMnOgogICAgICAgIGhhc2hNYXAucHV0KCdpbnB1dF9nb29kX2lkJywgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2dvb2RfaWQnKSkgICMgc2VsZWN0ZWRfZ29vZF9pZCBpbnB1dF9nb29kX2lkCiAgICAgICAgaGFzaE1hcC5wdXQoJ2lucHV0X2dvb2RfYXJ0JywgaGFzaE1hcC5nZXQoJ2dvb2RfYXJ0JykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19vYmplY3RfbmFtZScsIGhhc2hNYXAuZ2V0KCdnb29kX25hbWUnKSArICIsICIgKyBoYXNoTWFwLmdldCgnZ29vZF9jb2RlJykpCiAgICAgICAgaGFzaE1hcC5wdXQoInJldHVybl90b19nb29kX2NhcmQiLCAidHJ1ZSIpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3Byb3BlcnR5X2lkJywgaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cm0LXQvdGLfNCf0YDQvtCy0LXRgNC60LAg0YbQtdC9JykKICAgICAgICBoYXNoTWFwLnB1dCgibm9SZWZyZXNoIiwgJycpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAndG9fcmVtYWlucyc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2dvb2RfYXJ0X2lucHV0JywgaGFzaE1hcC5nZXQoJ2dvb2RfYXJ0JykpCiAgICAgICAgaGFzaE1hcC5wdXQoInJldHVybl90b19nb29kX2NhcmQiLCAidHJ1ZSIpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX29iamVjdF9uYW1lJywgaGFzaE1hcC5nZXQoJ2dvb2RfbmFtZScpICsgIiwgIiArIGhhc2hNYXAuZ2V0KCdnb29kX2NvZGUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgnb2JqZWN0X25hbWUnLCBoYXNoTWFwLmdldCgnZ29vZF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3Byb3BlcnR5X2lkJywgaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJykpCiAgICAgICAgaGFzaE1hcC5wdXQoIm5vUmVmcmVzaCIsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQntGB0YLQsNGC0LrQuHzQn9GA0L7QstC10YDQuNGC0Ywg0L7RgdGC0LDRgtC60LgnKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgcHJpY2VfdGFibGVzX29uX3N0YXJ0KGhhc2hNYXAsICBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgncGFyZW50X3NjcmVlbicpID09ICLQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6IjoKICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9zY3JlZW5fbmFtZScsICLQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6IikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnZXRfZ29vZF92YXJpYW50cyhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBzZWxlY3RlZF9nb29kX2lkID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2dvb2RfaWQiKQogICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykKCiAgICBpZiBiYXJjb2RlOgogICAgICAgIGdvb2RzX2JhcmNvZGUgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgKICAgICAgICAgICAgIlNFTEVDVCBiYXJjb2RlLGlkX3Byb3BlcnR5LGlkX3NlcmllcyxpZF91bml0IEZST00gUlNfYmFyY29kZXMgV0hFUkUgYmFyY29kZSA9ICciICsgYmFyY29kZSArCiAgICAgICAgICAgICInIikKCiAgICBlbGlmIHNlbGVjdGVkX2dvb2RfaWQ6CiAgICAgICAgZ29vZHNfYmFyY29kZSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KAogICAgICAgICAgICAiU0VMRUNUIGJhcmNvZGUsaWRfcHJvcGVydHksaWRfc2VyaWVzLGlkX3VuaXQgRlJPTSBSU19iYXJjb2RlcyBXSEVSRSBpZF9nb29kID0gJyIgKyBzZWxlY3RlZF9nb29kX2lkICsKICAgICAgICAgICAgIiciKQoKICAgIGJhcmNvZGVfY2FyZHMgPSB7ImN1c3RvbWNhcmRzIjogewogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgICAgICB9LAoKICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAiUGFkZGluZyI6ICIwIiwKICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHByb3BlcnRpZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICAgICAiUGFkZGluZyI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCgogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAdW5pdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAYmFyY29kZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNGMEY4RkYiLAogICAgICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBzZXJpZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0KICAgIH0KICAgIH0KCiAgICBiYXJjb2RlX2NhcmRzWyJjdXN0b21jYXJkcyJdWyJjYXJkc2RhdGEiXSA9IFtdCgogICAgaSA9IDAKICAgIGZvciBlbGVtZW50IGluIGdvb2RzX2JhcmNvZGU6CiAgICAgICAgYyA9IHsia2V5Ijogc3RyKGkpLCAiYmFyY29kZSI6IGVsZW1lbnRbMF0sICJwcm9wZXJ0aWVzIjogZWxlbWVudFsxXSwgInVuaXQiOiBlbGVtZW50WzNdLCAic2VyaWVzIjogZWxlbWVudFsyXX0KCiAgICAgICAgaWYgZWxlbWVudFsxXToKICAgICAgICAgICAgY1sncHJvcGVydGllcyddID0gZ2V0X25hbWVfYnlfZmllbGQoIlJTX3Byb3BlcnRpZXMiLCAiaWQiLCBlbGVtZW50WzFdKQogICAgICAgIGlmIGVsZW1lbnRbM106CiAgICAgICAgICAgIGNbJ3VuaXQnXSA9IGdldF9uYW1lX2J5X2ZpZWxkKCJSU191bml0cyIsICJpZCIsIGVsZW1lbnRbM10pCgogICAgICAgIGJhcmNvZGVfY2FyZHNbImN1c3RvbWNhcmRzIl1bImNhcmRzZGF0YSJdLmFwcGVuZChjKQogICAgICAgIGkgKz0gMQoKICAgIGhhc2hNYXAucHV0KCJiYXJjb2RlX2NhcmRzIiwganNvbi5kdW1wcyhiYXJjb2RlX2NhcmRzKSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBmaWxsX2VtcHR5X3ZhbHVlcyhoYXNoTWFwLCBuYW1lc19saXN0PWRpY3QoKSwgdmFsdWU9IiIpOgoKICAgIGZvciBrLCB2IGluIG5hbWVzX2xpc3QuaXRlbXMoKToKCiAgICAgICAgaWYgdiBpcyBOb25lOgogICAgICAgICAgICB2ID0gJycKICAgICAgICBpZiBsZW4odikgPT0gMDoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoaywgdmFsdWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoaywgdikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiByZW1haW5zX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBtb2RpZnlfY2FyZHMoaiwgaGlkZV9uYW1lPUZhbHNlLCB0aXRsZV9jb2xvcj0nJywgcmVwbGFjZV9ibGFuaz1GYWxzZSwgZGlzYWJsZV9vdmVycmlkZV9zZWFyY2g9RmFsc2UpOgogICAgY2FyZHNfbGF5b3V0X2VsZW1lbnRzID0galsnY3VzdG9tY2FyZHMnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ10KCiAgICBpZiBkaXNhYmxlX292ZXJyaWRlX3NlYXJjaDoKICAgICAgICBqWydjdXN0b21jYXJkcyddWydvcHRpb25zJ11bJ292ZXJyaWRlX3NlYXJjaCddID0gRmFsc2UKCiAgICBmb3IgZWxlbWVudCBpbiBjYXJkc19sYXlvdXRfZWxlbWVudHM6CiAgICAgICAgaWYgZWxlbWVudFsnVmFsdWUnXSA9PSAnQG5hbWUnOgogICAgICAgICAgICBpZiBjYXJkc19sYXlvdXRfZWxlbWVudHMuaW5kZXgoZWxlbWVudCkgPT0gMDoKICAgICAgICAgICAgICAgIGVsZW1lbnRbJ2dyYXZpdHlfaG9yaXpvbnRhbCddID0gImxlZnQiCiAgICAgICAgICAgICAgICBpZiB0aXRsZV9jb2xvcjoKICAgICAgICAgICAgICAgICAgICBlbGVtZW50WyJUZXh0Q29sb3IiXSA9IHRpdGxlX2NvbG9yCiAgICAgICAgICAgICAgICAjIGVsZW1lbnRbJ1ZhbHVlJ10gPSBzdHIoMCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIGhpZGVfbmFtZToKCiAgICAgICAgICAgICAgICAgICAgIyBlbGVtZW50WyJzaG93X2J5X2NvbmRpdGlvbiJdID0gIlRydWUiCiAgICAgICAgICAgICAgICAgICAgZGVsIGNhcmRzX2xheW91dF9lbGVtZW50c1tjYXJkc19sYXlvdXRfZWxlbWVudHMuaW5kZXgoZWxlbWVudCldCgogICAgaWYgcmVwbGFjZV9ibGFuazoKICAgICAgICBjYXJkc19kYXRhID0galsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KCiAgICAgICAgZm9yIGVsZW1lbnQgaW4gY2FyZHNfZGF0YToKICAgICAgICAgICAgZm9yIGtleSwgdmFsIGluIGVsZW1lbnQuaXRlbXMoKToKICAgICAgICAgICAgICAgIGlmIHZhbCA9PSAnTm9uZScgb3IgdmFsID09ICIiOgogICAgICAgICAgICAgICAgICAgIGVsZW1lbnRba2V5XSA9ICLigJQiCgogICAgcmV0dXJuIGoKCgpkZWYgZ2V0X25hbWVfYnlfZmllbGQodGFibGVfbmFtZSwgZmllbGQsIGZpZWxkX3ZhbHVlKToKCiAgICBxdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KAogICAgICAgICJTRUxFQ1QgbmFtZSBGUk9NICIgKyB0YWJsZV9uYW1lLnN0cmlwKCciXCcnKSArICIgV0hFUkUgIiArIGZpZWxkICsgJz0nICsgIiciICsgZmllbGRfdmFsdWUgKyAiJyIpCiAgICB0cnk6CiAgICAgICAgaWYgdHlwZShxdWVyeSkgPT0gInN0ciI6CiAgICAgICAgICAgIHJldHVybiBzdHIocXVlcnkpLnNwbGl0KCInIilbMV0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc3RyKHF1ZXJ5WzBdKS5zcGxpdCgiJyIpWzFdCiAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICByZXR1cm4gZmllbGRfdmFsdWUKCgpkZWYgZ29vZF90eXBlc19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgY2FyZHNfanNvbiA9IGdldF90YWJsZV9jYXJkcygnUlNfdHlwZXNfZ29vZHMnLCBleGNsdWRlX2xpc3Q9Wyd1c2VfbWFyayddLCBub19sYWJlbD1UcnVlKQoKICAgIGNhcmRzID0gbW9kaWZ5X2NhcmRzKGpzb24ubG9hZHMoY2FyZHNfanNvbiksIGhpZGVfbmFtZT1UcnVlLCBkaXNhYmxlX292ZXJyaWRlX3NlYXJjaD1UcnVlKQoKICAgIGhhc2hNYXAucHV0KCdjYXJkcycsIGpzb24uZHVtcHMoY2FyZHMpKQoKICAgICMgaGFzaE1hcC5wdXQoJ2NhcmRzJywgY2FyZHNfanNvbikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnb29kX3R5cGVzX29uX2NsaWNrKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoImxpc3RlbmVyIikKCiAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CgogICAgICAgIHNlbGVjdGVkX3R5cGVfaWQgPSBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9rZXknKQoKICAgICAgICBoYXNoTWFwLnB1dCgndHlwZV9pZCcsIHN0cihzZWxlY3RlZF90eXBlX2lkKSkKCiAgICAgICAgc2VsZWN0ZWRfdHlwZV9uYW1lID0gZ2V0X25hbWVfYnlfZmllbGQoIlJTX3R5cGVzX2dvb2RzIiwgImlkIiwgc2VsZWN0ZWRfdHlwZV9pZCkKCiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdF9nb29kc190eXBlJywgc2VsZWN0ZWRfdHlwZV9uYW1lKQoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6IikKCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCd0eXBlX2lkJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3R5cGVfbmFtZScsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0L7QstCw0YDRiyDRgdC/0LjRgdC+0LoiKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHJlbWFpbnNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ3doX3NlbGVjdCc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JLRi9Cx0L7RgCDRgdC60LvQsNC00LAiKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ2dldF9yZW1haW5zX2J0bic6CiAgICAgICAgZ2V0X3JlbWFpbnMoaGFzaE1hcCkKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYXJjb2RlJzoKICAgICAgICBpZGVudGlmeV9iYXJjb2RlX3JlbWFpbnMoaGFzaE1hcCkKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGtpbGxfcmVtYWluc190YWJsZXMoaGFzaE1hcCkKICAgICAgICBpZiBoYXNoTWFwLmdldCgncmV0dXJuX3RvX2dvb2RfY2FyZCcpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnbm9SZWZyZXNoJywgJycpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJGaW5pc2hQcm9jZXNzUmVzdWx0IiwgIiIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoIkZpbmlzaFByb2Nlc3MiLCAiIikKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHdhcmVob3VzZV9vbl9pbnB1dChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgc2VsZWN0ZWRfd2hfaWQgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKQogICAgICAgIHNlbGVjdGVkX3doX25hbWUgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgKICAgICAgICAgICAgIlNFTEVDVCBuYW1lIEZST00gUlNfd2FyZWhvdXNlcyB3aGVyZSBpZCA9ICciICsgc2VsZWN0ZWRfd2hfaWQgKyAiJyIpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3dhcmVob3VzZV9pZCcsIHN0cihzZWxlY3RlZF93aF9pZCkpCiAgICAgICAgaGFzaE1hcC5wdXQoIndoX3NlbGVjdCIsIHN0cihzZWxlY3RlZF93aF9uYW1lWzBdKS5zcGxpdCgiJyIpWzFdKQogICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl9tc2cnLCAnJykKICAgICAgICBoYXNoTWFwLnB1dCgiQmFja1NjcmVlbiIsICIiKQogICAgICAgIHJldHVybiBoYXNoTWFwCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnYmFja190b19yZW1haW5zJyBvciAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBiYWNrX3RvX3JlbWFpbnMoaGFzaE1hcCkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHJlbWFpbnNfdGFibGVzX29uX2lucHV0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdzaG93X2ZpbHRlcnMnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCf0YDQvtCy0LXRgNC40YLRjCDQvtGB0YLQsNGC0LrQuCIpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgnYmFyY29kZScsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0eV9pZCcsICcnKQoKICAgICAgICBpZiBoYXNoTWFwLmdldCgicmV0dXJuX3RvX2dvb2RfY2FyZCIpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgiQmFja1NjcmVlbiIsICcnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9nb29kX2lkJywgJycpCgogICAgICAgICAgICBpZiBoYXNoTWFwLmdldCgiY3VycmVudF9zY3JlZW5fbmFtZSIpID09ICLQotCw0LHQu9C40YbQsCDQvtGB0YLQsNGC0LrQvtCyIjoKICAgICAgICAgICAgICAgIGtpbGxfcmVtYWluc190YWJsZXMoaGFzaE1hcCkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cf0YDQvtCy0LXRgNC40YLRjCDQvtGB0YLQsNGC0LrQuCcpCiAgICAgICAgICAgIGVsaWYgaGFzaE1hcC5nZXQoImN1cnJlbnRfc2NyZWVuX25hbWUiKSA9PSAi0KLQsNCx0LvQuNGG0LAg0YbQtdC9IjoKICAgICAgICAgICAgICAgIGtpbGxfcHJpY2VfdGFibGVzKGhhc2hNYXApCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQn9GA0L7QstC10YDQutCwINGG0LXQvScpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnYmFyY29kZSc6CiAgICAgICAgaWRlbnRpZnlfYmFyY29kZV9yZW1haW5zKGhhc2hNYXApCiAgICByZXR1cm4gaGFzaE1hcAoKCgoKCgoKCgoK",
        "RunPython": true,
        "PyTimerTask": [],
        "DefServiceConfiguration": "event_service",
        "LaunchProcess": "",
        "ForegroundService": true,
        "StopForegroundServiceOnExit": true,
        "CommonHandlers": [
            {
                "alias": "on_start",
                "event": "onLaunch",
                "action": "run",
                "type": "python",
                "method": "app_on_start",
                "postExecute": ""
            },
            {
                "alias": "event_service",
                "event": "onWebServiceSyncCommand",
                "action": "runasync",
                "type": "python",
                "method": "event_service",
                "postExecute": ""
            }
        ],
        "MainMenu": [
            {
                "MenuItem": "faq",
                "MenuTitle": "FAQ",
                "MenuId": "01",
                "MenuTop": false
            }
        ],
        "arch2": true,
        "PyFiles": [
            {
                "PyFileKey": "ui_csv",
                "PyFileData": "aW1wb3J0IGNzdgppbXBvcnQgb3MKaW1wb3J0IHJlCgppbXBvcnQgdWlfYmFyY29kZXMKaW1wb3J0IHVpX2dsb2JhbApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQoKCmRlZiBnZXRfcXVlcnlfdGV4dChxX25hbWU9JycpIC0+IHN0cjoKICAgIGlmIHFfbmFtZSA9PSAnUlNfZ29vZHMnOgogICAgICAgIHJldHVybiAnUkVQTEFDRSBJTlRPIFJTX2dvb2RzICggIGlkLCBjb2RlLCBhcnQsIG5hbWUsIHVuaXQsIHR5cGVfZ29vZCwgZGVzY3JpcHRpb24pIFZBTFVFUyAoPyw/LD8sPyw/LD8sPyknCiAgICBlbGlmIHFfbmFtZSA9PSAnUlNfcHJvcGVydGllcyc6CiAgICAgICAgcmV0dXJuICdSRVBMQUNFIElOVE8gUlNfcHJvcGVydGllcyAoICBpZCAsIGlkX293bmVyLCBuYW1lKSBWQUxVRVMgJwogICAgZWxpZiBxX25hbWUgPT0gJ1JTX3VuaXRzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU191bml0cyAoICBpZCxpZF9vd25lciwgY29kZSwgbmFtZSwgbm9taW5hdG9yLCBkZW5vbWluYXRvciwgaW50X3JlZHVjdGlvbikgVkFMVUVTICg/LD8sPyw/LD8sPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU190eXBlc19nb29kcyc6CiAgICAgICAgcmV0dXJuICdSRVBMQUNFIElOVE8gUlNfdHlwZXNfZ29vZHMgKCAgaWQsIG5hbWUpIFZBTFVFUyAoPyw/KScgICMgKD8sPykKICAgIGVsaWYgcV9uYW1lID09ICdSU19zZXJpZXMnOgogICAgICAgIHJldHVybiAnUkVQTEFDRSBJTlRPIFJTX3NlcmllcyAoICBpZCwgbmFtZSwgYmVzdF9iZWZvcmUsIHR5cGVfZ29vZHMsIG51bWJlciwgcHJvZHVjdGlvbl9kYXRlKSBWQUxVRVMnCiAgICBlbGlmIHFfbmFtZSA9PSAnUlNfY291bnRyYWdlbnRzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19jb3VudHJhZ2VudHMgKCAgaWQsIG5hbWUsIGZ1bGxfbmFtZSwgaW5uLCBrcHApIFZBTFVFUyAnCiAgICBlbGlmIHFfbmFtZSA9PSAnUlNfd2FyZWhvdXNlcyc6CiAgICAgICAgcmV0dXJuICdSRVBMQUNFIElOVE8gUlNfd2FyZWhvdXNlcyAoICBpZCwgbmFtZSkgVkFMVUVTICg/LD8pJwogICAgZWxpZiBxX25hbWUgPT0gJ1JTX3ByaWNlX3R5cGVzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19wcmljZV90eXBlcyAoaWQsIG5hbWUpIFZBTFVFUyAoPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU19iYXJjb2Rlcyc6CiAgICAgICAgcmV0dXJuICdSRVBMQUNFIElOVE8gUlNfYmFyY29kZXMgKGlkLCBiYXJjb2RlLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfc2VyaWVzLCBpZF91bml0KSBWQUxVRVMgKD8sPyw/LD8sPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU19tYXJraW5nX2NvZGVzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19tYXJraW5nX2NvZGVzIChpZCwgbWFya19jb2RlLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfc2VyaWVzLCBpZF91bml0KSBWQUxVRVMgKD8sPyw/LD8sPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU19wcmljZXMnOgogICAgICAgIHJldHVybiAnUkVQTEFDRSBJTlRPIFJTX3ByaWNlcyAoaWRfcHJpY2VfdHlwZXMsIGlkX2dvb2RzLCBpZF9wcm9wZXJ0aWVzLCBwcmljZSwgaWRfdW5pdCkgVkFMVUVTICcKICAgIGVsaWYgcV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19kb2NzIChpZF9kb2MsIGRvY190eXBlLCBkb2NfbiwgZG9jX2RhdGUsIGlkX2NvdW50cmFnZW50cywgaWRfd2FyZWhvdXNlKSBWQUxVRVMgKD8sPyw/LD8sPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU19kb2NzX3RhYmxlJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19kb2NzX3RhYmxlIChpZF9kb2MsIGlkX2dvb2QsIGlkX3Byb3BlcnRpZXMsIGlkX3NlcmllcywgaWRfdW5pdCwgcXR0eSwgcXR0eV9wbGFuLCBwcmljZSwgaWRfcHJpY2UpIFZBTFVFUyAoPyw/LD8sPyw/LD8sPyw/LD8pJwogICAgZWxpZiBxX25hbWUgPT0gJ1JTX2RvY3NfYmFyY29kZXMnOgogICAgICAgIHJldHVybiAnUkVQTEFDRSBJTlRPIFJTX2RvY3NfYmFyY29kZXMgKGlkX2RvYywgaWRfYmFyY29kZSwgaXNfcGxhbikgVkFMVUVTICg/LD8sPyknCgoKZGVmIGdldF9xdWVyeV90ZXh0X2V4cG9ydCgpOgogICAgcmV0dXJuICcnJwogICAgICAgICBTRUxFQ1QgCiAgICAgICAgJzAnIEFTIEdUSU4sCiAgICAgICAgUlNfbWFya2luZy5pZF9nb29kLAogICAgICAgIFJTX21hcmtpbmcubmFtZSwgCiAgICAgICAgMSBhcyBEZWNsYXJlZFF1YW50aXR5LAogICAgICAgIENBU0UgYXBwcm92ZWQKICAgICAgICAgICAgV0hFTiAnMScgVEhFTiAxCiAgICAgICAgICAgIEVMU0UgMAogICAgICAgIEVORCBBUyBDdXJyZW50UXVhbnRpdHksCiAgICAgICAgYmFyY29kZV9mcm9tX3NjYW5uZXIgYXMg0JzQsNGA0LrQsCwKICAgICAgICBSU19tYXJraW5nLm1hcmtfY29kZSBBUyDQnNCw0YDQutCw0JjQodCc0J8sCiAgICAgICAgUlNfbWFya2luZy5pZF9wcm9wZXJ0eSBhcyDQmNC90LLQvtC50YEsCiAgICAgICAgJ9Cn0YPQttC+0LknIGFzINCf0YDQuNC90LDQtNC70LXQttC90L7RgdGC0YwgCgogICAgICAgIEZST00gUlNfZG9jc19iYXJjb2RlcyAKCiAgICAgICAgTEVGVCBKT0lOIChTRUxFQ1QgCiAgICAgICAgICAgICAgICAgICAgaWQgQVMgaWRfYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICBtYXJrX2NvZGUgQVMgbWFya19jb2RlLAogICAgICAgICAgICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgaWRfcHJvcGVydHksCiAgICAgICAgICAgICAgICAgICAgaWRfc2VyaWVzLAogICAgICAgICAgICAgICAgICAgIGlkX3VuaXQsCiAgICAgICAgICAgICAgICAgICAgUlNfZ29vZHMubmFtZSwKICAgICAgICAgICAgICAgICAgICBSU19nb29kcy5jb2RlCgogICAgICAgICAgICAgICAgICAgIEZST00gUlNfbWFya2luZ19jb2RlcwogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcyAKICAgICAgICAgICAgICAgICAgICBPTiBSU19nb29kcy4gIGlkICA9IFJTX21hcmtpbmdfY29kZXMuaWRfZ29vZAogICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX21hcmtpbmdfY29kZXMuaWQgSU4gCiAgICAgICAgICAgICAgICAgICAgICAgIChTRUxFQ1QgaWRfYmFyY29kZSBGUk9NIFJTX2RvY3NfYmFyY29kZXMgCiAgICAgICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jID0gOmlkX2RvYykpIEFTIFJTX21hcmtpbmcKICAgICAgICBPTiBSU19kb2NzX2JhcmNvZGVzLmlkX2JhcmNvZGUgPSBSU19tYXJraW5nLmlkX2JhcmNvZGUgIAoKICAgICAgICBXSEVSRSBSU19kb2NzX2JhcmNvZGVzLmlkX2RvYyA9IDppZF9kb2MKJycnCgoKZGVmIG5vcm1hbGl6ZV9ndGluKGd0aW46IHN0cikgLT4gc3RyOgogICAgYSA9IGxlbihndGluKQogICAgaWYgYSA+IDE0OgogICAgICAgIHJldHVybiBndGluWzotMTRdCiAgICBlbHNlOgogICAgICAgIHJldHVybiAnMCcgKiAoMTQgLSBhKSArIGd0aW4KCgpkZWYgbG9hZF9mcm9tX2NzdihwYXRoPScnLCBmaWxlPScnKToKICAgICMgcmUuZnVsbG1hdGNoKHInXGR7MTN9JywgYmFyY29kZSkuc3RyaW5nID09IGJhcmNvZGU6CiAgICBjdXJyZW50X2RhdGUgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgiJWQtJW0tJVkiKQogICAgIyBmaWxlID0gZmlsZSArICgiICIgKiAxNSkgI9GH0YLQvtCx0Ysg0L3QtSDQvdCw0YLRi9C60LDRgtGM0YHRjyDQvdCwIG91dCBvZiByYW5nZSDQsiDRgtC10LrRgdGC0L7QstC+0Lwg0LjQvNC10L3QuCAtINC00L7QsdCw0LLQuNC8IDE1INC/0YDQvtCx0LXQu9C+0LIKICAgIGlmIGZpbGVbOjZdID09ICdkb2NfaW4nOgogICAgICAgICMg0JfQsNCz0YDRg9C20LDQtdC8INC00L7QutGD0LzQtdC90YLRiwogICAgICAgIHdpdGggb3BlbihwYXRoLCAncicsIG5ld2xpbmU9JycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGNzdmZpbGU6CgogICAgICAgICAgICBteV9yZWFkZXIgPSBjc3YucmVhZGVyKGNzdmZpbGUsIGRpYWxlY3Q9J2V4Y2VsJywgZGVsaW1pdGVyPSc7JywgcXVvdGVjaGFyPSciJykKCiAgICAgICAgICAgIHJzX2RvY19kYXRhID0gW10KICAgICAgICAgICAgcnNfZG9jX3RhYmxlX2RhdGEgPSBbXQogICAgICAgICAgICByc19kb2NfYmFyY29kZSA9IFtdCiAgICAgICAgICAgIHJzX21hcmtpbmdfY29kZXMgPSBbXQogICAgICAgICAgICByc19wcm9wZXJ0aWVzID0gW10KICAgICAgICAgICAgdGVtcF9kb2NfbiA9ICcnCiAgICAgICAgICAgIHRlbXBfZ29vZCA9ICcnCiAgICAgICAgICAgIGRvY19udW0gPSB1aV9nbG9iYWwuUnNfZG9jLmdldF9uZXdfaWQoJycpCiAgICAgICAgICAgIGZvciByb3cgaW4gbXlfcmVhZGVyOgogICAgICAgICAgICAgICAgaWYgbXlfcmVhZGVyLmxpbmVfbnVtID4gNTogICMg0JfQsNCz0L7Qu9C+0LLQutC4INGC0LDQsdC70LjRhtGLCiAgICAgICAgICAgICAgICAgICAgIyBpZiB0ZW1wX2RvY19uICE9IHJvd1s4XToKICAgICAgICAgICAgICAgICAgICAjICAgICAjIFJTX2RvY3MgKGlkX2RvYywgZG9jX3R5cGUsIGRvY19uLCBkb2NfZGF0ZSwgaWRfY291bnRyYWdlbnRzLCBpZF93YXJlaG91c2UpCiAgICAgICAgICAgICAgICAgICAgIyAgICAgcnNfZG9jX2RhdGUuYXBwZW5kKChkb2NfbnVtLCAn0JjQvdCy0L7QudGBJywgZG9jX251bSwgY3VycmVudF9kYXRlLCAnMDAxJywgJzAwMScpKQogICAgICAgICAgICAgICAgICAgICMgICAgIHRlbXBfZG9jX24gPSByb3dbOF0KICAgICAgICAgICAgICAgICAgICAjIFJTX2RvY3NfdGFibGUoaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksIHF0dHlfcGxhbiwgcHJpY2UsIGlkX3ByaWNlKQogICAgICAgICAgICAgICAgICAgIGlmIHRlbXBfZ29vZCAhPSByb3dbMF06CiAgICAgICAgICAgICAgICAgICAgICAgIHJzX2RvY190YWJsZV9kYXRhLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChkb2NfbnVtLCByb3dbMF0sIHJvd1s4XSwgJycsIHJvd1sxXSArIHJvd1swXSwgaW50KHJvd1s3XSksIGludChyb3dbNl0pLCAnJywgJycpKQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyX2NvdW50ID0gcnNfZG9jX3RhYmxlX2RhdGEuX19sZW5fXygpIC0gMQogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wX2dvb2QgPSByb3dbMF0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAjINC00L7QsdCw0LLQuNC8INC60L7Qu9C40YfQtdGB0YLQstC+INCyINGB0YLRgNC+0LrRgywg0LTQu9GPINGN0YLQvtCz0L4g0L/RgNC10L7QsdGA0LDQt9GD0LXQvCDQtdC1INCyINCb0LjRgdGCLCDQv9C+0LzQtdC90Y/QtdC8INC60L7Qu9C40YfQtdGB0YLQstC+INC4INC30LDRgdGD0L3QtdC8INC+0LHRgNCw0YLQvdC+INCyINC60L7RgNGC0LXQtgogICAgICAgICAgICAgICAgICAgICAgICBsc3QgPSBsaXN0KHJzX2RvY190YWJsZV9kYXRhW2N1cnJfY291bnRdKQogICAgICAgICAgICAgICAgICAgICAgICBsc3RbNl0gPSBpbnQobHN0WzZdKSArIGludChyb3dbNl0pCiAgICAgICAgICAgICAgICAgICAgICAgIHJzX2RvY190YWJsZV9kYXRhW2N1cnJfY291bnRdID0gdHVwbGUobHN0KQogICAgICAgICAgICAgICAgICAgICAgICAjIHJzX2RvY190YWJsZV9kYXRhW2N1cnJfY291bnRdWzZdPWludChyc19kb2NfdGFibGVfZGF0YVtjdXJyX2NvdW50XVs2XSkgKyBpbnQocm93WzZdKQogICAgICAgICAgICAgICAgICAgIGlmIHJvd1s1XToKICAgICAgICAgICAgICAgICAgICAgICAgIyBSU19kb2NzX2JhcmNvZGVzIChpZF9kb2MsIGlkX2JhcmNvZGUsIGlzX3BsYW4pCiAgICAgICAgICAgICAgICAgICAgICAgIHJzX2RvY19iYXJjb2RlLmFwcGVuZCgoZG9jX251bSwgcm93WzVdLCAnMScpKQogICAgICAgICAgICAgICAgICAgICAgICAjIFJTX21hcmtpbmdfY29kZXMoaWQsIG1hcmtfY29kZSwgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3NlcmllcywgaWRfdW5pdCkgVkFMVUVTKD8sID8sID8sID8sID8sID8pCiAgICAgICAgICAgICAgICAgICAgICAgIHJzX21hcmtpbmdfY29kZXMuYXBwZW5kKChyb3dbNV0sIHJvd1s1XSwgcm93WzBdLCByb3dbOF0sICcnLCByb3dbMV0gKyByb3dbMF0pKQoKICAgICAgICAgICAgICAgIGVsaWYgbXlfcmVhZGVyLmxpbmVfbnVtID09IDM6CiAgICAgICAgICAgICAgICAgICAgaWYgcm93WzBdOgogICAgICAgICAgICAgICAgICAgICAgICBkb2NfbnVtID0gcm93WzBdCiAgICAgICAgICAgICAgICAgICAgcnNfZG9jX2RhdGEuYXBwZW5kKChkb2NfbnVtLCAn0JjQvdCy0L7QudGBJywgZG9jX251bSwgY3VycmVudF9kYXRlLCAnMDAxJywgJzAwMScpKQogICAgICAgICAgICAgICAgZWxpZiBteV9yZWFkZXIubGluZV9udW0gPT0gNToKICAgICAgICAgICAgICAgICAgICBsaXN0X2hlYWRlcnMgPSByb3cuY29weSgpCgogICAgICAgICMg0JfQsNC/0L7Qu9C90Y/QtdC8INGC0LDQsdC70LjRhtGLCiAgICAgICAgdWlfZ2xvYmFsLmJ1bGtfcXVlcnlfcmVwbGFjZShnZXRfcXVlcnlfdGV4dCgnUlNfZG9jcycpLCByc19kb2NfZGF0YSkKICAgICAgICB1aV9nbG9iYWwuYnVsa19xdWVyeV9yZXBsYWNlKGdldF9xdWVyeV90ZXh0KCdSU19kb2NzX3RhYmxlJyksIHJzX2RvY190YWJsZV9kYXRhKQogICAgICAgIHVpX2dsb2JhbC5idWxrX3F1ZXJ5X3JlcGxhY2UoZ2V0X3F1ZXJ5X3RleHQoJ1JTX2RvY3NfYmFyY29kZXMnKSwgcnNfZG9jX2JhcmNvZGUpCiAgICAgICAgdWlfZ2xvYmFsLmJ1bGtfcXVlcnlfcmVwbGFjZShnZXRfcXVlcnlfdGV4dCgnUlNfbWFya2luZ19jb2RlcycpLCByc19tYXJraW5nX2NvZGVzKQoKICAgICAgICAjINCf0L4g0LTQvtC60YPQvNC10L3RgtCw0LwsINCz0LTQtSDQtdGB0YLRjCDQt9Cw0L/Qu9Cw0L3QuNGA0L7QstCw0L3QvdGL0LUg0LzQsNGA0LrQuCwg0LTQvtCx0LDQstC40Lwg0L/RgNC40LfQvdCw0LoKICAgICAgICBxdGV4dCA9ICdTRUxFQ1QgaWRfZG9jLCBDT1VOVChpc19wbGFuKSBhcyBpc19wbGFuIEZST00gUlNfZG9jc19iYXJjb2RlcyBXSEVSRSBpc19wbGFuID0gIjEiICcKICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgJycsIFRydWUpCiAgICAgICAgcXRleHQgPSAnVVBEQVRFIFJTX2RvY3MgU0VUIGFkZF9tYXJrX3NlbGVjdGlvbiA9ID8gV0hFUkUgaWRfZG9jID0gPycKICAgICAgICAjIC0tLQogICAgICAgIGZvciBlbCBpbiByZXM6CiAgICAgICAgICAgIGlmIGVsWydpc19wbGFuJ10gPiAwOgogICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsICgxLCBlbFsnaWRfZG9jJ10pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsICgwLCBlbFsnaWRfZG9jJ10pKQogICAgICAgIHJldHVybiAyMDAKCgoKCiAgICBlbGlmIGZpbGVbOjE0XSA9PSAnaW5pdGlhbF9kaWN0c18nOgogICAgICAgICMg0JTQvtCx0LDQstC40Lwg0YLQuNC/INGC0L7QstCw0YDQsCDQtNC70Y8g0LLRgdC10YUg0YLQsNCx0LvQuNGGCiAgICAgICAgcXRleHQgPSAnUkVQTEFDRSBJTlRPIFJTX3R5cGVzX2dvb2RzICggIGlkLCBuYW1lKSBWQUxVRVMgKD8sPyknCiAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsICgn0KLQvtCy0LDRgCcsICfQotC+0LLQsNGAJykpCgogICAgICAgIHdpdGggb3BlbihwYXRoLCAncicsIG5ld2xpbmU9JycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGNzdmZpbGU6CgogICAgICAgICAgICBteV9yZWFkZXIgPSBjc3YucmVhZGVyKGNzdmZpbGUsIGRpYWxlY3Q9J2V4Y2VsJywgZGVsaW1pdGVyPSc7JywgcXVvdGVjaGFyPSciJykKCiAgICAgICAgICAgIHJzX2dvb2RzX2RhdGEgPSBbXQogICAgICAgICAgICByc19iYXJjb2Rlc19kYXRhID0gW10KICAgICAgICAgICAgcnNfdW5pdHNfZGF0YSA9IFtdCiAgICAgICAgICAgICMgUlNfd2FyZWhvdXNlcyggIGlkLCBuYW1lKQogICAgICAgICAgICByc193YXJlaG91c2VzID0gW1snMDAxJywgJ9Ce0YHQvdC+0LLQvdC+0LknXV0KICAgICAgICAgICAgIyBSU190eXBlc19nb29kcyAoICBpZCwgbmFtZSkKICAgICAgICAgICAgcnNfdHlwZXNfZ29vZHNfZGF0YSA9IFtbJzAwMScsICfQotC+0LLQsNGAJ11dCiAgICAgICAgICAgIHBhcnRfY291bnQgPSAxMDAwCgogICAgICAgICAgICBmb3Igcm93IGluIG15X3JlYWRlcjoKICAgICAgICAgICAgICAgIGlmIG15X3JlYWRlci5saW5lX251bSA9PSAxOiAgIyDQl9Cw0LPQvtC70L7QstC60Lgg0YLQsNCx0LvQuNGG0YsKICAgICAgICAgICAgICAgICAgICBsaXN0X2hlYWRlcnMgPSByb3cuY29weSgpCiAgICAgICAgICAgICAgICBlbHNlOiAgIyDQt9Cw0L/QvtC70L3Rj9C10Lwg0YLQsNCx0LvQuNGG0Ysg0L/QsNGA0LDQvNC10YLRgNC+0LIg0LfQsNC/0YDQvtGB0LAg0LogU1FMCiAgICAgICAgICAgICAgICAgICAgIyAgIGlkLCBjbyBkZSwgYXJ0LCBuYW1lLCB1bml0LCB0eXBlX2dvb2QsIGRlc2NyaXB0aW9uCiAgICAgICAgICAgICAgICAgICAgcnNfZ29vZHNfZGF0YS5hcHBlbmQoKHJvd1syXSwgcm93WzNdLCByb3dbNV0sIHJvd1s0XSwgcm93WzFdLCAn0KLQvtCy0LDRgCcsIHJvd1sxNV0pKQogICAgICAgICAgICAgICAgICAgICMgICBpZCwgaWRfb3duZXIsIGNvZGUsIG5hbWUsIG5vbWluYXRvciwgZGVub21pbmF0b3IsIGludF9yZWR1Y3Rpb24KICAgICAgICAgICAgICAgICAgICByc191bml0c19kYXRhLmFwcGVuZCgocm93WzFdICsgcm93WzJdLCByb3dbMl0sIHJvd1sxXSwgcm93WzFdLCAxLCAxLCByb3dbMV0pKQogICAgICAgICAgICAgICAgICAgICMgYmFyY29kZSwgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3NlcmllcywgaWRfdW5pdAogICAgICAgICAgICAgICAgICAgIGd0aW4gPSBub3JtYWxpemVfZ3Rpbihyb3dbMF0pCiAgICAgICAgICAgICAgICAgICAgcnNfYmFyY29kZXNfZGF0YS5hcHBlbmQoKGd0aW4sIGd0aW4sIHJvd1syXSwgJycsICcnLCByb3dbMV0gKyByb3dbMl0pKQoKICAgICAgICAgICAgICAgICMg0JrQsNC20LTRi9C1IDEwMDAg0YHRgtGA0L7QuiDQt9Cw0L/QuNGB0YvQstCw0LXQvCDQsiDQsdCw0LfRgwogICAgICAgICAgICAgICAgaWYgbXlfcmVhZGVyLmxpbmVfbnVtID09IHBhcnRfY291bnQ6CiAgICAgICAgICAgICAgICAgICAgcGFydF9jb3VudCArPSAxMDAwCiAgICAgICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmJ1bGtfcXVlcnlfcmVwbGFjZShnZXRfcXVlcnlfdGV4dCgnUlNfZ29vZHMnKSwgcnNfZ29vZHNfZGF0YSkKICAgICAgICAgICAgICAgICAgICB1aV9nbG9iYWwuYnVsa19xdWVyeV9yZXBsYWNlKGdldF9xdWVyeV90ZXh0KCdSU191bml0cycpLCByc191bml0c19kYXRhKQogICAgICAgICAgICAgICAgICAgIHVpX2dsb2JhbC5idWxrX3F1ZXJ5X3JlcGxhY2UoZ2V0X3F1ZXJ5X3RleHQoJ1JTX2JhcmNvZGVzJyksIHJzX2JhcmNvZGVzX2RhdGEpCiAgICAgICAgICAgICAgICAgICAgcnNfZ29vZHNfZGF0YSA9IFtdCiAgICAgICAgICAgICAgICAgICAgcnNfYmFyY29kZXNfZGF0YSA9IFtdCiAgICAgICAgICAgICAgICAgICAgcnNfdW5pdHNfZGF0YSA9IFtdCgogICAgICAgIHVpX2dsb2JhbC5idWxrX3F1ZXJ5X3JlcGxhY2UoZ2V0X3F1ZXJ5X3RleHQoJ1JTX3dhcmVob3VzZXMnKSwgcnNfd2FyZWhvdXNlcykKICAgICAgICB1aV9nbG9iYWwuYnVsa19xdWVyeV9yZXBsYWNlKGdldF9xdWVyeV90ZXh0KCdSU190eXBlc19nb29kcycpLCByc190eXBlc19nb29kc19kYXRhKQogICAgICAgIHVpX2dsb2JhbC5idWxrX3F1ZXJ5X3JlcGxhY2UoZ2V0X3F1ZXJ5X3RleHQoJ1JTX2dvb2RzJyksIHJzX2dvb2RzX2RhdGEpCiAgICAgICAgdWlfZ2xvYmFsLmJ1bGtfcXVlcnlfcmVwbGFjZShnZXRfcXVlcnlfdGV4dCgnUlNfdW5pdHMnKSwgcnNfdW5pdHNfZGF0YSkKICAgICAgICB1aV9nbG9iYWwuYnVsa19xdWVyeV9yZXBsYWNlKGdldF9xdWVyeV90ZXh0KCdSU19iYXJjb2RlcycpLCByc19iYXJjb2Rlc19kYXRhKQoKICAgICAgICByZXR1cm4gMjAwCgoKZGVmIGxpc3RfZm9sZGVyKHBhdGg6IHN0ciwgZGVsZXRlX2ZpbGVzOiBib29sKToKICAgICMgdHJ5OgogICAgYWEgPSAwCiAgICB0b3RhbCA9IDAKICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aCk6CiAgICAgICAgdG90YWwgKz0gMQogICAgICAgIGlmIGZpbGUuZW5kc3dpdGgoIi5jc3YiKToKICAgICAgICAgICAgZmlsZW5hbWUgPSBmaWxlICsgKCIgIiAqIDE1KSAgIyDRh9GC0L7QsdGLINC90LUg0L3QsNGC0YvQutCw0YLRjNGB0Y8g0L3QsCBvdXQgb2YgcmFuZ2Ug0LIg0YLQtdC60YHRgtC+0LLQvtC8INC40LzQtdC90LggLSDQtNC+0LHQsNCy0LjQvCAxNSDQv9GA0L7QsdC10LvQvtCyCiAgICAgICAgICAgIGlmIGZpbGVuYW1lWzo2XSA9PSAnZG9jX2luJyBvciBmaWxlbmFtZVs6MTRdID09ICdpbml0aWFsX2RpY3RzXyc6CiAgICAgICAgICAgICAgICBhYSArPSAxCiAgICAgICAgICAgICAgICBhbnMgPSBsb2FkX2Zyb21fY3N2KHBhdGggKyBmaWxlLCBmaWxlKQogICAgICAgICAgICAgICAgaWYgYW5zID09IDIwMCBhbmQgZGVsZXRlX2ZpbGVzID09ICd0cnVlJzoKICAgICAgICAgICAgICAgICAgICBvcy5yZW1vdmUocGF0aCArIGZpbGUpCgogICAgcmV0dXJuICfQl9Cw0LPRgNGD0LfQutCwINC30LDQstC10YDRiNC10L3QsCwg0LfQsNCz0YDRg9C20LXQvdC+ICcgKyBzdHIoYWEpICsgJyDRhNCw0LnQu9C+0LIg0LjQtyAnICsgc3RyKHRvdGFsKQogICAgIyBleGNlcHQ6CiAgICAjICAgcmV0dXJuICfQntGI0LjQsdC60LAg0L/RgNC4INC30LDQs9GA0YPQt9C60LUg0YTQsNC50LvQsCcKCgpkZWYgZXhwb3J0X2NzdihwYXRoLCBJUCwgQW5kcm9pZElEKToKICAgIGRvY3MgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgnU0VMRUNUIGlkX2RvYywgZG9jX24gZnJvbSBSU19kb2NzIFdoZXJlIHZlcmlmaWVkID0gMScpCiAgICBjb3VudCA9IDAKICAgIGZvciBkb2NfaXRlbSBpbiBkb2NzOgogICAgICAgIHF0ZXh0ID0gZ2V0X3F1ZXJ5X3RleHRfZXhwb3J0KCkKCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIChkb2NfaXRlbVswXSwpLCBUcnVlKQogICAgICAgIGNvdW50ICs9IDEKICAgICAgICB3aXRoIG9wZW4ocGF0aCArICdkb2Nfb3V0XycgKyBkb2NfaXRlbVsxXSArICcuY3N2JywgJ3cnLCBuZXdsaW5lPScnLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBjc3ZmaWxlOgogICAgICAgICAgICBteV9yZWFkZXIgPSBjc3Yud3JpdGVyKGNzdmZpbGUsIGRpYWxlY3Q9J2V4Y2VsJywgZGVsaW1pdGVyPSc7JywgcXVvdGVjaGFyPSciJykKICAgICAgICAgICAgbXlfcmVhZGVyLndyaXRlcm93KCgnTmFtZScsICdVc2VyTmFtZScsICdEZXZpY2VJZCcsICdEZXZpY2VJUCcpKQogICAgICAgICAgICBteV9yZWFkZXIud3JpdGVyb3coKCfQn9GA0LjRhdC+0LQg0L3QsCDRgdC60LvQsNC0ICcgKyBkb2NfaXRlbVsxXSwgJ9Cc0L7RgdC60LLQsDEnLCBBbmRyb2lkSUQsIElQKSkKICAgICAgICAgICAgbXlfcmVhZGVyLndyaXRlcm93KCgnR1RJTicsICfQmtC+0LTQktCj0YfQtdGC0L3QvtC50KHQuNGB0YLQtdC80LUnLCAn0J3QsNC40LzQtdC90L7QstCw0L3QuNC1JywgJ0RlY2xhcmVkUXVhbnRpdHknLCAnQ3VycmVudFF1YW50aXR5JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn0JrQvtGA0L7QsdC60LAnLCAn0JzQsNGA0LrQsCcsICfQnNCw0YDQutCw0JjQodCc0J8nLCAn0JjQvdCy0L7QudGBJywgJ9Cf0YDQuNC90LDQtNC70LXQttC90L7RgdGC0YwnKSkKICAgICAgICAgICAgZm9yIGVsIGluIHJlczoKICAgICAgICAgICAgICAgIGd0aW4gPSB1aV9iYXJjb2Rlcy5nZXRfZ3Rpbl9zZXJpYWxfZnJvbV9kYXRhbWF0cml4KGVsWyfQnNCw0YDQutCw0JjQodCc0J8nXSkKICAgICAgICAgICAgICAgIGVsWydHVElOJ10gPSBndGluWydHVElOJ10KICAgICAgICAgICAgICAgIG15X3JlYWRlci53cml0ZXJvdygoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxbJ0dUSU4nXSwgZWxbJ2lkX2dvb2QnXSwgZWxbJ25hbWUnXSwgZWxbJ0RlY2xhcmVkUXVhbnRpdHknXSwgZWxbJ0N1cnJlbnRRdWFudGl0eSddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsWyfQnNCw0YDQutCwJ10sIGVsWyfQnNCw0YDQutCw0JjQodCc0J8nXSwgZWxbJ9CY0L3QstC+0LnRgSddLCBlbFsn0J/RgNC40L3QsNC00LvQtdC20L3QvtGB0YLRjCddKSkKCiAgICByZXR1cm4gc3RyKGNvdW50KSArICcg0LTQvtC60YPQvNC10L3RgtC+0LInCiMgZXhwb3J0X2Nzdign0J7QsdC80LXQvdCi0KHQlC/QndCQLycpICMnCgoKIyBvcGVuX2ZpbGVzX25ldCgnJywgJ0Q6L1B5dGhvblByb2plY3RzL1JpZ2h0U2Nhbi9TVUltYWluL9Ce0LHQvNC10L3QotCh0JQv0J3QkC9pbml0aWFsX2RpY3RzXzAxLmNzdicsICdpbml0aWFsX2RpY3RzXzAxLmNzdicpCiMgb3Blbl9maWxlc19uZXQoJycsICdEOi9QeXRob25Qcm9qZWN0cy9SaWdodFNjYW4vU1VJbWFpbi/QntCx0LzQtdC90KLQodCUL9Cd0JAvZG9jXzEuY3N2JywnZG9jXzEuY3N2JykK"
            },
            {
                "PyFileKey": "ui_global",
                "PyFileData": "aW1wb3J0IGNvbGxlY3Rpb25zCmltcG9ydCBkYXRldGltZQppbXBvcnQgc3FsaXRlMwpmcm9tIHNxbGl0ZTMgaW1wb3J0IEVycm9yCmltcG9ydCB1aV9iYXJjb2RlcwppbXBvcnQgb3MKaW1wb3J0IHVpX2Zvcm1fZGF0YQppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCBxdWV1ZQoKcXVlcnlfbGlzdCA9IHF1ZXVlLlF1ZXVlKCkKIyDQktC+0YIg0YLQsNC60LjQvCDQvdC10LfQsNGC0LXQudC70LjQstGL0Lwg0LzQtdGC0L7QtNC+0Lwg0L7Qv9GA0LXQtNC10LvRj9C10LwsINC80Ysg0LfQsNC/0YPRgdGC0LjQu9C40YHRjCDQvdCwINC60L7QvNC/0LUg0LjQu9C4INC90LAg0KLQodCUICoqCiMg0J3RgyDQuCDQsiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC+0YIsINC40YHQv9C+0LvRjNC30YPQtdC8INCx0LDQt9GDICoqKioKaWYgb3MucGF0aC5leGlzdHMoJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy8nKTogI9C70L7QutCw0LvRjNC90L4KICAgIGRiX3BhdGggPSAnLy9kYXRhL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvZGF0YWJhc2VzL1JpZ2h0c2NhbicgICMgU2ltcGxlS2VlcCcKZWxzZToKICAgIGRiX3BhdGggPSAncmlnaHRzY2FuNS5kYicgICMgRDpcUHl0aG9uUHJvamVjdHNcUmlnaHRTY2FuXFNVSV9ub1BvbnlcCgpjb25uID0gTm9uZQoKZGVmIHRleHRfdG9fYm9vbCh2YWwpOgogICAgcGFzcwoKIyDQpNGD0L3QutGG0LjRjyDQv9C+0LvRg9GH0LDQtdGCINGB0YLRgNC+0LrQuCDQvNCw0YDQutC40YDQvtCy0LrQuCDQtNC+0LrRg9C80LXQvdGC0LAg0L/QviDQt9C90LDRh9C10L3QuNGOINC80LDRgNC60LjRgNC+0LLQutC4CmRlZiBmaW5kX2JhcmNvZGVfaW5fbWFya2luZ19jb2Rlc190YWJsZShzZWxmLCBzdHJ1Y3RfYmFyY29kZTogbGlzdCkgLT4gY29sbGVjdGlvbnMuSXRlcmFibGU6CiAgICBxdWVyeV90ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9xdWVyeV9tYXJrX2ZpbmRfaW5fZG9jKCkKICAgIGFyZ3NfZGljdCA9IHt9CiAgICBhcmdzX2RpY3RbJ0dUSU4nXSA9IHN0cnVjdF9iYXJjb2RlWydHVElOJ10KICAgIGFyZ3NfZGljdFsnU2VyaWVzJ10gPSBzdHJ1Y3RfYmFyY29kZVsnU0VSSUFMJ10KICAgIGFyZ3NfZGljdFsnaWRfZG9jJ10gPSBzZWxmLmlkX2RvYwoKICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJnc19kaWN0LCBUcnVlKQogICAgcmV0dXJuIHJlcwoKCmRlZiBmaW5kX2JhcmNvZGVfaW5fYmFyY29kZV90YWJsZShiYXJjb2RlOiBzdHIpIC0+IGNvbGxlY3Rpb25zLkl0ZXJhYmxlOgogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfYmFyY29kZV9xdWVyeSgpCiAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChiYXJjb2RlLCksIFRydWUpCiAgICByZXR1cm4gcmVzCgoKIyDQodGA0LDQstC90LjQstCw0LXRgiDQutC+0LvQuNGH0LXRgdGC0LLQvi3Qv9C70LDQvSDRgtC+0LLQsNGA0LAg0LIg0LTQvtC60YPQvNC10L3RgtC1INC4INC60L7Qu9C40YfQtdGB0YLQstC+INC80LDRgNC+0LosINC/0L4g0Y3RgtC+0LzRgyDRgtC+0LLQsNGA0YMg0YLQsNC8INC20LUuCiMg0JLQvtC30LLRgNCw0YnQsNC10YIgVHJ1ZSwg0LXRgdC70Lgg0LrQvtC70LjRh9C10YHRgtCy0L4g0LzQsNGA0L7QuiDQvNC10L3RjNGI0LUg0L/Qu9Cw0L3QsApkZWYgY2hlY2tfbWFya19jb2RlX2NvbXBsaWFuY2UoZWxfZGljdDogZGljdCwgaWRfZG9jLCBndGluKToKICAgIHF1ZXJ5X3RleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X21hcmtfcXR0eV9jb25mb3JtaXR5KCkKICAgIGFyZ3NfZGljdCA9IHt9CiAgICBhcmdzX2RpY3RbJ2lkRG9jJ10gPSBpZF9kb2MKICAgIGFyZ3NfZGljdFsnYmFyY29kZSddID0gJzAxJyArIGd0aW4gKyAnJScKICAgIGFyZ3NfZGljdFsnaWRfZ29vZCddID0gZWxfZGljdFsnaWRfZ29vZCddCiAgICBhcmdzX2RpY3RbJ2lkX3Byb3BlcnRpZXMnXSA9IGVsX2RpY3RbJ2lkX3Byb3BlcnR5J10KICAgIGFyZ3NfZGljdFsnaWRfc2VyaWVzJ10gPSBlbF9kaWN0WydpZF9zZXJpZXMnXQogICAgI2FyZ3NfZGljdFsnaWRfdW5pdCddID0gZWxfZGljdFsnaWRfdW5pdCddCiAgICBhcmdzX2RpY3RbJ2FwcHJvdmVkJ10gPSAnMScKICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJnc19kaWN0KQogICAgaWYgcmVzOgogICAgICAgIGlmIHJlc1swXVswXSA+IDA6CiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZWxpZiByZXNbMF1bMF0gPT0gMDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBUcnVlCgoKZGVmIGNoZWNrX2JhcmNvZGVfY29tcGxpYW5jZShlbF9kaWN0OiBkaWN0LCBpZF9kb2MpOgogICAgIyAxINCi0LDQutC+0Lkg0YLQvtCy0LDRgCDQsiDQv9GA0LjQvdGG0LjQv9C1INC10YHRgtGMINCyINC00L7QutGD0LzQtdC90YLQtQoKICAgIHF1ZXJ5X3RleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X3BsYW5fZ29vZF9mcm9tX2RvYygpCiAgICBhcmdzX2RpY3QgPSB7fQogICAgYXJnc19kaWN0WydpZERvYyddID0gaWRfZG9jCiAgICBhcmdzX2RpY3RbJ2lkX2dvb2QnXSA9IGVsX2RpY3RbJ2lkX2dvb2QnXQogICAgYXJnc19kaWN0WydpZF9wcm9wZXJ0aWVzJ10gPSBlbF9kaWN0WydpZF9wcm9wZXJ0eSddCiAgICBhcmdzX2RpY3RbJ2lkX3NlcmllcyddID0gZWxfZGljdFsnaWRfc2VyaWVzJ10KICAgICNhcmdzX2RpY3RbJ2lkX3VuaXQnXSA9IGVsX2RpY3RbJ2lkX3VuaXQnXQoKICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJnc19kaWN0LCBUcnVlKQogICAgIyBpZiByZXM6CiAgICAjICAgICBpZiByZXNbMF1bMF0gYW5kIHJlc1swXVswXSA+IDA6CiAgICAjICAgICAgICAgcmV0dXJuIFRydWUKICAgICMgICAgIGVsaWYgcmVzWzBdWzBdIGlzIE5vbmU6CiAgICAjICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAjICAgICBlbGlmIHJlc1swXVswXSA9PSAwOgogICAgIyAgICAgICAgIHJldHVybiBGYWxzZQogICAgIyAgICAgZWxzZToKICAgICMgICAgICAgICByZXR1cm4gRmFsc2UKICAgIHJldHVybiByZXMKIwojCiMgZGVmIGdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJncz0iIiwgcmV0dXJuX2RpY3Q9RmFsc2UpOgojICAgICBxdWVyeV9xdWV1ZSA9IHF1ZXVlLlF1ZXVlKCkKIyAgICAgcmVzdWx0cyA9IHt9CiMKIyAgICAgZGVmIHdvcmtlcigpOgojICAgICAgICAgY29ubiA9IHNxbGl0ZTMuY29ubmVjdChkYl9wYXRoKQojICAgICAgICAgd2hpbGUgVHJ1ZToKIyAgICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5X3F1ZXVlLmdldCgpCiMgICAgICAgICAgICAgaWYgcXVlcnkgaXMgTm9uZToKIyAgICAgICAgICAgICAgICAgIyBzaWduYWwgdG8gc3RvcCB0aGUgd29ya2VyIHRocmVhZAojICAgICAgICAgICAgICAgICBicmVhawojICAgICAgICAgICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKIyAgICAgICAgICAgICB0cnk6CiMgICAgICAgICAgICAgICAgIGlmIGFyZ3M6CiMgICAgICAgICAgICAgICAgICAgICBjdXJzb3IuZXhlY3V0ZShxdWVyeSwgYXJncykKIyAgICAgICAgICAgICAgICAgZWxzZToKIyAgICAgICAgICAgICAgICAgICAgIGN1cnNvci5leGVjdXRlKHF1ZXJ5KQojICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKIyAgICAgICAgICAgICAgICAgcmVzdWx0c1txdWVyeV0gPSAgeydFcnJvcic6ZX0KIyAgICAgICAgICAgICAgICAgY29udGludWUKIyAgICAgICAgICAgICBpZiByZXR1cm5fZGljdDoKIyAgICAgICAgICAgICAgICAgcmVzID0gW2RpY3QobGluZSkgZm9yIGxpbmUgaW4gW3ppcChbY29sdW1uWzBdIGZvciBjb2x1bW4gaW4gY3Vyc29yLmRlc2NyaXB0aW9uXSwgcm93KSBmb3Igcm93IGluIGN1cnNvci5mZXRjaGFsbCgpXV0KIyAgICAgICAgICAgICBlbHNlOgojICAgICAgICAgICAgICAgICByZXMgPSBjdXJzb3IuZmV0Y2hhbGwoKQojICAgICAgICAgICAgIHJlc3VsdHNbcXVlcnldID0gcmVzCiMKIyAgICAgICAgIGNvbm4uY29tbWl0KCkKIyAgICAgICAgIGNvbm4uY2xvc2UoKQojCiMgICAgICMgc3RhcnQgdGhlIHdvcmtlciB0aHJlYWQKIyAgICAgdCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXdvcmtlcikKIyAgICAgdC5zdGFydCgpCiMKIyAgICAgIyBhZGQgdGhlIHF1ZXJ5IHRvIHRoZSBxdWV1ZQojICAgICBxdWVyeV9xdWV1ZS5wdXQocXVlcnlfdGV4dCkKIwojICAgICAjIGNoZWNrIGlmIHRoZSByZXN1bHQgaXMgYXZhaWxhYmxlIGluIHRoZSBkaWN0aW9uYXJ5CiMgICAgIHdoaWxlIHF1ZXJ5X3RleHQgbm90IGluIHJlc3VsdHM6CiMgICAgICAgICBwYXNzCiMKIyAgICAgIyBzdG9wIHRoZSB3b3JrZXIgdGhyZWFkCiMgICAgIHF1ZXJ5X3F1ZXVlLnB1dChOb25lKQojICAgICB0LmpvaW4oKQojCiMgICAgIHJldHVybiByZXN1bHRzW3F1ZXJ5X3RleHRdCgoKCmRlZiBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQ6IG9iamVjdCwgYXJnczogb2JqZWN0ID0gIiIsIHJldHVybl9kaWN0PUZhbHNlKSAtPiBjb2xsZWN0aW9ucy5JdGVyYWJsZToKICAgICMgKioqKioqKioqKioqKioqKioqKioqKgoKICAgICMgZ2xvYmFsIGNvbm4KICAgICMgZ2V0X2RhdGFiYXNlX2Nvbm5lY3Rpb24oKQogICAgdHJ5OgogICAgICAgIGNvbm4gPSBzcWxpdGUzLmNvbm5lY3QoZGJfcGF0aCkKCiAgICBleGNlcHQgRXJyb3I6CgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ05vIGNvbm5lY3Rpb24gd2l0aCBkYXRhYmFzZScpCgogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQogICAgdHJ5OgogICAgICAgIGlmIGFyZ3M6CiAgICAgICAgICAgIGN1cnNvci5leGVjdXRlKHF1ZXJ5X3RleHQsIGFyZ3MpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY3Vyc29yLmV4ZWN1dGUocXVlcnlfdGV4dCkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByYWlzZSBlCgoKICAgICMg0JXRgdC70Lgg0L3QsNC00L4gLSDQstC+0LfQstGA0LDRidCw0LXQvCDQvdC1INGA0LXQt9GD0LvRjNGC0LDRgiDQt9Cw0L/RgNC+0YHQsCwg0LAg0YHQu9C+0LLQsNGA0Ywg0YEg0LjQvNC/0L7RgNGC0LjRgNC+0LLQsNC90L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtC+0LwKICAgIGlmIHJldHVybl9kaWN0OgogICAgICAgIHJlcyA9IFtkaWN0KGxpbmUpIGZvciBsaW5lIGluCiAgICAgICAgICAgICAgIFt6aXAoW2NvbHVtblswXSBmb3IgY29sdW1uIGluIGN1cnNvci5kZXNjcmlwdGlvbl0sIHJvdykgZm9yIHJvdyBpbiBjdXJzb3IuZmV0Y2hhbGwoKV1dCiAgICBlbHNlOgogICAgICAgIHJlcyA9IGN1cnNvci5mZXRjaGFsbCgpCiAgICBjb25uLmNvbW1pdCgpCiAgICBjb25uLmNsb3NlKCkKICAgIHJldHVybiByZXMKCgpkZWYgZXhlY3V0ZV9zY3JpcHQocXVlcnlfdGV4dCk6CiAgICAjIGdsb2JhbCBjb25uICAjID0gTm9uZQogICAgIyBnZXRfZGF0YWJhc2VfY29ubmVjdGlvbigpCiAgICB0cnk6CiAgICAgICAgY29ubiA9IHNxbGl0ZTMuY29ubmVjdChkYl9wYXRoKQoKICAgIGV4Y2VwdCBFcnJvcjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdObyBjb25uZWN0aW9uIHdpdGggZGF0YWJhc2UnKQoKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgIHRyeToKICAgICAgICBjdXJzb3IuZXhlY3V0ZXNjcmlwdChxdWVyeV90ZXh0KQogICAgICAgIGNvbm4uY29tbWl0KCkKICAgIGV4Y2VwdCBzcWxpdGUzLkVycm9yIGFzIGVyOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZXIpCiAgICBjb25uLmNsb3NlKCkKCgpkZWYgYnVsa19xdWVyeV9yZXBsYWNlKHF1ZXJ5X3RleHQ6IHN0ciwgYXJnczogb2JqZWN0ID0gIiIpIC0+IG9iamVjdDoKICAgICMgKioqKioqKioqKioqKioqKioqKioqKgogICAgIyBnbG9iYWwgY29ubgogICAgIyBnZXRfZGF0YWJhc2VfY29ubmVjdGlvbigpCiAgICBjb25uID0gTm9uZQogICAgdHJ5OgogICAgICAgIGNvbm4gPSBzcWxpdGUzLmNvbm5lY3QoZGJfcGF0aCkKCiAgICBleGNlcHQgRXJyb3I6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignTm8gY29ubmVjdGlvbiB3aXRoIGRhdGFiYXNlJykKCiAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpCiAgICB0cnk6CiAgICAgICAgaWYgYXJnczoKICAgICAgICAgICAgY3Vyc29yLmV4ZWN1dGVtYW55KHF1ZXJ5X3RleHQsIGFyZ3MpCgogICAgICAgIGNvbm4uY29tbWl0KCkKICAgIGV4Y2VwdCBzcWxpdGUzLkVycm9yIGFzIGVyOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZXIpCgogICAgcmVzID0gY3Vyc29yLmZldGNoYWxsKCkKCiAgICBjb25uLmNsb3NlKCkKICAgIHJldHVybiByZXMKCgpkZWYgZ2V0X25hbWVfbGlzdChzdHJfZW50dHkpOgogICAgcXVlcnkgPSAiU0VMRUNUIG5hbWUgRlJPTSAiICsgc3RyX2VudHR5CiAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQogICAgbGlzdF9lbCA9IFtdCiAgICAjIGxpc3RfZWwuYXBwZW5kKG5hbWUgZm9yIG5hbWUgaW4gcmVzKQogICAgZm9yIGVsIGluIHJlczoKICAgICAgICBsaXN0X2VsLmFwcGVuZChlbFswXSkKICAgIHJldHVybiAiOyIuam9pbihsaXN0X2VsKQoKCmRlZiBnZXRfYnlfbmFtZShmbGQsIHRhYmxlKToKICAgIHF1ZXJ5ID0gIlNFTEVDVCBpZCBGUk9NICIgKyB0YWJsZSArICcgV0hFUkUgbmFtZSA9ID8nCiAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoZmxkLCkpCgogICAgaWYgbGVuKHJlcykgPT0gMDoKICAgICAgICByZXR1cm4gIiIKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHJlc1swXVswXQoKCmRlZiBnZXRfY29uc3RhbnRzKG5lZWRfY29uc3Q9JycpOgogICAgc3FsX3RleHQgPSAnU2VsZWN0ICogZnJvbSBSU19jb25zdGFudHMnCiAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHNxbF90ZXh0KQoKICAgICMg0LjQvdC40YbQuNCw0LvQuNC30LjRgNGD0LXQvCDQutC+0L3RgdGC0LDQvdGC0YsKICAgIGlmIG5vdCByZXM6ICAjIGxlbihyZXMpID09IDA6CiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdCgKICAgICAgICAgICAgJ0lOU0VSVCBJTlRPIFJTX2NvbnN0YW50cyAodXNlX3NlcmllcywgdXNlX3Byb3BlcnRpZXMsIHVzZV9tYXJrLCBhZGRfaWZfbm90X2luX3BsYW4sIHBhdGgsIGRlbGV0ZV9maWxlcywgcmVzZXJ2ZWQsIGFsbG93X292ZXJzY2FuKSBWQUxVRVMgKD8sPyw/LD8sPyw/LD8sPyknLAogICAgICAgICAgICAoJzAnLCAnMCcsICcwJywgJzAnLCAnLy9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpLycsICcwJywKICAgICAgICAgICAgICcwJywgJzAnKSkgICMgLy9zdG9yYWdlL2VtdWxhdGVkLzAvZG93bmxvYWQvCgogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQoc3FsX3RleHQpCgogICAgZWxzZTogICMgbGVuKHJlcyk+MDoKICAgICAgICBpZiBuZWVkX2NvbnN0OgogICAgICAgICAgICBscyA9IFsnaWQnLCAndXNlX3NlcmllcycsICd1c2VfcHJvcGVydGllcycsICd1c2VfbWFyaycsICdhZGRfaWZfbm90X2luX3BsYW4nLCAncGF0aCcsICdkZWxldGVfZmlsZXMnLAogICAgICAgICAgICAgICAgICAncmVzZXJ2ZWQnLCAnYWxsb3dfb3ZlcnNjYW4nLCAncmVsZWFzZSddCiAgICAgICAgICAgIHggPSBscy5pbmRleChuZWVkX2NvbnN0KQoKICAgICAgICAgICAgaWYgeCA+IDA6CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzWzBdW3hdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQoKCgpkZWYgcHV0X2NvbnN0YW50cyhhcmdzKToKICAgIHNxbF91cGRhdGVfcXVlcnkgPSAiIiJVcGRhdGUgUlNfY29uc3RhbnRzIHNldCB1c2Vfc2VyaWVzID0gPywgdXNlX3Byb3BlcnRpZXMgPSA/LCB1c2VfbWFyayA9ID8sIGFkZF9pZl9ub3RfaW5fcGxhbj0/LCBwYXRoID0gPywKICAgICBkZWxldGVfZmlsZXMgPSA/LCBhbGxvd19vdmVyc2NhbiA9ID8gIiIiCiAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHNxbF91cGRhdGVfcXVlcnksIGFyZ3MpCgoKZGVmIElkX3RvX0hFWChndWlkKToKICAgIHgxID0gZ3VpZFsxOToyM10KICAgIHgyID0gZ3VpZFsyNDogMzZdCiAgICB4MyA9IGd1aWRbMTQ6IDE4XQogICAgeDQgPSBndWlkWzk6MTNdCiAgICB4NSA9IGd1aWRbMDogOF0KCiAgICBzdHJfZ3VpZCA9IHgxICsgeDIgKyB4MyArIHg0ICsgeDUKICAgIHJldHVybiBpbnQoc3RyX2d1aWQsIDE2KQoKCgojCmNsYXNzIFJzX2RvYygpOgogICAgaWRfZG9jID0gJycgICMgc3RyKQogICAgaWRfc3RyID0gJycgICMgc3RyKQogICAgcXR0eSA9ICcnICAjIHN0cikKCiAgICBkZWYgdXBkYXRlX2RvY19zdHIoc2VsZiwgcHJpY2U9MCk6CiAgICAgICAgcXVlcnkgPSAiIiIKICAgICAgICBVUERBVEUgUlNfZG9jc190YWJsZQogICAgICAgIFNFVCBxdHR5PT8sIHByaWNlPT8KICAgICAgICBXaGVyZSBpZD0/ICIiIgogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnksIChzZWxmLnF0dHksIHByaWNlLCBzZWxmLmlkX3N0cikpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBkZWxldGVfZG9jKHNlbGYpOgogICAgICAgIHF1ZXJ5X2RvY190YWJsZSA9ICdERUxFVEUgRlJPTSBSU19kb2NzX3RhYmxlIFdIRVJFIGlkX2RvYyA9ID8nCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9kb2NfdGFibGUsIChzZWxmLmlkX2RvYywpKQogICAgICAgIHF1ZXJ5X2RvY190YWJsZSA9ICdERUxFVEUgRlJPTSBSU19kb2NzX2JhcmNvZGVzIFdIRVJFIGlkX2RvYyA9ID8nCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9kb2NfdGFibGUsIChzZWxmLmlkX2RvYywpKQogICAgICAgIHF1ZXJ5X2RvYyA9ICdERUxFVEUgRlJPTSBSU19kb2NzIFdIRVJFIGlkX2RvYyA9ID8nCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9kb2MsIChzZWxmLmlkX2RvYywpKQoKICAgICAgICByZXR1cm4gcmVzCiAgICBkZWYgY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAoJ1VwZGF0ZSBSU19kb2NzX2JhcmNvZGVzIFNldCBhcHByb3ZlZCA9IDAgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICdEZWxldGUgRnJvbSBSU19kb2NzX2JhcmNvZGVzIFdoZXJlICBpZF9kb2M9OmlkX2RvYyBBbmQgaXNfcGxhbiA9IDAnLAogICAgICAgICdVcGRhdGUgUlNfZG9jc190YWJsZSBTZXQgcXR0eSA9IDAgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICdEZWxldGUgRnJvbSBSU19kb2NzX3RhYmxlIFdoZXJlIGlkX2RvYz06aWRfZG9jIGFuZCBpc19wbGFuID0gIkZhbHNlIicpCiAgICAgICAgZm9yIGVsIGluIHF1ZXJ5X3RleHQ6CiAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQoZWwsICh7J2lkX2RvYyc6c2VsZi5pZF9kb2N9KSkKCiAgICBkZWYgbWFya19mb3JfdXBsb2FkKHNlbGYpOgogICAgICAgIHF1ZXJ5ID0gIiIiCiAgICAgICAgVVBEQVRFIFJTX2RvY3NfdGFibGUKICAgICAgICBTRVQgc2VudD0xCiAgICAgICAgV2hlcmUgaWQ9PyAiIiIKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoc2VsZi5pZF9kb2MpKQoKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIG1hcmtfdmVyaWZpZWQoc2VsZiwga2V5KToKICAgICAgICBxdWVyeSA9ICIiIgogICAgICAgICAgICAgICAgVVBEQVRFIFJTX2RvY3MKICAgICAgICAgICAgICAgIFNFVCB2ZXJpZmllZD0/CiAgICAgICAgICAgICAgICBXaGVyZSBpZF9kb2M9PyAiIiIKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoaW50KGtleSksIHNlbGYuaWRfZG9jKSkKCiAgICBkZWYgZmluZF9iYXJjb2RlX2luX3RhYmxlKHNlbGYsIHNlYXJjaF92YWx1ZTogc3RyLCBmdW5jX2NvbXBhcmVkPSc9PycpIC0+IG9iamVjdDoKCiAgICAgICAgcXVlcnkgPSAnJycKICAgICAgICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9nb29kLAogICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3NlcmllcywKICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF91bml0LAogICAgICAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWQsCiAgICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5ICAgICAgICAKICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzCiAgICAgICAgICAgICAgICAgTGVmdCBqb2luIFJTX2RvY3NfdGFibGUgT04KICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2Q9IFJTX2JhcmNvZGVzLmlkX2dvb2QgYW5kCiAgICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzPSBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSBhbmQKICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3VuaXQ9IFJTX2JhcmNvZGVzLmlkX3VuaXQgQW5kCiAgICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2M9PwogICAgICAgICAgICAgICAgIHdoZXJlIGJhcmNvZGUgJycnICsgZnVuY19jb21wYXJlZAogICAgICAgICMgcXVlcnkgPSBxdWVyeSArIGZ1bmNfY29tcGFyZWQKCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocXVlcnksIChzZWxmLmlkX2RvYywgc2VhcmNoX3ZhbHVlKSwgVHJ1ZSkKCiAgICBkZWYgZmluZF9iYXJjb2RlX2luX21hcmtfdGFibGUoc2VsZiwgc2VhcmNoX3ZhbHVlOiBzdHIsIGZ1bmNfY29tcGFyZWQ9Jz0/JykgLT4gb2JqZWN0OgogICAgICAgIHF1ZXJ5ID0gJycnCiAgICAgICAgICAgICAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgICAgICAgICBSU19tYXJraW5nX2NvZGVzLmlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX21hcmtpbmdfY29kZXMuaWRfcHJvcGVydHksCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX21hcmtpbmdfY29kZXMuaWRfc2VyaWVzLAogICAgICAgICAgICAgICAgICAgICAgICBSU19tYXJraW5nX2NvZGVzLmlkX3VuaXQsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucXR0eSAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIEZST00gUlNfbWFya2luZ19jb2RlcwogICAgICAgICAgICAgICAgICAgICAgICBMZWZ0IGpvaW4gUlNfZG9jc190YWJsZSBPTgogICAgICAgICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2Q9IFJTX21hcmtpbmdfY29kZXMuaWRfZ29vZCBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzPSBSU19tYXJraW5nX2NvZGVzLmlkX3Byb3BlcnR5IGFuZAogICAgICAgICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3VuaXQ9IFJTX21hcmtpbmdfY29kZXMuaWRfdW5pdCBBbmQKICAgICAgICAgICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2M9PwogICAgICAgICAgICAgICAgICAgICAgICB3aGVyZSBtYXJrX2NvZGUgICcnJyArIGZ1bmNfY29tcGFyZWQKICAgICAgICAjIHF1ZXJ5ID0gcXVlcnkgKyBmdW5jX2NvbXBhcmVkCgogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoc2VsZi5pZF9kb2MsIHNlYXJjaF92YWx1ZSksIFRydWUpCgogICAgZGVmIHVwZGF0ZV9kb2NfdGFibGVfZGF0YShzZWxmLCBlbGVtX2Zvcl9hZGQ6IGRpY3QsIHF0dHk9MSk6CiAgICAgICAgIyDQodC90LDRh9Cw0LvQsCDQvtC/0YDQtdC00LXQu9C40LwsINC10YHRgtGMINC70Lgg0LIg0YHQv9C40YHQutC1INGC0L7QstCw0YDQvtCyINC00L7QutGD0LzQtdC90YLQsCDQvdCw0Ygg0YLQvtCy0LDRgDoKICAgICAgICBxdGV4dCA9ICdTZWxlY3QgKiBmcm9tIFJTX2RvY3NfdGFibGUgV2hlcmUgaWRfZG9jPT8gYW5kIGlkX2dvb2QgPSA/IGFuZCBpZF9wcm9wZXJ0aWVzID0gPyBhbmQgaWRfc2VyaWVzID0gPyAnICNhbmQgaWRfdW5pdCA9ID8KICAgICAgICBhcmdzID0gKHNlbGYuaWRfZG9jLCBlbGVtX2Zvcl9hZGRbJ2lkX2dvb2QnXSwgZWxlbV9mb3JfYWRkWydpZF9wcm9wZXJ0eSddLCBlbGVtX2Zvcl9hZGRbJ2lkX3NlcmllcyddKSAjLGVsZW1fZm9yX2FkZFsnaWRfdW5pdCddCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgYXJncywgVHJ1ZSkKICAgICAgICBpZiByZXM6ICAjINCd0LDRiNC70Lgg0YHRgtGA0L7QutC4INC00L7QutGD0LzQtdC90YLQsCwg0LTQvtCx0LDQstC70Y/QtdC8INC60L7Qu9C40YfQtdGB0YLQstC+CgogICAgICAgICAgICBlbCA9IHJlc1swXQogICAgICAgICAgICAjIGlmIGVsWydxdHR5J10rcXR0eSA9PSAwOgogICAgICAgICAgICAjICAgICBxdGV4dCA9ICdERUxFVEUgRlJPTSBSU19kb2NzX3RhYmxlICBXSEVSRSBpZCA9ID8nCiAgICAgICAgICAgICMgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQsIChlbFsnaWQnXSwpKQogICAgICAgICAgICAjIGVsc2U6CiAgICAgICAgICAgIHF0ZXh0ID0gJ1VQREFURSBSU19kb2NzX3RhYmxlIFNFVCBxdHR5PXF0dHkrPywgbGFzdF91cGRhdGVkID0gPyAgV0hFUkUgaWQgPSA/JwogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCAocXR0eSwgc3RyKGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpKSwgZWxbJ2lkJ10pKQogICAgICAgIGVsc2U6ICAjINCi0LDQutC+0Lkg0YHRgtGA0L7QutC4INC90LXRgiwg0L3QsNC00L4g0LTQvtCx0LDQstC40YLRjAogICAgICAgICAgICBxdGV4dCA9ICdSRVBMQUNFIElOVE8gUlNfZG9jc190YWJsZShpZF9kb2MsIGlkX2dvb2QsIGlkX3Byb3BlcnRpZXMsaWRfc2VyaWVzLCBpZF91bml0LCBxdHR5LCBwcmljZSwgaWRfcHJpY2UsIGlzX3BsYW4pIFZBTFVFUyAoPyw/LD8sPyw/LD8sPyw/LD8pJwogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCAoCiAgICAgICAgICAgICAgICBzZWxmLmlkX2RvYywgZWxlbV9mb3JfYWRkWydpZF9nb29kJ10sIGVsZW1fZm9yX2FkZFsnaWRfcHJvcGVydHknXSwgZWxlbV9mb3JfYWRkWydpZF9zZXJpZXMnXSwKICAgICAgICAgICAgICAgIGVsZW1fZm9yX2FkZFsnaWRfdW5pdCddLCBxdHR5LCAwLCAnJywgJ0ZhbHNlJykpCgogICAgICAgIHJldHVybiByZXMKCiAgICAjINCk0YPQs9C60YbQuNGPINC00L7QsdCw0LLQu9GP0LXRgiDRgdGC0YDQvtC60YMg0LIg0LzQsNGA0LrQuNGA0L7QstC60YMg0LTQvtC60YPQvNC10L3RgtCwINC90LAg0L7RgdC90L7QstCw0L3QuNC4INCx0LDRgNC60L7QtNCwIChkYXRhTWF0cml4KQogICAgZGVmIGFkZF9tYXJrZWRfY29kZXNfaW5fZG9jKHNlbGYsIGJhcmNvZGVfaW5mbyk6CiAgICAgICAgcXRleHQgPSAnU0VMRUNUICogRlJPTSBSU19tYXJraW5nX2NvZGVzIFdoZXJlIG1hcmtfY29kZSA9PycKICAgICAgICBxX2RvY190ZXh0ID0gJ1JFUExBQ0UgSU5UTyBSU19kb2NzX2JhcmNvZGVzIChpZF9kb2MsIGlkX2JhcmNvZGUsIGJhcmNvZGVfZnJvbV9zY2FubmVyLCBpc19wbGFuLCBhcHByb3ZlZCkgVkFMVUVTICg/LD8sPyw/LD8pJwogICAgICAgICMg0JjRidC10Lwg0LrQvtC0INC80LDRgNC60LjRgNC+0LLQutC4INCyINGC0LDQsdC70LjRhtC1IFJTX21hcmtpbmdfY29kZXMg0L/QviBHVElOINC4IFNFUklBTAogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXRleHQsICgnMDEnICsgYmFyY29kZV9pbmZvWydHVElOJ10gKyAnMjEnICsgYmFyY29kZV9pbmZvWydTRVJJQUwnXSwpLCBUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgIyDQndCw0YjQu9C4INGC0LDQutC+0Lkg0LHQsNGA0LrQvtC0INCyINGB0L/QuNGB0LrQtSDQvNCw0YDQutC40YDQvtCy0LrQuCwg0LfQsNC/0L7Qu9C90Y/QtdC8INGB0YLRgNC+0LrRgyDQvNCw0YDQutC40YDQvtCy0LrQuCDQtNC+0LrRg9C80LXQvdGC0LAKCiAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQocV9kb2NfdGV4dCwgKHNlbGYuaWRfZG9jLCByZXNbMF1bJ2lkJ10sIGJhcmNvZGVfaW5mb1snRnVsbEJhcmNvZGUnXSwgJzAnLCAnMScpLCBUcnVlKQogICAgICAgICAgICByZXR1cm4gcmVzWzBdCiAgICAgICAgZWxzZTogICMg0J3QtSDQvdCw0YjQu9C4IC0g0L/RgNC+0LHRg9C10Lwg0LjRgdC60LDRgtGMINC/0L4gR1RJTiDQsiDRgtCw0LHQu9C40YbQtSDQsdCw0YDQutC+0LTQvtCyCiAgICAgICAgICAgIHJlcyA9IHNlbGYuZmluZF9iYXJjb2RlX2luX21hcmtfdGFibGUoc2VsZiwgJzAxJyArIGJhcmNvZGVfaW5mb1snR1RJTiddICsgJyUnLCAnTGlrZSA/JykKICAgICAgICAgICAgaWYgcmVzOiAgIyDQndCw0YjQu9C4INC/0L4gR1RJTiwg0LfQsNC/0L7Qu9C90Y/QtdC8INC00L7QutGD0LzQtdC90YIKICAgICAgICAgICAgICAgIGVsID0gcmVzWzBdCiAgICAgICAgICAgICAgICAjINCh0L3QsNGH0LDQu9CwINC30LDQv9C+0LvQvdC40Lwg0YLQsNCx0LvQuNGG0YMgUlNfbWFya2luZ19jb2RlcwogICAgICAgICAgICAgICAgcXRleHQgPSAnUkVQTEFDRSBJTlRPIFJTX21hcmtpbmdfY29kZXMgKGlkLCBtYXJrX2NvZGUsIGlkX2dvb2QsIGlkX3Byb3BlcnR5LCBpZF9zZXJpZXMsIGlkX3VuaXQpIFZBTFVFUyAoPyw/LD8sPyw/LD8pJwogICAgICAgICAgICAgICAgbWFya19jb2RlID0gJzAxJyArIGJhcmNvZGVfaW5mb1snR1RJTiddICsgJzIxJyArIGJhcmNvZGVfaW5mb1snU0VSSUFMJ10KICAgICAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQsICgKICAgICAgICAgICAgICAgICAgICBtYXJrX2NvZGUsIG1hcmtfY29kZSwgZWxbJ2lkX2dvb2QnXSwgZWxbJ2lkX3Byb3BlcnR5J10sIGVsWydpZF9zZXJpZXMnXSwgZWxbJ2lkX3VuaXQnXSkpCiAgICAgICAgICAgICAgICAjINCYINGC0LXQv9C10YDRjCDRgtCw0LHQu9C40YbRgyDQtNC+0LrRg9C80LXQvdGC0LAg0YHQviDRgdGB0YvQu9C60L7QuSDQvdCwIFJTX21hcmtpbmdfY29kZXMKICAgICAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQocV9kb2NfdGV4dCwgKHNlbGYuaWRfZG9jLCBtYXJrX2NvZGUsIGJhcmNvZGVfaW5mb1snRnVsbEJhcmNvZGUnXSwgJzAnLCAnMScpKQogICAgICAgICAgICAgICAgZWxbJ21hcmtfY29kZSddID0gbWFya19jb2RlCiAgICAgICAgICAgICAgICByZXR1cm4gZWwKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBOb25lCgoKICAgIGRlZiBhZGRfbmV3X2JhcmNvZGVfaW5fZG9jX2JhcmNvZGVzX3RhYmxlKHNlbGYsIGVsLCBiYXJjb2RlX2luZm8pOgogICAgICAgIHF1ZXJ5X3RleHQgPSAnJycKICAgICAgICBJbnNlcnQgSW50byBSU19kb2NzX2JhcmNvZGVzICgKICAgICAgICBpZF9kb2MsCiAgICAgICAgaWRfZ29vZCwKICAgICAgICBpZF9wcm9wZXJ0eSwKICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgaWRfdW5pdCwKICAgICAgICBiYXJjb2RlX2Zyb21fc2Nhbm5lciwKICAgICAgICBhcHByb3ZlZCAsCiAgICAgICAgR1RJTiwKICAgICAgICBTZXJpZXMpIFZBTFVFUyAoPyw/LD8sPyw/LD8sPyw/LD8pJycnCiAgICAgICAgYXJncyA9IChzZWxmLmlkX2RvYywgZWxbJ2lkX2dvb2QnXSxlbFsnaWRfcHJvcGVydHknXSxlbFsnaWRfc2VyaWVzJ10sZWxbJ2lkX3VuaXQnXSxiYXJjb2RlX2luZm9bJ0Z1bGxDb2RlJ10sJzEnLCBiYXJjb2RlX2luZm9bJ0dUSU4nXSwgYmFyY29kZV9pbmZvWydTRVJJQUwnXSkKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3MpCgoKCiAgICAjINCV0YHRgtGMINC/0LvQsNC9INC/0L4g0LrQvtC70LjRh9C10YHRgtCy0YMgIC0gaGF2ZV9xdHR5X3BsYW4KICAgICMg0JXRgdGC0Ywg0L/Qu9Cw0L0g0L/QviDRgdC/0LjRgdC60YMg0YLQvtCy0LDRgNC+0LIgaGF2ZV96ZXJvX3BsYW4KICAgICMg0JrQntC90YLRgNC+0LvRjCDQv9C70LDQvdC+0LIg0LIg0LTQvtC60YPQvNC10L3RgtC1IC0gY29udHJvbAogICAgIyDQldGB0YLRjCDQv9C70LDQvSDQv9C+INC80LDRgNC60LjRgNGD0LXQvNC+0Lkg0L/RgNC+0LTRg9C60YbQuNC4IGhhdmVfbWFya19wbGFuCiAgICBkZWYgcHJvY2Vzc190aGVfYmFyY29kZShzZWxmLCBiYXJjb2RlLCBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlLCBoYXZlX3plcm9fcGxhbiA9IEZhbHNlLCBjb250cm9sID0gRmFsc2UsIGhhdmVfbWFya19wbGFuID0gRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtID0gTm9uZSk6ICMgYWRkX2lmX25vdF9mb3VuZD1GYWxzZSwgYWRkX2lmX25vdF9pbl9wbGFuPUZhbHNlKToKICAgICAgICAjINCf0L7Qu9GD0YfQuNC8INGB0YLRgNGD0LrRgtGD0YDRgyDQsdCw0YDQutC+0LTQsAogICAgICAgIGlmIGJhcmNvZGVbMF0gPT0gY2hyKDI5KSBhbmQgbGVuKGJhcmNvZGUpID4gMzE6ICAjIFJlbW92ZSBmaXJzdCBHUzEgY2hhciBmcm9tIGJhcmNvZGUKICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbMTpdCiAgICAgICAgYmFyY29kZV9pbmZvID0gdWlfYmFyY29kZXMucGFyc2VfYmFyY29kZShiYXJjb2RlKQogICAgICAgIGlmIGJhcmNvZGVfaW5mby5fX2NvbnRhaW5zX18oJ0VSUk9SJyk6CiAgICAgICAgICAgIHJldHVybiB7J0Vycm9yJzogJ0ludmFsaWQgQmFyY29kZScsICdEZXNjcic6ICfQndC10LLQtdGA0L3Ri9C5INGI0YLRgNC40YXQutC+0LQnLAogICAgICAgICAgICAgICAgICAgICdCYXJjb2RlJzogYmFyY29kZV9pbmZvLCAnZG9jX2luZm8nOiBzZWxmLmlkX2RvY30KICAgICAgICAjIC4uLiDQuCDQvdCw0LnQtNC10Lwg0L/QviDQvdC10LzRgyDQstGB0LUg0YfRgtC+INC10YHRgtGMINCyINCx0LDQt9C1CiAgICAgICAgc2hlbWEgPSBiYXJjb2RlX2luZm9bJ1NDSEVNRSddCiAgICAgICAgaWYgc2hlbWEgaW4gWydFQU4xMycsICdVTktOT1dOJ106CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mb1snQkFSQ09ERSddCiAgICAgICAgZWxpZiBzaGVtYSA9PSAnR1MxJzoKICAgICAgICAgICAgc2VhcmNoX3ZhbHVlID0gYmFyY29kZV9pbmZvWydHVElOJ10KICAgICAgICBlbHNlOiAgIyAqKioqKioqKioqKioqKioqKirQodGO0LTQsCDQvNC+0LbQvdC+INC00L7QsdCw0LLQuNGC0Ywg0L3QvtCy0YvQtSDQstC40LTRiyDRiNGC0YDQuNGF0LrQvtC00L7QsiAqKioqKioqKioqKioqKioqKioqKgogICAgICAgICAgICBzZWFyY2hfdmFsdWUgPSBiYXJjb2RlX2luZm9bJ0JBUkNPREUnXQoKICAgICAgICByZXMgPSBmaW5kX2JhcmNvZGVfaW5fYmFyY29kZV90YWJsZShzZWFyY2hfdmFsdWUpICAjINCY0YnQtdGCINCx0LDRgNC60L7QtCDQuNC70Lgg0JPQotCY0JjQnSDQv9C+INC+0LHRidC10Lkg0YLQsNCx0LvQuNGG0LUg0YjRgtGA0LjRhdC60L7QtNC+0LIuINCS0L7Qt9Cy0YDQsNGJ0LDQtdGCINGC0L7QstCw0YAsINC10LPQviDQstC40LQsINGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60YMg0YHQtdGA0LjRjiDQuNGC0L8uCiAgICAgICAgaWYgbm90IGxlbihyZXMpID09IDA6CiAgICAgICAgICAgIGVsZW0gPSByZXNbMF0gI9CR0LXRgNC10Lwg0L/QtdGA0LLRi9C5INGA0LXQt9GD0LvRjNGC0LDRgi4g0JIg0L/RgNCw0LLQuNC70YzQvdC+0Lwg0YHQv9C40YHQutC1INGI0YLRgNC40YXQutC+0LTQvtCyINC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQv9C+0LLRgtC+0YDQtdC90LjQuQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7J0Vycm9yJzogJ05vdEZvdW5kJywgJ0Rlc2NyJzogJ9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LHQsNC30LUnLCAnQmFyY29kZSc6IGJhcmNvZGV9CgogICAgICAgIHVzZV9tYXJrID0gZ2V0X2NvbnN0YW50cygndXNlX21hcmsnKSA9PSAndHJ1ZScgYW5kIGVsZW1bJ3VzZV9tYXJrJ10gPT0gMQoKICAgICAgICAjINCf0YDQvtCy0LXRgNGP0LXQvCDQvNCw0YDQutC40YDQvtCy0LrRgwogICAgICAgIGlmIHVzZV9tYXJrOgogICAgICAgICAgICBpZiBzaGVtYSA9PSAnR1MxJzoKICAgICAgICAgICAgICAgIGVsX21hcmtlZCA9IE5vbmUKICAgICAgICAgICAgICAgICMg0JjRgdC/0L7Qu9GM0LfRg9C10Lwg0LzQsNGA0LrQuNGA0L7QstC60YMg0Lgg0YLQvtCy0LDRgCDQvNCw0YDQutC40YDRg9C10YLRgdGPCiAgICAgICAgICAgICAgICAjINCd0LDRiNC70Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1IEdUSU4gKyDRgdC10YDQuNGPCiAgICAgICAgICAgICAgICByZXMgPSBmaW5kX2JhcmNvZGVfaW5fbWFya2luZ19jb2Rlc190YWJsZShzZWxmLCBiYXJjb2RlX2luZm8pCgogICAgICAgICAgICAgICAgaWYgcmVzOgogICAgICAgICAgICAgICAgICAgIGVsX21hcmtlZCA9IHJlc1swXSAj0JLRi9Cx0LjRgNCw0LXQvCDQv9C10YDQstGD0Y4g0YHRgtGA0L7QutGDINC40Lcg0YHQv9C40YHQutCwICjQtdGB0LvQuCDQsiDRgtCw0LHQu9C40YbQtSDRiNGC0YDQuNGF0LrQvtC00L7QsiDQv9C+0YDRj9C00L7Quiwg0LIg0YDQtdGBINCy0YHQtdCz0LTQsCDRgtC+0LvRjNC60L4g0L7QtNC90LAg0YHRgtGA0L7QutCwKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjINCd0LUg0L3QsNGI0LvQuCwg0L/RgNC+0LLQtdGA0Y/QtdC8INC10YHRgtGMINC70Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1INC/0LvQsNC9INC4INC60L7QvdGC0YDQvtC70YwKICAgICAgICAgICAgICAgICAgICBpZiBoYXZlX21hcmtfcGxhbiBhbmQgY29udHJvbDogI9CV0YHRgtGM0J/Qu9Cw0L3QmtCe0LTQvtCy0JzQsNGA0LrQuNGA0L7QstC60Lgg0Lgg0LrQvtC90YLRgNC+0LvRjAogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geydFcnJvcic6ICdOb3RGb3VuZCcsICdEZXNjcic6ICfQnNCw0YDQutCwINC90LUg0L3QsNC50LTQtdC90LAg0LIg0LTQvtC60YPQvNC10L3RgtC1JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQmFyY29kZSc6IGJhcmNvZGVfaW5mbywgJ2RvY19pbmZvJzogc2VsZi5pZF9kb2N9CgogICAgICAgICAgICAgICAgIyAqKioqKioqKioqKioKCiAgICAgICAgICAgICAgICBpZiBlbF9tYXJrZWQgYW5kIGVsX21hcmtlZFsnaWRfZ29vZCddOiAgIyDQvdCw0YjQu9C4INGB0YLRgNC+0LrRgyDQv9C+INC/0L7Qu9C90L7QvNGDINGB0L7QstC/0LDQtNC10L3QuNGOIEdUSU4g0Lgg0YHQtdGA0LjRjywg0YHRgdGL0LvQutCwINC90LAg0YLQvtCy0LDRgAoKICAgICAgICAgICAgICAgICAgICBpZiBlbF9tYXJrZWRbJ2FwcHJvdmVkJ10gPT0gJzEnOiAgIyDQotCw0LrQsNGPINC80LDRgNC60LAg0YPQttC1INCx0YvQu9CwINC+0YLRgdC60LDQvdC40YDQvtCy0LDQvdCwCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7J0Vycm9yJzogJ0FscmVhZHlTY2FubmVkJywgJ0Rlc2NyJzogJ9Ci0LDQutCw0Y8g0LzQsNGA0LrQsCDRg9C20LUg0LHRi9C70LAg0L7RgtGB0LrQsNC90LjRgNC+0LLQsNC90LAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdCYXJjb2RlJzogYmFyY29kZV9pbmZvLCAnZG9jX2luZm8nOiBlbF9tYXJrZWR9CgogICAgICAgICAgICAgICAgIyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIHsnRXJyb3InOiAnTm90VmFsaWRCYXJjb2RlJywKICAgICAgICAgICAgICAgICAgICAgICAgJ0Rlc2NyJzogJ9Ci0L7QstCw0YAg0L/QvtC00LvQtdC20LjRgiDQvNCw0YDQutC40YDQvtCy0LrQtSwg0LAg0L/QviDQvdC10LzRgyDQvtGC0YHQutCw0L3QuNGA0L7QstCw0L0g0L7QsdGL0YfQvdGL0Lkg0YjRgtGA0LjRhdC60L7QtCcsCiAgICAgICAgICAgICAgICAgICAgICAgICdCYXJjb2RlJzogYmFyY29kZX0KCiAgICAgICAgI9Ci0L7QstCw0YAg0LIg0YLQsNCx0LvQuNGG0LUg0LTQvtC60YPQvNC10L3RgtCwICjQotC+0LLQsNGAINC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUpCiAgICAgICAgcmVzID0gY2hlY2tfYmFyY29kZV9jb21wbGlhbmNlKGVsZW0sIHNlbGYuaWRfZG9jKSAgI9Cf0L7Qu9GD0YfQsNC10Lwg0YHRgtGA0L7QutGDINGC0LDQsdC70LjRhtGLINGC0L7QstCw0YDRiyDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBpZiByZXM6ICPQotC+0LLQsNGAINC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgICAgICAgICAgaWYgaGF2ZV9xdHR5X3BsYW46ICPQldGB0YLRjCDQv9C70LDQvSDQv9C+INC60L7Qu9C40YfQtdGB0YLQstGDCiAgICAgICAgICAgICAgICBpZiByZXNbMF1bJ3F0dHlfcGxhbiddIDw9IHJlc1swXVsncXR0eSddOiAj0JrQvtC70LjRh9C10YHRgtCy0L4g0YLQvtCy0LDRgNCwINCyINC00L7QutGD0LzQtdC90YLQtSDRg9C20LUg0L3QsNCx0YDQsNC90L4sINC4INC80Ysg0L/RgNC10LLRi9GI0LDQtdC8INC/0LvQsNC9CiAgICAgICAgICAgICAgICAgICAgaWYgY29udHJvbDoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsnUmVzdWx0JzogJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INC/0LvQsNC9INC/0YDQtdCy0YvRiNC10L3Qviwg0LHQvtC70YzRiNC1INGC0L7QstCw0YAg0LIg0LTQsNC90L3Ri9C5INC00L7QutGD0LzQtdC90YIg0LTQvtCx0LDQstC40YLRjCDQvdC10LvRjNC30Y8nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdFcnJvcic6ICdRdWFudGl0eVBsYW5SZWFjaGVkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZSc6IGJhcmNvZGUsICdEZXNjcic6ICfQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C70LDQvSDQv9GA0LXQstGL0YjQtdC90L4sINCx0L7Qu9GM0YjQtSDRgtC+0LLQsNGAINCyINC00LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCINC00L7QsdCw0LLQuNGC0Ywg0L3QtdC70YzQt9GPJ30KCiAgICAgICAgZWxzZTogI9Ci0L7QstCw0YAg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LTQvtC60YPQvNC10L3RgtC1CiAgICAgICAgICAgIGlmIGhhdmVfemVyb19wbGFuIGFuZCBjb250cm9sOgogICAgICAgICAgICAgICAgcmV0dXJuIHsnUmVzdWx0JzogJ9CSINC00LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCINC90LXQu9GM0LfRjyDQtNC+0LHQsNCy0LjRgtGMINGC0L7QstCw0YAg0L3QtSDQuNC3INGB0L/QuNGB0LrQsCcsCiAgICAgICAgICAgICAgICAgICAgICAgICdFcnJvcic6ICdaZXJvX3BsYW5fZXJyb3InLAogICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZSc6IGJhcmNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICdEZXNjcic6ICfQkiDQtNCw0L3QvdGL0Lkg0LTQvtC60YPQvNC10L3RgiDQvdC10LvRjNC30Y8g0LTQvtCx0LDQstC40YLRjCDRgtC+0LLQsNGAINC90LUg0LjQtyDRgdC/0LjRgdC60LAnfQoKCiAgICAgICAgIyDQkdC70L7QuiDQtNC+0LHQsNCy0LvQtdC90LjRjyDRgtC+0LLQsNGA0LAg0LIg0LTQvtC60YPQvNC10L3RggogICAgICAgIGlmIHVzZV9tYXJrOgogICAgICAgICAgICAjINCU0L7QsdCw0LLQu9GP0LXQvCDRgtC+0LLQsNGAINCyINGC0LDQsdC70LjRhtGDINC80LDRgNC60LjRgNC+0LLQutC4CiAgICAgICAgICAgIGlmIGVsX21hcmtlZCBhbmQgZWxfbWFya2VkWydpZF9nb29kJ106ICPQotC+0LLQsNGAINCx0YvQuyDQvdCw0LnQtNC10L0sINGC0L7Qu9GM0LrQviDQvtCx0L3QvtCy0LvRj9C10Lwg0YPQttC1INC90LDQudC00LXQvdC90YPRjiDRgdGC0YDQvtC60YMKICAgICAgICAgICAgICAgIHF1ZXJ5X3RleHQgPSAnVXBkYXRlICBSU19kb2NzX2JhcmNvZGVzIFNFVCBhcHByb3ZlZD0/LCBiYXJjb2RlX2Zyb21fc2Nhbm5lcj0/IFdoZXJlIGlkPT8nCiAgICAgICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsICgnMScsIGJhcmNvZGUsIGludChlbF9tYXJrZWRbJ2lkJ10pKSkKICAgICAgICAgICAgZWxzZTogI9CU0L7QsdCw0LLQu9GP0LXQvCDQvdC+0LLRg9GOINGB0YLRgNC+0LrRgyDQsiDRgtCw0LHQu9C40YbRgyDQsdCw0YDQutC+0LTQvtCyINC00L7QutGD0LzQtdC90YLQsAogICAgICAgICAgICAgICAgc2VsZi5hZGRfbmV3X2JhcmNvZGVfaW5fZG9jX2JhcmNvZGVzX3RhYmxlKHNlbGYsIGVsZW0gLCBiYXJjb2RlX2luZm8pCgoKICAgICAgICAjINCe0LHQvdC+0LLQu9GP0LXQvCDRgtCw0LHQu9C40YbRgyDRgtC+0LLQsNGA0YsKICAgICAgICBzZWxmLnVwZGF0ZV9kb2NfdGFibGVfZGF0YShzZWxmLCBlbGVtLCAxKQoKICAgICAgICByZXR1cm4geydSZXN1bHQnOiAn0JzQsNGA0LrQsCDQtNC+0LHQsNCy0LvQtdC90LAg0LIg0LTQvtC60YPQvNC10L3RgicsICdFcnJvcic6IE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXJjb2RlJzogYmFyY29kZV9pbmZvWydHVElOJ10gKyBiYXJjb2RlX2luZm9bJ1NFUklBTCddfQoKCiAgICBkZWYgYWRkKHNlbGYsIGFyZ3MpOgogICAgICAgIHF1ZXJ5ID0gJ0lOU0VSVCBJTlRPIFJTX2RvY3MoaWRfZG9jLCBkb2NfdHlwZSwgZG9jX24sIGRvY19kYXRlLCBpZF9jb3VudHJhZ2VudHMsIGlkX3dhcmVob3VzZSwgdmVyaWZpZWQsIHNlbnQpIFZBTFVFUyAoPyw/LD8sPyw/LD8sMCwwKScKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCBhcmdzKQoKICAgIGRlZiBnZXRfbmV3X2lkKHNlbGYpOgogICAgICAgIHF1ZXJ5ID0gJ3NlbGVjdCBtYXhfaWRfZG9jIGZyb20gUlNfY29uc3RhbnRzJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnkpCiAgICAgICAgaWYgbGVuKHJlcykgPT0gMDoKICAgICAgICAgICAgcmV0dXJuICcxJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHZhbCA9IHJlc1swXVswXQogICAgICAgICAgICBpZiB2YWwgaXMgTm9uZToKICAgICAgICAgICAgICAgIHJldHVybiAnMScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHF1ZXJ5ID0gJ1VQREFURSBSU19jb25zdGFudHMgU0VUIG1heF9pZF9kb2MgPSA/JwogICAgICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKGludCh2YWwpICsgMSwpKQogICAgICAgICAgICAgICAgcmV0dXJuIHN0cihpbnQodmFsKSArIDEpCgoKZGVmIGV4ZWN1dGVfcXVlcnkocV9pbmRleCwgcV90ZXh0LCBhcmdzLCBpbl9kaWN0KToKICAgIGlmIHF1ZXJ5X2xpc3QuZW1wdHkoKToKICAgICAgICBzdGFydF9xdWV1ZSA9VHJ1ZQogICAgcXVlcnlfbGlzdC5wdXQoeydxX2luZGV4JzpxX2luZGV4LCAncV90ZXh0JzpxX3RleHQsICdhcmdzJzphcmdzLCAnaW5fZGljdCc6aW5fZGljdH0pCiAgICB3aGlsZSBUcnVlOgogICAgICAgIGlmIHN0YXJ0X3F1ZXVlOgogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KCkKCgo="
            },
            {
                "PyFileKey": "ui_form_data",
                "PyFileData": "aW1wb3J0IGpzb24KCgpkZWYgZ2V0X2RvY19jYXJkKHNldHRpbmdzX2dsb2JhbCwgQWRkTWVudT0nJyk6CiAgICBkb2NfbGlzdCA9IHsiY3VzdG9tY2FyZHMiOiB7CiAgICAgICAgIm9wdGlvbnMiOiB7CiAgICAgICAgICAgICJzZWFyY2hfZW5hYmxlZCI6IFRydWUsCiAgICAgICAgICAgICJzYXZlX3Bvc2l0aW9uIjogVHJ1ZQogICAgICAgIH0sCiAgICAgICAgImxheW91dCI6IHsKICAgICAgICAgICAgIlZhbHVlIjogIiIsCiAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJDaGVja0JveCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGNvbXBsZXRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiQ2hlY2tCb3gxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIzMiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0RCNzA5MyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAyCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAdHlwZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoIlRpdGxlVGV4dFNpemUiKSAjIjE4IgogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJQb3B1cE1lbnVCdXR0b24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiBmItCj0LTQsNC70LjRgtGMO9Cf0L7QtNGC0LLQtdGA0LTQuNGC0Yw70J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwO9Ch0LrQsNC90LjRgNC+0LLQsNGC0Ywg0YjRgtGA0LjRhdC60L7QtNGLINC/0L7RgtC+0LrQvtC8e0FkZE1lbnV9IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIm1lbnVfZGVsZXRlIgoKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBudW1iZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKSAgIyIyMCIKICAgICAgICAgICAgICAgICAgICAgICAgfSMsCiAgICAgICAgICAgICAgICAgICAgICAgICMgewogICAgICAgICAgICAgICAgICAgICAgICAjICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICMgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIyAgICAgIndpZHRoIjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICMgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICMgICAgICJWYWx1ZSI6ICJAZGF0YSIsCiAgICAgICAgICAgICAgICAgICAgICAgICMgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAjICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdDYXJkRGF0ZVRleHRTaXplJykKICAgICAgICAgICAgICAgICAgICAgICAgIyB9CiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGNvdW50cmFnZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAd2FyZWhvdXNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICB9CiAgICB9fQoKICAgIHJldHVybiBkb2NfbGlzdAoKCmRlZiBnZXRfZG9jX3F1ZXJ5KGFyZz0nJyk6CiAgICBxdWVyeV90ZXh0ID0gIiIiCiAgICBTRUxFQ1QgUlNfZG9jcy5pZF9kb2MsCiAgICBSU19kb2NzLmRvY190eXBlLAogICAgUlNfZG9jcy5kb2NfbiwKICAgIFJTX2RvY3MuZG9jX2RhdGUsCiAgICBSU19kb2NzLmlkX2NvdW50cmFnZW50cywKICAgIFJTX2RvY3MuaWRfd2FyZWhvdXNlLAogICAgaWZudWxsKFJTX2NvdW50cmFnZW50cy5mdWxsX25hbWUsJycpIGFzIFJTX2NvdW50cmFnZW50LAogICAgaWZudWxsKFJTX3dhcmVob3VzZXMubmFtZSwnJykgYXMgUlNfd2FyZWhvdXNlLAogICAgUlNfZG9jcy52ZXJpZmllZCwKICAgIFJTX2RvY3Muc2VudCwKICAgIFJTX2RvY3MuYWRkX21hcmtfc2VsZWN0aW9uCgogICAgIEZST00gUlNfZG9jcwogICAgIExFRlQgSk9JTiBSU19jb3VudHJhZ2VudHMgYXMgUlNfY291bnRyYWdlbnRzCiAgICAgT04gUlNfY291bnRyYWdlbnRzLmlkID0gUlNfZG9jcy5pZF9jb3VudHJhZ2VudHMKICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBhcyBSU193YXJlaG91c2VzCiAgICAgT04gUlNfd2FyZWhvdXNlcy5pZD1SU19kb2NzLmlkX3dhcmVob3VzZQogICAgICIiIgogICAgaWYgbm90IChhcmcgPT0gJycgb3IgYXJnID09ICfQktGB0LUnKToKICAgICAgICBxdWVyeV90ZXh0ID0gcXVlcnlfdGV4dCArICcnJwogICAgICAgIFdoZXJlIFJTX2RvY3MuZG9jX3R5cGU9PycnJwoKICAgIHF1ZXJ5X3RleHQgPSBxdWVyeV90ZXh0ICsgIiIiCiAgICBPUkRFUgogICAgQlkKICAgIFJTX2RvY3MuZG9jX2RhdGUiIiIKICAgIHJldHVybiBxdWVyeV90ZXh0CgpkZWYgZ2V0X2Fkcl9kb2NfcXVlcnkoYXJnPScnKToKICAgIHF1ZXJ5X3RleHQgPSAiIiIKICAgIFNFTEVDVCBSU19hZHJfZG9jcy5pZF9kb2MsCiAgICBSU19hZHJfZG9jcy5kb2NfdHlwZSwKICAgIFJTX2Fkcl9kb2NzLmRvY19uLAogICAgUlNfYWRyX2RvY3MuZG9jX2RhdGUsCiAgICBSU19hZHJfZG9jcy5pZF93YXJlaG91c2UsCiAgICBpZm51bGwoUlNfd2FyZWhvdXNlcy5uYW1lLCcnKSBhcyBSU193YXJlaG91c2UsCiAgICBSU19hZHJfZG9jcy52ZXJpZmllZCwKICAgIFJTX2Fkcl9kb2NzLnNlbnQsCiAgICBSU19hZHJfZG9jcy5hZGRfbWFya19zZWxlY3Rpb24KCiAgICAgRlJPTSBSU19hZHJfZG9jcwoKICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBhcyBSU193YXJlaG91c2VzCiAgICAgT04gUlNfd2FyZWhvdXNlcy5pZD1SU19hZHJfZG9jcy5pZF93YXJlaG91c2UKICAgICAiIiIKICAgIGlmIG5vdCAoYXJnID09ICcnIG9yIGFyZyA9PSAn0JLRgdC1Jyk6CiAgICAgICAgcXVlcnlfdGV4dCA9IHF1ZXJ5X3RleHQgKyAnJycKICAgICAgICBXaGVyZSBSU19hZHJfZG9jcy5kb2NfdHlwZT0/JycnCgogICAgcXVlcnlfdGV4dCA9IHF1ZXJ5X3RleHQgKyAiIiIKICAgIE9SREVSCiAgICBCWQogICAgUlNfYWRyX2RvY3MuZG9jX2RhdGUiIiIKICAgIHJldHVybiBxdWVyeV90ZXh0CgpkZWYgZ2V0X2RvY190eXBlX3F1ZXJ5KCk6CiAgICBscyA9ICdTRUxFQ1QgRElTVElOQ1QgZG9jX3R5cGUgZnJvbSBSU19kb2NzJwogICAgcmV0dXJuIGxzCgoKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLdCi0L7QstCw0YDRiwpkZWYgZ2V0X2dvb2RzX2NhcmQoc2V0dGluZ3NfZ2xvYmFsKToKICAgIGxpc3QgPSB7ImN1c3RvbWNhcmRzIjogewogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgICAgICB9LAogICAgICAgICJsYXlvdXQiOiB7CiAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCgogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAbmFtZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBjb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnQ2FyZFRleHRTaXplJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBHVElOIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnQ2FyZFRleHRTaXplJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkB0eXBlX25hbWUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdDYXJkVGV4dFNpemUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHVuaXRfbmFtZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmRUZXh0U2l6ZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdCiAgICAgICAgfQoKICAgIH0KICAgIH0KICAgIHJldHVybiBsaXN0CgpkZWYgZmllbGRzX2FsaWFzX2RpY3QoKToKICAgICMgKCJUaXRsZVRleHRTaXplIiwgIjE4IiwgVHJ1ZSkKICAgICMgKCJ0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUiLCAiMTgiLCBUcnVlKQogICAgIyAoIkNhcmRUaXRsZVRleHRTaXplIiwgIjIwIiwgVHJ1ZSkKICAgICMgKCJDYXJkRGF0ZVRleHRTaXplIiwgIjEwIiwgVHJ1ZSkKICAgICMgKCJDYXJkVGV4dFNpemUiLCAiMTUiLCBUcnVlKQogICAgIyAoIkdvb2RzQ2FyZFRpdGxlVGV4dFNpemUiLCAiMTgiLCBUcnVlKQogICAgIyAoImdvb2RzVGV4dFNpemUiLCAiMTgiLCBUcnVlKQogICAgIyAoIlNlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSIsICIxNiIsIFRydWUpCiAgICAjICgiRG9jVHlwZUNhcmRUZXh0U2l6ZSIsICIxNSIsIFRydWUpCiAgICAKICAgIHJldHVybiB7CiAgICAgICAgJ2lkX2dvb2QnOnsnbmFtZSc6J9Cd0L7QvNC10L3QutC70LDRgtGD0YDQsCcsICd0ZXh0X3NpemUnOidUaXRsZVRleHRTaXplJywgIlRleHRCb2xkIjogVHJ1ZX0sCiAgICAgICAgJ3R5cGVfZ29vZCc6IHsnbmFtZSc6J9Ci0LjQvyDQvdC+0LzQtdC90LrQu9Cw0YLRg9GA0YsnLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICd1bml0Jzp7J25hbWUnOiAn0JXQtNC40L3QuNGG0LAg0LjQt9C80LXRgNC10L3QuNGPJywgJ3RleHRfc2l6ZSc6J0NhcmRUZXh0U2l6ZScsICJUZXh0Qm9sZCI6IEZhbHNlfSwKICAgICAgICAnaWRfcHJvcGVydHknOnsnbmFtZSc6ICfQpdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCwJywgJ3RleHRfc2l6ZSc6J0NhcmRUZXh0U2l6ZScsICJUZXh0Qm9sZCI6IEZhbHNlfSwKICAgICAgICAnaWRfc2VyaWVzJzogeyduYW1lJzon0KHQtdGA0LjRjycsICd0ZXh0X3NpemUnOidDYXJkVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBGYWxzZX0sCiAgICAgICAgJ2lkX3VuaXQnOnsnbmFtZSc6ICfQldC00LjQvdC40YbQsCDQuNC30LzQtdGA0LXQvdC40Y8nLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICdpZF9jb3VudHJhZ2VudHMnOnsnbmFtZSc6ICfQmtC+0L3RgtGA0LDQs9C10L3RgicsICd0ZXh0X3NpemUnOidDYXJkVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBGYWxzZX0sCiAgICAgICAgJ2lkX3dhcmVob3VzZSc6eyduYW1lJzogJ9Ch0LrQu9Cw0LQnLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICdpZF9kb2MnOnsnbmFtZSc6ICfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnLCAndGV4dF9zaXplJzonVGl0bGVUZXh0U2l6ZScsICJUZXh0Qm9sZCI6IFRydWV9LAogICAgICAgICdpZF9jZWxsJzp7J25hbWUnOiAn0K/Rh9C10LnQutCwJywgJ3RleHRfc2l6ZSc6J0NhcmRUZXh0U2l6ZScsICJUZXh0Qm9sZCI6IEZhbHNlfSwKICAgICAgICAnaWQnOnsnbmFtZSc6ICdrZXknLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICduYW1lJzp7J25hbWUnOiAn0J3QsNC40LzQtdC90L7QstCw0L3QuNC1JywgJ3RleHRfc2l6ZSc6J1RpdGxlVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBUcnVlfSwKICAgICAgICAnY29kZSc6eyduYW1lJzogJ9Ca0L7QtCcsICd0ZXh0X3NpemUnOidDYXJkVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBGYWxzZX0sCiAgICAgICAgJ2FydCc6eyduYW1lJzogJ9CQ0YDRgtC40LrRg9C7JywgJ3RleHRfc2l6ZSc6J0NhcmRUZXh0U2l6ZScsICJUZXh0Qm9sZCI6IEZhbHNlfSwKICAgICAgICAnZGVzY3JpcHRpb24nOnsnbmFtZSc6ICfQntC/0LjRgdCw0L3QuNC1JywgJ3RleHRfc2l6ZSc6J0NhcmREYXRlVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBGYWxzZX0sCiAgICAgICAgJ3F0dHknOnsnbmFtZSc6ICfQmtC+0LvQuNGH0LXRgdGC0LLQvicsICd0ZXh0X3NpemUnOidDYXJkVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBUcnVlfSwKICAgICAgICAncXR0eV9wbGFuJzp7J25hbWUnOiAn0JrQvtC70LjRh9C10YHRgtCy0L4g0L/Qu9Cw0L0nLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogVHJ1ZX0sCiAgICAgICAgJ2JhcmNvZGUnOnsnbmFtZSc6ICfQqNGC0YDQuNGF0LrQvtC0JywgJ3RleHRfc2l6ZSc6J0NhcmRUZXh0U2l6ZScsICJUZXh0Qm9sZCI6IEZhbHNlfSwKICAgICAgICAnZnVsbF9uYW1lJzp7J25hbWUnOiAn0J/QvtC70L3QvtC1INC90LDQuNC80LXQvdC+0LLQsNC90LjQtScsICd0ZXh0X3NpemUnOidDYXJkVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBGYWxzZX0sCiAgICAgICAgJ2lubic6eyduYW1lJzogJ9CY0J3QnScsICd0ZXh0X3NpemUnOidUaXRsZVRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICdrcHAnOnsnbmFtZSc6ICfQmtCf0J8nLCAndGV4dF9zaXplJzonVGl0bGVUZXh0U2l6ZScsICJUZXh0Qm9sZCI6IEZhbHNlfSwKICAgICAgICAnbWFya19jb2RlJzp7J25hbWUnOiAn0KjRgtGA0LjRhdC60L7QtCcsICd0ZXh0X3NpemUnOidDYXJkVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBGYWxzZX0sCiAgICAgICAgJ2lkX3ByaWNlX3R5cGVzJzp7J25hbWUnOiAn0KLQuNC/INGG0LXQvdGLJywgJ3RleHRfc2l6ZSc6J1RpdGxlVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBGYWxzZX0sCiAgICAgICAgJ3ByaWNlJzp7J25hbWUnOiAn0KbQtdC90LAnLCAndGV4dF9zaXplJzonVGl0bGVUZXh0U2l6ZScsICJUZXh0Qm9sZCI6IFRydWV9LAogICAgICAgICdpZF9vd25lcic6eyduYW1lJzogJ9CS0LvQsNC00LXQu9C10YYnLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICdiZXN0X2JlZm9yZSc6eyduYW1lJzogJ9CT0L7QtNC10L0g0LTQvjonLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICdudW1iZXInOnsnbmFtZSc6J9Cd0L7QvNC10YAnLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICdwcm9kdWN0aW9uX2RhdGUnOnsnbmFtZSc6J9CU0LDRgtCwINC/0YDQvtC40LfQstC+0LTRgdGC0LLQsCcsICd0ZXh0X3NpemUnOidDYXJkVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBGYWxzZX0sCiAgICAgICAgJ3VzZV9tYXJrJzp7J25hbWUnOifQmNGB0L/QvtC70YzQt9C+0LLQsNGC0Ywg0LzQsNGA0LrQuNGA0L7QstC60YMnLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogRmFsc2V9LAogICAgICAgICdub21pbmF0b3InOnsnbmFtZSc6J9Cd0L7QvNC40L3QsNGC0L7RgCcsICd0ZXh0X3NpemUnOidDYXJkVGV4dFNpemUnLCAiVGV4dEJvbGQiOiBUcnVlfSwKICAgICAgICAnZGVub21pbmF0b3InOnsnbmFtZSc6J9CU0LXQvdC+0LzQuNC90LDRgtC+0YAnLCAndGV4dF9zaXplJzonQ2FyZFRleHRTaXplJywgIlRleHRCb2xkIjogVHJ1ZX0KICAgICAgICB9CgoKZGVmIHRhYmxlX25hbWVzX2RpY3QoKToKICAgIHJldHVybiB7CiAgICAgICAgJ2lkX2dvb2QnOidSU19nb29kcycsCiAgICAgICAgJ3R5cGVfZ29vZCc6ICdSU190eXBlc19nb29kcycsCiAgICAgICAgJ3VuaXQnOiAnUlNfdW5pdHMnLAogICAgICAgICdpZF9wcm9wZXJ0eSc6ICdSU19wcm9wZXJ0aWVzJywKICAgICAgICAnaWRfc2VyaWVzJzogJ1JTX3NlcmllcycsCiAgICAgICAgJ2lkX3VuaXQnOiAnUlNfdW5pdHMnLAogICAgICAgICdpZF9jb3VudHJhZ2VudHMnOiAnUlNfY291bnRyYWdlbnRzJywKICAgICAgICAnaWRfd2FyZWhvdXNlJzogJ1JTX3dhcmVob3VzZXMnLAogICAgICAgICdpZF9kb2MnOiAnUlNfZG9jcycsCiAgICAgICAgJ2lkX2NlbGwnOiAnUlNfY2VsbHMnLAogICAgICAgICdpZF9vd25lcic6ICdSU19nb29kcycsCiAgICAgICAgJ2lkX3ByaWNlX3R5cGVzJzogJ1JTX3ByaWNlX3R5cGVzJwogICAgICAgICAgICB9CmRlZiBnZXRfZWxlbV9kaWN0KHRleHRfc2l6ZSk6CiAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQG5hbWUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiB0ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgpkZWYgZ2V0X3VuaXZlcnNhbF9jYXJkKCkgLT4gb2JqZWN0OgoKICAgIGxpc3QgPSB7ImN1c3RvbWNhcmRzIjogewogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAnb3ZlcnJpZGVfc2VhcmNoJzogVHJ1ZSwKICAgICAgICAgICAgInNhdmVfcG9zaXRpb24iOiBUcnVlCiAgICAgICAgfSwKICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjAiLAoKICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0KCiAgICB9CiAgICB9CgoKICAgIHJldHVybiBsaXN0CgoKZGVmIGdldF9nb29kc19xdWVyeSgpOgogICAgcXVlcnlfdGV4dCA9ICIiIgogICAgU0VMRUNUIFJTX2dvb2RzLmlkLAogICAgUlNfZ29vZHMuY29kZSwKICAgIFJTX2dvb2RzLmFydCwKICAgIFJTX2dvb2RzLm5hbWUsCiAgICBSU19nb29kcy50eXBlX2dvb2QsCiAgICBSU190eXBlc19nb29kcy5uYW1lIEFTIHR5cGVzX2dvb2RzLAogICAgUlNfZ29vZHMudW5pdCwKICAgIFJTX3VuaXRzLm5hbWUKICAgIEZST00gUlNfZ29vZHMKICAgIExFRlQgSk9JTiBSU190eXBlc19nb29kcwogICAgT04gUlNfdHlwZXNfZ29vZHMuaWQgPSBSU19nb29kcy50eXBlX2dvb2QKICAgIExFRlQgSk9JTiBSU191bml0cwogICAgT04gUlNfdW5pdHMuaWRfb3duZXIgPSBSU19nb29kcy5pZCIiIgogICAgcmV0dXJuIHF1ZXJ5X3RleHQKCgpkZWYgZ2V0X3ByaWNlX2NhcmQoc2V0dGluZ3NfZ2xvYmFsKToKICAgIHR4dCA9IHsiY3VzdG9tY2FyZHMiOiB7CiAgICAgICAgIm9wdGlvbnMiOiB7CiAgICAgICAgICAgICJzZWFyY2hfZW5hYmxlZCI6IEZhbHNlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgICAgICB9LAogICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAiVmFsdWUiOiAiIiwKICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIyIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBwcmljZV90eXBlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHByaWNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmRUZXh0U2l6ZScpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgXQogICAgfQogICAgfQogICAgcmV0dXJuIHR4dAoKCmRlZiBnZXRfZG9jX2RldGFpbHNfcXVlcnkoaXNBZHIgPSBGYWxzZSwgY3VyQ2VsbCA9IEZhbHNlKToKICAgIGlmIGlzQWRyOgogICAgICAgIHF1ZXJ5X3RleHQgPSAnJycKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5pZF9kb2MsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkX2dvb2QsCiAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUgYXMgZ29vZF9uYW1lLAogICAgICAgICAgICBSU19nb29kcy5jb2RlLAogICAgICAgICAgICBSU19nb29kcy5hcnQsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3NlcmllcywKICAgICAgICAgICAgUlNfc2VyaWVzLm5hbWUgYXMgc2VyaWVzX25hbWUsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3VuaXQsCiAgICAgICAgICAgIFJTX3VuaXRzLm5hbWUgYXMgdW5pdHNfbmFtZSwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUucXR0eSwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUucXR0eV9wbGFuLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5xdHR5X3BsYW4gLSBSU19hZHJfZG9jc190YWJsZS5xdHR5IGFzIElzRG9uZSwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUuaWRfY2VsbCBhcyBpZF9jZWxsLAogICAgICAgICAgICBSU19jZWxscy5uYW1lIGFzIGNlbGxfbmFtZQogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfYWRyX2RvY3NfdGFibGUgCgogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICAgICAgICAgIE9OIFJTX2dvb2RzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX2dvb2QKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3NlcmllcwogICAgICAgICAgICBPTiBSU19zZXJpZXMuaWQgPSBSU19hZHJfZG9jc190YWJsZS5pZF9zZXJpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX3VuaXQKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2NlbGxzCiAgICAgICAgICAgIE9OIFJTX2NlbGxzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX2NlbGwKCiAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8gYW5kIHRhYmxlX3R5cGUgPSA/CiAgICAgICAgICAgICcnJwoKICAgICAgICBpZiBjdXJDZWxsOgogICAgICAgICAgICBxdWVyeV90ZXh0ID0gcXVlcnlfdGV4dCArICcnJwogICAgICAgICAgICAgYW5kIChpZF9jZWxsPT8gT1IgaWRfY2VsbD0iIiBPUiBpZF9jZWxsIGlzIE51bGwpCiAgICAgICAgICAgICcnJwoKICAgICAgICBxdWVyeV90ZXh0ID0gcXVlcnlfdGV4dCArICcgT1JERVIgQlkgUlNfY2VsbHMubmFtZSwgUlNfYWRyX2RvY3NfdGFibGUubGFzdF91cGRhdGVkIERFU0MnCgogICAgZWxzZToKICAgICAgICBxdWVyeV90ZXh0ID0gIiIiCiAgICAgICAgU0VMRUNUCiAgICAgICAgUlNfZG9jc190YWJsZS5pZCwKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QsCiAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBnb29kX25hbWUsCiAgICAgICAgUlNfZ29vZHMuY29kZSwKICAgICAgICBSU19nb29kcy5hcnQsCiAgICAgICAgUlNfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzLAogICAgICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgUlNfZG9jc190YWJsZS5pZF9zZXJpZXMsCiAgICAgICAgUlNfc2VyaWVzLm5hbWUgYXMgc2VyaWVzX25hbWUsCiAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0LAogICAgICAgIFJTX3VuaXRzLm5hbWUgYXMgdW5pdHNfbmFtZSwKICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHksCiAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5X3BsYW4sCiAgICAgICAgUlNfZG9jc190YWJsZS5wcmljZSwKICAgICAgICBSU19wcmljZV90eXBlcy5uYW1lIGFzIHByaWNlX25hbWUsCiAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5X3BsYW4gLSBSU19kb2NzX3RhYmxlLnF0dHkgYXMgSXNEb25lCiAgICAgICAgRlJPTSBSU19kb2NzX3RhYmxlIAogICAgCiAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzIAogICAgICAgIE9OIFJTX2dvb2RzLmlkPVJTX2RvY3NfdGFibGUuaWRfZ29vZAogICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzCiAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcwogICAgICAgIExFRlQgSk9JTiBSU19zZXJpZXMKICAgICAgICBPTiBSU19zZXJpZXMuaWQgPSBSU19kb2NzX3RhYmxlLmlkX3NlcmllcwogICAgICAgIExFRlQgSk9JTiBSU191bml0cwogICAgICAgIE9OIFJTX3VuaXRzLmlkPVJTX2RvY3NfdGFibGUuaWRfdW5pdAogICAgICAgIExFRlQgSk9JTiBSU19wcmljZV90eXBlcwogICAgICAgIE9OIFJTX3ByaWNlX3R5cGVzLmlkID0gUlNfZG9jc190YWJsZS5pZF9wcmljZQogICAgICAgIFdIRVJFIGlkX2RvYyA9ICRhcmcxCiAgICAgICAgT1JERVIgQlkgUlNfZG9jc190YWJsZS5sYXN0X3VwZGF0ZWQgREVTQyAKICAgICAgICAiIiIKCiAgICByZXR1cm4gcXVlcnlfdGV4dAoKCgoKZGVmIGdldF9kb2NfZGV0YWlsX2NhcmRzKHVzZV9zZXJpZXMsIHVzZV9wcm9wZXJ0aWVzLCBzZXR0aW5nc19nbG9iYWwsIGlzQWRyID0gRmFsc2UpOgogICAgY2VsbE1lbnVDb21tYW5kID0gJzvQmNC30LzQtdC90LjRgtGMINGP0YfQtdC50LrRgycgaWYgaXNBZHIgZWxzZSAnJwogICAgbGlzdCA9IHsKICAgICAgICAiY3VzdG9tY2FyZHMiOiB7CiAgICAgICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAgICAgInNlYXJjaF9lbmFibGVkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICJzYXZlX3Bvc2l0aW9uIjogVHJ1ZQogICAgICAgICAgICB9LAogICAgICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAZ29vZF9uYW1lIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcGljdHVyZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIyNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiI0RCNzA5MyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0ZGRkZGRiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAiMjUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlBvcHVwTWVudUJ1dHRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiBmItCj0LTQsNC70LjRgtGMINGB0YLRgNC+0LrRg3tjZWxsTWVudUNvbW1hbmR9IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAibWVudV9nb29kX3N0cmluZyIKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGNvZGVfYXJ0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ2dvb2RzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkB1bml0X25hbWUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImdvcml6b250YWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAi0J/Qu9Cw0L0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ2dvb2RzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHF0dHlfcGxhbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICLQpNCw0LrRgiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcXR0eSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICLQptC10L3QsCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcHJpY2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ2dvb2RzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgaWYgdXNlX3NlcmllcyA9PSAndHJ1ZScgb3IgdXNlX3NlcmllcyA9PSAnMSc6CiAgICAgICAgbGlzdFsnY3VzdG9tY2FyZHMnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ10uaW5zZXJ0KDEsIHsndHlwZSc6ICdUZXh0VmlldycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnKSwgIzE2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2hvd19ieV9jb25kaXRpb24nOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdWYWx1ZSc6ICdAc2VyaWVzX25hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05vUmVmcmVzaCc6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RvY3VtZW50X3R5cGUnOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYXNrJzogJycsICdWYXJpYWJsZSc6ICcnfSkKICAgIGlmIHVzZV9wcm9wZXJ0aWVzID09ICd0cnVlJyBvciB1c2VfcHJvcGVydGllcyA9PSAnMSc6CiAgICAgICAgbGlzdFsnY3VzdG9tY2FyZHMnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ10uaW5zZXJ0KDEsIHsndHlwZSc6ICdUZXh0VmlldycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnKSwgIycxNicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2hvd19ieV9jb25kaXRpb24nOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdWYWx1ZSc6ICdAcHJvcGVydGllc19uYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdOb1JlZnJlc2gnOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkb2N1bWVudF90eXBlJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWFzayc6ICcnLCAnVmFyaWFibGUnOiAnJ30pCiAgICBpZiBpc0FkcjoKICAgICAgICBsaXN0WydjdXN0b21jYXJkcyddWydsYXlvdXQnXVsnRWxlbWVudHMnXVswXVsnRWxlbWVudHMnXVswXVsnRWxlbWVudHMnXS5pbnNlcnQoMSwgeyd0eXBlJzogJ1RleHRWaWV3JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAnMTYnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Nob3dfYnlfY29uZGl0aW9uJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVmFsdWUnOiAnQGNlbGxfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTm9SZWZyZXNoJzogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZG9jdW1lbnRfdHlwZSc6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hc2snOiAnJywgJ1ZhcmlhYmxlJzogJyd9KQoKICAgICAgICBwYXNzCgogICAgcmV0dXJuIGxpc3QKCgpkZWYgZ2V0X2RvY19iYXJjX2Zsb3dfcXVlcnkoKToKICAgIHJldHVybiAnJycKICAgIFNlbGVjdCAqIGZyb20gUlNfYmFyY19mbG93IFdIZXJlIGlkX2RvYyA9PwogICAgJycnCgpkZWYgZG9jX2JhcmNfZmxvd19jYXJkKHNldHRpbmdzX2dsb2JhbCk6CiAgICBsaXN0ID0gewogICAgICAgICJjdXN0b21jYXJkcyI6IHsKICAgICAgICAgICAgIm9wdGlvbnMiOiB7CiAgICAgICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAgICAgInNhdmVfcG9zaXRpb24iOiBUcnVlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJsYXlvdXQiOiB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAYmFyY29kZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKCiAgICByZXR1cm4gbGlzdAoKZGVmIGdldF9wcmljZV9xdWVyeSgpOgogICAgdHh0ID0gIiIiCiAgICBTRUxFQ1QgKiwKICAgIFJTX3ByaWNlX3R5cGVzLm5hbWUKICAgICBmcm9tIFJTX3ByaWNlcyAKICAgICBMRUZUIEpPSU4gUlNfcHJpY2VfdHlwZXMgT04gUlNfcHJpY2VfdHlwZXMuaWQ9UlNfcHJpY2VzLmlkX3ByaWNlX3R5cGVzCiAgICAgd2hlcmUgaWRfZ29vZHM9PyIiIgogICAgcmV0dXJuIHR4dAoKCiMg0KHQvtCy0YDQtdC80LXQvdC90L7QtSDQv9C+0LvQtSDQstCy0L7QtNCwLCDQvdC1INC40YHQv9C+0LvRjNC30YPQtdGC0YHRjwpkZWYgZ2V0X251bV9maWVsZF9kZXNjcihxdHR5KToKICAgIGpzb25fZGVzY3IgPSB7CiAgICAgICAgImhpbnQiOiAn0LrQvtC70LjRh9C10YHRgtCy0L4nLAogICAgICAgICJkZWZhdWx0X3RleHQiOiBxdHR5LAogICAgICAgICdpbnB1dFR5cGUgJzogJ1RZUEVfQ0xBU1NfTlVNQkVSJwogICAgfQogICAgcmV0dXJuIGpzb25fZGVzY3IKCgojIGRlZiBnZXRfYmFyY29kZV9xdWVyeSgpOgojICAgICBxdWVyeV90ZXh0ID0gJ1NFTEVDVCAqIEZST00gUlNfZG9jc19iYXJjb2RlcyBXaGVyZSBSU19kb2NzX2JhcmNvZGVzLmlkX2RvYyA9ID8nCiMgICAgIHJldHVybiBxdWVyeV90ZXh0CgoKIyDQl9Cw0L/RgNC+0YEg0L3QsNGF0L7QtNC40YIg0LLRgdC1INC30LDQv9C40YHQuCDRgtCw0LHQu9C40YbRiyDQtNC+0LrRg9C80LXQvdGC0LAgUlNfZG9jc19iYXJjb2RlcyDQv9C+INC/0L7Qu9C90L7QvNGDINGB0L7QstC/0LDQtNC10L3QuNGOINGI0YLRgNC40YXQutC+0LTQsCDQuNC70Lgg0YLQvtC70YzQutC+INC/0L4gR1RJTgpkZWYgZ2V0X3F1ZXJ5X21hcmtfZmluZF9pbl9kb2MoKToKICAgIHF1ZXJ5ID0gJycnCiAgICBTRUxFQ1QgCiAgICBpZCwKICAgIGlkX2RvYywKICAgIElGTlVMTChHVElOLCAnMCcpIEFTIEdUSU4sCiAgICBJRk5VTEwoU2VyaWVzLCAnMCcpIEFTIFNlcmllcywKICAgIElGTlVMTChpZF9nb29kLCAnJykgQVMgaWRfZ29vZCwKICAgIElGTlVMTChpZF9wcm9wZXJ0eSwgJycpIEFTIGlkX3Byb3BlcnR5ICwKICAgIElGTlVMTChpZF9zZXJpZXMsICcnKSBBUyBpZF9zZXJpZXMsCiAgICBJRk5VTEwoaWRfdW5pdCwgJycpICBBUyBpZF91bml0LAogICAgaXNfcGxhbiwKICAgIGFwcHJvdmVkCgogICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzCgogICAgV0hFUkUgaWRfZG9jID0gOmlkX2RvYyAgYW5kIEdUSU4gPSA6R1RJTiBBbmQgU2VyaWVzID0gOlNlcmllcycnJwoKICAgICMKICAgICMKICAgICMgICAgICcnJwogICAgIyBTRUxFQ1QgKiBGUk9NICgKICAgICMKICAgICMgU0VMRUNUCiAgICAjIFJTX2RvY3NfYmFyY29kZXMuaWQsCiAgICAjIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jLAogICAgIwogICAgIyBSU19kb2NzX2JhcmNvZGVzLmlkX2JhcmNvZGUsCiAgICAjCiAgICAjIElGTlVMTChSU19tYXJraW5nX2NvZGVzLm1hcmtfY29kZSwgJzAnKSBBUyBtYXJrX2NvZGUsCiAgICAjIElGTlVMTChSU19tYXJraW5nX2NvZGVzLmlkX2dvb2QsICcnKSBBUyBpZF9nb29kLAogICAgIyBJRk5VTEwoUlNfbWFya2luZ19jb2Rlcy5pZF9wcm9wZXJ0eSwgJycpIEFTIGlkX3Byb3BlcnR5ICwKICAgICMgSUZOVUxMKFJTX21hcmtpbmdfY29kZXMuaWRfc2VyaWVzLCAnJykgQVMgaWRfc2VyaWVzLAogICAgIyBJRk5VTEwoUlNfbWFya2luZ19jb2Rlcy5pZF91bml0LCAnJykgIEFTIGlkX3VuaXQsCiAgICAjCiAgICAjIFJTX2RvY3NfYmFyY29kZXMuaXNfcGxhbiwKICAgICMgUlNfZG9jc19iYXJjb2Rlcy5hcHByb3ZlZAogICAgIwogICAgIyBGUk9NIFJTX2RvY3NfYmFyY29kZXMKICAgICMKICAgICMgICAgIExFRlQgSk9JTiBSU19tYXJraW5nX2NvZGVzIEFzIFJTX21hcmtpbmdfY29kZXMKICAgICMgICAgIE9OIFJTX21hcmtpbmdfY29kZXMuaWQgPSBSU19kb2NzX2JhcmNvZGVzLmlkX2JhcmNvZGUKICAgICMKICAgICMgV0hFUkUgaWRfZG9jID0gOmlkX2RvYyAgYW5kIFJTX21hcmtpbmdfY29kZXMubWFya19jb2RlID0gOnNldF9iYXJjb2RlKQogICAgIyAnJycKICAgICMKICAgICMgU0VMRUNUICogRlJPTSAoCiAgICAjICAgICBTRUxFQ1QKICAgICMgICAgICdvbl9HVElOJyBhcyBUeXBlT2ZVbmlvbiwKICAgICMgICAgIFJTX2RvY3NfYmFyY29kZXMuaWQsCiAgICAjICAgICBSU19kb2NzX2JhcmNvZGVzLmlkX2RvYywKICAgICMgICAgIFJTX2RvY3NfYmFyY29kZXMuYmFyY29kZSwKICAgICMgICAgIFJTX2RvY3NfYmFyY29kZXMuaWRfYmFyY29kZSwKICAgICMgICAgIFJTX2JhcmNvZGVzLkdUSU4sCiAgICAjICAgICBSU19iYXJjb2Rlcy5pZF9nb29kLAogICAgIyAgICAgUlNfYmFyY29kZXMuaWRfcHJvcGVydHksCiAgICAjICAgICBSU19iYXJjb2Rlcy5pZF9zZXJpZXMsCiAgICAjICAgICBSU19iYXJjb2Rlcy5pZF91bml0LAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5pc19wbGFuLAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5hcHByb3ZlZAogICAgIyAgICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzCiAgICAjICAgICAgICAgTEVGVCBKT0lOIChTZWxlY3QgUlNfYmFyY29kZXMuYmFyY29kZSBhcyBHVElOLAogICAgIyAgICAgICAgIFJTX2JhcmNvZGVzLmlkX2dvb2QsCiAgICAjICAgICAgICAgUlNfYmFyY29kZXMuaWRfcHJvcGVydHksCiAgICAjICAgICAgICAgUlNfYmFyY29kZXMuaWRfc2VyaWVzLAogICAgIyAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3VuaXQgRlJPTSBSU19iYXJjb2RlcwogICAgIyAgICAgICAgIFdIRVJFIFJTX2JhcmNvZGVzLmJhcmNvZGU9Omd0aW4gTElNSVQgMSkgQVMgUlNfYmFyY29kZXMKICAgICMgICAgICAgICBPTiBUUlVFCiAgICAjICAgICAgICAgTEVGVCBKT0lOIFJTX2JhcmNvZGVzIGFzIEZ1bGxCYXJjb2RlCiAgICAjICAgICAgICAgT04gRnVsbEJhcmNvZGUuYmFyY29kZSA9IFJTX2RvY3NfYmFyY29kZXMuYmFyY29kZQogICAgIwogICAgIyAgICAgV0hFUkUgaWRfZG9jID0gOmlkX2RvYyAgYW5kIFJTX2RvY3NfYmFyY29kZXMuYmFyY29kZSBMaWtlICclJys6Z3RpbiArICclJwogICAgIwogICAgIyAgICAgVU5JT04gQUxMCiAgICAjCiAgICAjICAgICBTRUxFQ1QKICAgICMgICAgICdGdWxsTWF0Y2gnLAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5pZCwKICAgICMgICAgIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jLAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5iYXJjb2RlLAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5pZF9iYXJjb2RlLAogICAgIyAgICAgSUZOVUxMKFJTX2JhcmNvZGVzLmJhcmNvZGUsUlNfYmFyY29kZXNfaW5hY2N1cmF0ZS5HVElOKSwKICAgICMgICAgIElGTlVMTChSU19iYXJjb2Rlcy5pZF9nb29kLFJTX2JhcmNvZGVzX2luYWNjdXJhdGUuaWRfZ29vZCksCiAgICAjICAgICBJRk5VTEwoUlNfYmFyY29kZXMuaWRfcHJvcGVydHksUlNfYmFyY29kZXNfaW5hY2N1cmF0ZS5pZF9wcm9wZXJ0eSksCiAgICAjICAgICBJRk5VTEwoUlNfYmFyY29kZXMuaWRfc2VyaWVzLFJTX2JhcmNvZGVzX2luYWNjdXJhdGUuaWRfc2VyaWVzKSwKICAgICMgICAgIElGTlVMTChSU19iYXJjb2Rlcy5pZF91bml0LFJTX2JhcmNvZGVzX2luYWNjdXJhdGUuaWRfdW5pdCksCiAgICAjICAgICBSU19kb2NzX2JhcmNvZGVzLmlzX3BsYW4sCiAgICAjICAgICBSU19kb2NzX2JhcmNvZGVzLmFwcHJvdmVkCiAgICAjICAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMKICAgICMgICAgICAgICBMRUZUIEpPSU4gUlNfYmFyY29kZXMKICAgICMgICAgICAgICBPTiBSU19iYXJjb2Rlcy5iYXJjb2RlID0gUlNfZG9jc19iYXJjb2Rlcy5iYXJjb2RlCiAgICAjICAgICAgICAgTEVGVCBKT0lOIChTZWxlY3QgUlNfYmFyY29kZXMuYmFyY29kZSBhcyBHVElOLAogICAgIyAgICAgICAgIFJTX2JhcmNvZGVzLmlkX2dvb2QsCiAgICAjICAgICAgICAgUlNfYmFyY29kZXMuaWRfcHJvcGVydHksCiAgICAjICAgICAgICAgUlNfYmFyY29kZXMuaWRfc2VyaWVzLAogICAgIyAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3VuaXQgRlJPTSBSU19iYXJjb2RlcwogICAgIyAgICAgICAgIFdIRVJFIFJTX2JhcmNvZGVzLmJhcmNvZGUgTGlrZSAnJScrOmd0aW4gKyAnJScgTElNSVQgMSkgQVMgUlNfYmFyY29kZXNfaW5hY2N1cmF0ZQogICAgIyAgICAgICAgIE9OIFRSVUUKICAgICMgICAgICAgICBMRUZUIEpPSU4gUlNfYmFyY29kZXMgYXMgRnVsbEJhcmNvZGUKICAgICMgICAgICAgICBPTiBGdWxsQmFyY29kZS5iYXJjb2RlID0gUlNfZG9jc19iYXJjb2Rlcy5iYXJjb2RlCiAgICAjCiAgICAjICAgICBXSEVSRSBpZF9kb2MgPSA6aWRfZG9jICBhbmQgUlNfZG9jc19iYXJjb2Rlcy5iYXJjb2RlID0gOnNldF9iYXJjb2RlKQogICAgIwogICAgIyBPUkRFUiAgQlkgVHlwZU9mVW5pb24KICAgICMgJycnCiAgICByZXR1cm4gcXVlcnkKCgpkZWYgZ2V0X2JhcmNvZGVfY2FyZChzZXR0aW5nc19nbG9iYWwpOgogICAgbHMgPSB7ImN1c3RvbWNhcmRzIjogewogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBGYWxzZSwKICAgICAgICAgICAgInNhdmVfcG9zaXRpb24iOiBUcnVlCiAgICAgICAgfSwKICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICB7InR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBiYXJjb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ2dvb2RzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcGljdHVyZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiNEQjcwOTMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRkZGRkZGIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICJidG5fdHN0MSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcmRDb3JuZXJSYWRpdXMiOiAiMTVkcCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIgogICAgICAgICAgICAgICAgICAgICAgICB9XX0KCiAgICAgICAgICAgIF0KICAgICAgICB9fQogICAgfQogICAgcmV0dXJuIGxzCgoKZGVmIGdldF9kb2NfYmFyY29kZV9xdWVyeSgpOgogICAgbHMgPSAnJycKICAgIFNFTEVDVAogICAgIigwMSkiIHx8IEdUSU4gfHwgIigyMSkiIHx8IFNlcmllcyBhcyBtYXJrX2NvZGUsCiAgICBhcHByb3ZlZAogICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzCiAgICBXaGVyZQogICAgaWRfZG9jID0gOmlkX2RvYyBBTkQKICAgIGlkX2dvb2QgPSA6aWRfZ29vZCBBTkQKICAgIGlkX3Byb3BlcnR5ID0gOmlkX3Byb3BlcnR5IEFORAogICAgaWRfc2VyaWVzID0gOmlkX3NlcmllcyAKICAgIC0tQU5EICBpZF91bml0ID0gOmlkX3VuaXQKICcnJwogICAgcmV0dXJuIGxzCgoKZGVmIGdldF9kb2NfYmFyY29kZV9xdWVyeV9ub19SU19tYXJrY29kZXMoKToKICAgIHJldHVybiAnJycKICAgIFNFTEVDVCAKICAgIGlkX2JhcmNvZGUsCiAgICBSU19tYXJraW5nX2NvZGVzLm1hcmtfY29kZSBhcyBtYXJrX2NvZGUsCiAgICBhcHByb3ZlZAogICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzCgogICAgSk9JTiBSU19tYXJraW5nX2NvZGVzIAogICAgT04gUlNfbWFya2luZ19jb2Rlcy5pZCA9IFJTX2RvY3NfYmFyY29kZXMuaWRfYmFyY29kZSBBTkQKICAgIFJTX21hcmtpbmdfY29kZXMuaWRfZ29vZCA9IDppZF9nb29kIEFORAogICAgUlNfbWFya2luZ19jb2Rlcy5pZF9wcm9wZXJ0eSA9IDppZF9wcm9wZXJ0eSBBTkQKICAgIFJTX21hcmtpbmdfY29kZXMuaWRfc2VyaWVzID0gOmlkX3NlcmllcyBBTkQKICAgIFJTX21hcmtpbmdfY29kZXMuaWRfdW5pdCA9IDppZF91bml0IAoKICAgICBXSEVSRSBSU19kb2NzX2JhcmNvZGVzLmlkX2RvYyA9IDppZF9kb2MgJycnCgoKZGVmIGdldF9tYXJrY29kZV9xdWVyeSgpOgogICAgcmV0dXJuICcnJwogICAgU0VMRUNUIAogICAgUlNfZG9jc19iYXJjb2Rlcy5pZCBhcyBDdXJTdHIsCiAgICBSU19kb2NzX2JhcmNvZGVzLkdUSU4sCiAgICBSU19kb2NzX2JhcmNvZGVzLlNlcmllcywKICAgIFJTX2RvY3NfYmFyY29kZXMuYXBwcm92ZWQsCiAgICBSU19kb2NzX2JhcmNvZGVzLmlkX2dvb2QsCiAgICBSU19kb2NzX2JhcmNvZGVzLmlkX3Byb3BlcnR5IGFzIGlkX3Byb3BlcnR5LAogICAgUlNfZG9jc19iYXJjb2Rlcy5pZF9zZXJpZXMsCiAgICBSU19kb2NzX2JhcmNvZGVzLmlkX3VuaXQsCiAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwKICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBwcm9wZXJ0aWVzLAogICAgUlNfc2VyaWVzLm5hbWUgYXMgc2VyaWVzLAogICAgUlNfdW5pdHMubmFtZSBhcyB1bml0LAogICAgUlNfZ29vZHMuY29kZSBBUyBnb29kX2NvZGUsCiAgICBSU19kb2NzX2JhcmNvZGVzLmlzX3BsYW4KCiBGUk9NIFJTX2RvY3NfYmFyY29kZXMgCgogTEVGVCBKT0lOIFJTX2dvb2RzIAogICAgT04gUlNfZ29vZHMuaWQ9UlNfZG9jc19iYXJjb2Rlcy5pZF9nb29kCiAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwogICAgT04gUlNfcHJvcGVydGllcy5pZCA9IFJTX2RvY3NfYmFyY29kZXMuaWRfcHJvcGVydHkKICAgIExFRlQgSk9JTiBSU19zZXJpZXMKICAgIE9OIFJTX3Nlcmllcy5pZCA9IFJTX2RvY3NfYmFyY29kZXMuaWRfc2VyaWVzCiAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgIE9OIFJTX3VuaXRzLmlkPVJTX2RvY3NfYmFyY29kZXMuaWRfdW5pdAoKICAgICBXSEVSRSBSU19kb2NzX2JhcmNvZGVzLmlkX2RvYyA9IDppZF9kb2MgQU5EIEdUSU4gPSA6R1RJTiBBbmQgU2VyaWVzID0gOlNlcmllcycnJwoKCiMgICAgICcnJwojICAgICBTRUxFQ1QKIyAgICAgVGVtcF9xdWVyeS5DdXJTdHIgYXMgQ3VyU3RyLAojICAgICBUZW1wX3F1ZXJ5LmlkX2JhcmNvZGUsCiMgICAgIFRlbXBfcXVlcnkubWFya19jb2RlLAojICAgICBUZW1wX3F1ZXJ5LmFwcHJvdmVkLAojICAgICBUZW1wX3F1ZXJ5LmlkX2dvb2QsCiMgICAgIFRlbXBfcXVlcnkuaWRfcHJvcGVydGllcyBhcyBpZF9wcm9wZXJ0eSwKIyAgICAgVGVtcF9xdWVyeS5pZF9zZXJpZXMsCiMgICAgIFRlbXBfcXVlcnkuaWRfdW5pdCwKIyAgICAgUlNfZ29vZHMubmFtZSBhcyBnb29kX25hbWUsCiMgICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBwcm9wZXJ0aWVzLAojICAgICBSU19zZXJpZXMubmFtZSBhcyBzZXJpZXMsCiMgICAgIFJTX3VuaXRzLm5hbWUgYXMgdW5pdCwKIyAgICAgUlNfZ29vZHMuY29kZSBBUyBnb29kX2NvZGUsCiMgICAgIFRlbXBfcXVlcnkuaXNfcGxhbgojCiMKIyAgRlJPTSAoCiMgU0VMRUNUCiMgICAgIFJTX2RvY3NfYmFyY29kZXMuaWQgYXMgQ3VyU3RyLAojICAgICBpZF9iYXJjb2RlLAojICAgICBSU19tYXJraW5nX2NvZGVzLm1hcmtfY29kZSwKIyAgICAgYXBwcm92ZWQsCiMgICAgIFJTX21hcmtpbmdfY29kZXMuaWRfZ29vZCwKIyAgICAgUlNfbWFya2luZ19jb2Rlcy5pZF9wcm9wZXJ0eSBhcyBpZF9wcm9wZXJ0aWVzLAojICAgICBSU19tYXJraW5nX2NvZGVzLmlkX3NlcmllcywKIyAgICAgUlNfbWFya2luZ19jb2Rlcy5pZF91bml0LAojICAgICBSU19kb2NzX2JhcmNvZGVzLmlzX3BsYW4KIwojICAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMKIwojICAgICBKT0lOIFJTX21hcmtpbmdfY29kZXMKIyAgICAgT04gUlNfbWFya2luZ19jb2Rlcy5pZCA9IFJTX2RvY3NfYmFyY29kZXMuaWRfYmFyY29kZQojCiMgICAgICBXSEVSRSBSU19kb2NzX2JhcmNvZGVzLmlkX2RvYyA9IDppZF9kb2MgQU5EIGlkX2JhcmNvZGUgPSA6aWRfYmFyY29kZSkgQVMgVGVtcF9xdWVyeQojCiMgIExFRlQgSk9JTiBSU19nb29kcwojICAgICBPTiBSU19nb29kcy5pZD1UZW1wX3F1ZXJ5LmlkX2dvb2QKIyAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKIyAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IFRlbXBfcXVlcnkuaWRfcHJvcGVydGllcwojICAgICBMRUZUIEpPSU4gUlNfc2VyaWVzCiMgICAgIE9OIFJTX3Nlcmllcy5pZCA9IFRlbXBfcXVlcnkuaWRfc2VyaWVzCiMgICAgIExFRlQgSk9JTiBSU191bml0cwojICAgICBPTiBSU191bml0cy5pZD1UZW1wX3F1ZXJ5LmlkX3VuaXQKIyAgICAgJycnCgoKZGVmIGdldF9iYXJjb2RlX3F1ZXJ5KCkgLT4gc3RyOgogICAgcmV0dXJuICcnJwogICAgV2l0aCBiYXJjIGFzICgKU0VMRUNUIApiYXJjb2RlLAppZF9nb29kLApSU19nb29kcy50eXBlX2dvb2QsCmlkX3Byb3BlcnR5LAppZF9zZXJpZXMsCmlkX3VuaXQKIEZST00gUlNfYmFyY29kZXMgCiBMZWZ0IEpvaW4gUlNfZ29vZHMKIE9OIFJTX2JhcmNvZGVzLmlkX2dvb2QgPSBSU19nb29kcy5pZApXSEVSRSBiYXJjb2RlID0gPykKClNlbGVjdCAqIEZyb20gYmFyYwpMZWZ0IEpPSU4gUlNfdHlwZXNfZ29vZHMKT04gUlNfdHlwZXNfZ29vZHMuaWQgPSBiYXJjLnR5cGVfZ29vZAoKJycnCgoKZGVmIGdldF9tYXJrX3F0dHlfY29uZm9ybWl0eSgpOgogICAgcmV0dXJuICcnJwogICAgU0VMRUNUIGlmbnVsbChkb2NfdGFibGUucXR0eV9wbGFuLDApIC0gaWZudWxsKHRtcC5xdHR5X29mX21hcmssMCkgIEZST00gCgogICAgKFNFTEVDVCBxdHR5X3BsYW4KICAgIEZST00gUlNfZG9jc190YWJsZQogICAgV0hFUkUgCiAgICBpZF9kb2MgPSA6aWREb2MgCiAgICBBTkQgaWRfZ29vZCA9IDppZF9nb29kCiAgICBBTkQgaWRfcHJvcGVydGllcyA9IDppZF9wcm9wZXJ0aWVzCiAgICBBTkQgaWRfc2VyaWVzID0gOmlkX3NlcmllcwogICAgKSBBcyBkb2NfdGFibGUgIC0tQU5EIGlkX3VuaXQgPSA6aWRfdW5pdAogICAgICAgTEVGVCBKT0lOIChTRUxFQ1QgQ291bnQoaWRfYmFyY29kZSkgQXMgcXR0eV9vZl9tYXJrCiAgICAgICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzIAogICAgICAgIFdIRVJFIGlkX2RvYz06aWREb2MgCiAgICAgICAgQU5EIGlkX2JhcmNvZGUgTElrZSA6YmFyY29kZSBBTkQgYXBwcm92ZWQgPSA6YXBwcm92ZWQpIEFzIHRtcAogICAgICAgIE9OIFRSVUUKICAgICcnJwoKCmRlZiBnZXRfcGxhbl9nb29kX2Zyb21fZG9jKCk6CiAgICByZXR1cm4gJycnCgogICAgU0VMRUNUIGlmbnVsbChxdHR5X3BsYW4sMCkgYXMgcXR0eV9wbGFuLAogICAgaWZudWxsKHF0dHksMCkgYXMgcXR0eSwgaWRfZ29vZAogICAgRlJPTSBSU19kb2NzX3RhYmxlCiAgICBXSEVSRSAKICAgIGlkX2RvYyA9IDppZERvYyAKICAgIEFORCBpZF9nb29kID0gOmlkX2dvb2QKICAgIEFORCBpZF9wcm9wZXJ0aWVzID0gOmlkX3Byb3BlcnRpZXMKICAgIEFORCBpZF9zZXJpZXMgPSA6aWRfc2VyaWVzCiAgICAtLUFORCBpZF91bml0ID0gOmlkX3VuaXQKICAgICcnJwoKCiMgICAgICBzID0gICAgJycnCiMgICAgd2l0aCB0bXAgYXMgKAojICAgICBTRUxFQ1QgaWZudWxsKHF0dHlfcGxhbiwwKSBhcyBxdHR5X3BsYW4sCiMgICAgIGlmbnVsbChxdHR5LDApIGFzIHF0dHksIGlkX2dvb2QKIyAgICAgRlJPTSBSU19kb2NzX3RhYmxlCiMgICAgIFdIRVJFCiMgICAgIGlkX2RvYyA9IDppZERvYwojICAgICBBTkQgaWRfZ29vZCA9IDppZF9nb29kCiMgICAgIEFORCBpZF9wcm9wZXJ0aWVzID0gOmlkX3Byb3BlcnRpZXMKIyAgLS0gICBBTkQgaWRfc2VyaWVzID0gOmlkX3NlcmllcwojICAtLSAgIEFORCBpZF91bml0ID0gOmlkX3VuaXQKIyAgICAgKQojCiMgU2VsZWN0IHN1bShxdHR5X3BsYW4tcXR0eSkgYXMgY29uZm9ybWl0eSBmcm9tIHRtcAojCiMKIyAgICAgJycnCgpkZWYgZ2V0X3F0dHlfYWRkX21hcmtfdGV4dCgpOgogICAgcmV0dXJuICcnJwogICAgU0VMRUNUIFJTX2RvY3MuYWRkX21hcmtfc2VsZWN0aW9uIEFzIE1hcmtlZCwKICAgIFRtcC5RdHR5IAogICAgZnJvbSBSU19kb2NzIAogICAgTGVmdCBKb2luIChTZWxlY3QgU3VtKFJTX2RvY3NfdGFibGUucXR0eV9wbGFuKSBhcyBRdHR5IEZyb20gUlNfZG9jc190YWJsZSBXaGVyZSBSU19kb2NzX3RhYmxlLmlkX2RvYz0gOmlkX2RvYykgQXMgVG1wCiAgICBPTiBUcnVlCiAgICBXSEVSRSBpZF9kb2MgPSA6aWRfZG9jJycnCgoKZGVmIGdldF9xdHR5X3N0cmluZ19jb3VudF9xdWVyeSgpOgogICAgcmV0dXJuICcnJwogICAgU0VMRUNUIGRpc3RpbmN0IGNvdW50KGlkKSBhcyBjb2xfc3RyLAogICAgc3VtKGlmbnVsbChxdHR5X3BsYW4sMCkpIGFzIHF0dHlfcGxhbgogICAgZnJvbSBSU19kb2NzX3RhYmxlIFdoZXJlIGlkX2RvYyA9IDppZF9kb2MnJycKCgpkZWYgZ2V0X2hhdmVfbWFya19jb2Rlc19xdWVyeSgpOiAgIyDQl9Cw0L/RgNC+0YEg0LLQvtC30LLRgNCw0YnQsNC10YIg0LrQvtC70LjRh9C10YHRgtCy0L4g0LrQvtC00L7QsiDQvNCw0YDQutC40YDQvtCy0LrQuCAi0J/Qu9Cw0L0iICjRgi7QtS4g0LfQsNCz0YDRg9C20LXQvdC90YvRhSDQuNC3INGD0YfQtdGC0L3QvtC5CiAgICAjINGB0LjRgdGC0LXQvNGLKQogICAgcmV0dXJuICcnJwogICAgU0VMRUNUIGRpc3RpbmN0IGNvdW50KGlkKSBhcyBjb2xfc3RyCiAgICBmcm9tIFJTX2RvY3NfYmFyY29kZXMgV2hlcmUgaWRfZG9jID0gOmlkX2RvYyBBTkQgaXNfcGxhbiA9IDppc19wbGFuJycnCgoKZGVmIGdldF9kb2NzX3N0YXRfcXVlcnkoKToKICAgIHJldHVybiAnJycKICAgd2l0aCB0bXAgYXMgKAogICAgU2VsZWN0IAogICAgZG9jX3R5cGUsCiAgICBSU19kb2NzLmlkX2RvYywKICAgIDEgYXMgZG9jX0NvdW50LAogICAgaWZudWxsKFJTX2RvY3Muc2VudCwwKSBhcyBzZW50LAogICAgaWZudWxsKHZlcmlmaWVkLDApIGFzIHZlcmlmaWVkLCAKICAgIENBU0UKICAgIFdIRU4gaWZudWxsKHZlcmlmaWVkLDApPTAgVEhFTiBjb3VudChSU19kb2NzX3RhYmxlLmlkKQogICAgZWxzZSAwIEVORCBhcyBjb3VudF92ZXJpZmllZCwKICAgIENBU0UKICAgIFdIRU4gaWZudWxsKHZlcmlmaWVkLDApPTEgVEhFTiBjb3VudChSU19kb2NzX3RhYmxlLmlkKQogICAgZWxzZSAwIEVORCBhcyBjb3VudF91bnZlcmlmaWVkLAogICAgQ0FTRQogICAgICAgIFdIRU4gaWZudWxsKHZlcmlmaWVkLDApPTAgVEhFTiBzdW0oUlNfZG9jc190YWJsZS5xdHR5X3BsYW4pCiAgICBlbHNlIDAgRU5EIGFzIHF0dHlfcGxhbl92ZXJpZmllZCwKICAgIENBU0UKICAgICAgICBXSEVOIGlmbnVsbCh2ZXJpZmllZCwwKT0xIFRIRU4gc3VtKFJTX2RvY3NfdGFibGUucXR0eV9wbGFuKQogICAgZWxzZSAwIEVORCBhcyBxdHR5X3BsYW5fdW52ZXJpZmllZAogICAgIGZyb20gUlNfZG9jcwogICAgTGVmdCBKb2luIFJTX2RvY3NfdGFibGUgCiAgICBPTiBSU19kb2NzX3RhYmxlLmlkX2RvYyA9IFJTX2RvY3MuaWRfZG9jCiAgICBHcm91cCBieSBSU19kb2NzLmlkX2RvYwogICAgKQogICBTZWxlY3QgZG9jX3R5cGUgYXMgZG9jVHlwZSwgCiAgIGNvdW50KGlkX2RvYyksCiAgIHN1bShkb2NfQ291bnQpIGFzIGNvdW50LCAKICAgc3VtKHNlbnQpIGFzIHNlbnQsIAogICBzdW0odmVyaWZpZWQpIGFzIHZlcmlmaWVkLAogICBzdW0oY291bnRfdmVyaWZpZWQpIGFzIGNvdW50X3ZlcmlmaWVkLAogICBzdW0oY291bnRfdW52ZXJpZmllZCkgYXMgY291bnRfdW52ZXJpZmllZCwKICAgc3VtKHF0dHlfcGxhbl92ZXJpZmllZCkgYXMgcXR0eV9wbGFuX3ZlcmlmaWVkLAogICBzdW0ocXR0eV9wbGFuX3VudmVyaWZpZWQpIGFzIHF0dHlfcGxhbl91bnZlcmlmaWVkCiAgICBmcm9tIHRtcAogICAgZ3JvdXAgYnkgZG9jX3R5cGUKICAgJycnCgoKZGVmIGdldF9kb2NfdGlsZXMoc2V0dGluZ3NfZ2xvYmFsKToKCiAgICBzbWFsbF90aWxlID0gewogICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgImF1dG9TaXplVGV4dFR5cGUiIDogInVuaWZvcm0iLAogICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAZG9jTmFtZSIsCiAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJyksICMgIjI1IiwKICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIzAwMDAwMCIsCiAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBGYWxzZSwKICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwLAogICAgICAgICAgICAgICAgImdyYXZpdHlfaG9yaXpvbnRhbCI6ICJjZW50ZXIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQFF0dHlPZkRvY3MiLAogICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIzMzMzMzMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIkZGQ0M5OSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCh0YLRgNC+0Lo6ICIsCiAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnKSwgIyIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIzMzMzMzMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIkZGQ0M5OSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAY291bnRfdmVyaWZpZWQiLAogICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIzMzMzMzMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIkZGQ0M5OSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogItCi0L7QstCw0YDQvtCyOiAiLAogICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIzMzMzMzMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIkZGQ0M5OSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcXR0eV9wbGFuX3ZlcmlmaWVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnRG9jVHlwZUNhcmRUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiMzMzMzMzMiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICJGRkNDOTkiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfQoKICAgICAgICBdCiAgICB9CgogICAgcmV0dXJuIHNtYWxsX3RpbGUKCmNsYXNzIE1vZGVybkZpZWxkOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhpbnQ9Tm9uZSwgZGVmYXVsdF90ZXh0PU5vbmUsIHBhc3N3b3JkPUZhbHNlKTogICMgY291bnRlcj1GYWxzZSwgY291bnRlcl9tYXg9Tm9uZSwgaW5wdXRfdHlwZT0gMSAsCiAgICAgICAgc2VsZi5oaW50ID0gaGludAogICAgICAgIHNlbGYuZGVmYXVsdF90ZXh0ID0gZGVmYXVsdF90ZXh0CiAgICAgICAgI3NlbGYuY291bnRlciA9IGNvdW50ZXIKICAgICAgICAjc2VsZi5jb3VudGVyX21heCA9IGNvdW50ZXJfbWF4CiAgICAgICAgI3NlbGYuaW5wdXRfdHlwZSA9IGlucHV0X3R5cGUKICAgICAgICBzZWxmLnBhc3N3b3JkID0gcGFzc3dvcmQKCiAgICBkZWYgdG9fanNvbihzZWxmKToKICAgICAgICByZXQgPSB7CiAgICAgICAgICAgICJoaW50Ijogc2VsZi5oaW50LAogICAgICAgICAgICAiZGVmYXVsdF90ZXh0Ijogc2VsZi5kZWZhdWx0X3RleHR9CiAgICAgICAgIyAiY291bnRlciI6IHNlbGYuY291bnRlciwKICAgICAgICAjICJjb3VudGVyX21heCI6IHNlbGYuY291bnRlcl9tYXgsCiAgICAgICAgIyAiaW5wdXRfdHlwZSI6IHNlbGYuaW5wdXRfdHlwZSwKICAgICAgICBpZiBzZWxmLnBhc3N3b3JkOgogICAgICAgICAgICByZXRbInBhc3N3b3JkIl0gPSBzZWxmLnBhc3N3b3JkCgogICAgICAgIHJldHVybiBqc29uLmR1bXBzKHJldCkKCgoKIyBodHRwX3NldHRpbmdzID0geyd1cmwnOicxOTInLCAndXNlcic6J0FNRCcsICdwYXNzJzonMTIzJ30KIyBwcmludChNb2Rlcm5GaWVsZChoaW50PSd1cmwnLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sndXJsJ10sIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpCiMgcHJpbnQoTW9kZXJuRmllbGQoaGludD0ndXNlcicsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1c2VyJ10sIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpCiMgcHJpbnQoTW9kZXJuRmllbGQoaGludD0ncGFzcycsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWydwYXNzJ10sIHBhc3N3b3JkPVRydWUpLnRvX2pzb24oKSk="
            },
            {
                "PyFileKey": "database_init_queryes",
                "PyFileData": "I2ltcG9ydCB1aV9nbG9iYWwKZGVmIGRhdGFiYXNlX3NoZW1hKCk6CiAgICBScyA9IFtdCgoKICAgICPQmtC+0L3RgdGC0LDQvdGC0Ysg0Lgg0YXRgNCw0L3QuNC80YvQtSDQvdCw0YHRgtGA0L7QudC60LggUlNfY29uc3RhbnRzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19jb25zdGFudHMgKAogICAgICAgIGlkICAgICAgICAgICAgIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICB1c2Vfc2VyaWVzICAgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgdXNlX3Byb3BlcnRpZXMgVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHVzZV9tYXJrICAgICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBhZGRfaWZfbm90X2luX3BsYW4gICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBwYXRoICAgICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBERUZBVUxUICIvL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvIiwKICAgICAgICBkZWxldGVfZmlsZXMgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgcmVzZXJ2ZWQgICAgICAgVEVYVCAgICBOT1QgTlVMTCwKICAgICAgICBtYXhfaWRfZG9jICAgICAgICAgSU5URUdFUiBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMSksCiAgICAgICAgYWxsb3dfb3ZlcnNjYW4gVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHJlbGVhc2UgICAgICAgIFRFWFQKICAgICkKICAgICcnJykKCgogICAgIyDQmtC70LDRgdGB0LjRhNC40LrQsNGC0L7RgCDQtdC00LjQvdC40YYg0LjQt9C80LXRgNC10L3QuNGPIFJTX2NsYXNzaWZpZXJfdW5pdHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NsYXNzaWZpZXJfdW5pdHMgKAogICAgICAgIGlkIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgY29kZSAgICBURVhUIE5PVCBOVUxMLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICMg0JLQuNC00Ysg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3R5cGVzX2dvb2RzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU190eXBlc19nb29kcyAoCiAgICBpZCAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgbmFtZSAgICAgVEVYVCBOT1QgTlVMTCwKICAgIHVzZV9tYXJrIElOVCAgREVGQVVMVCAoMCkgCiAgICApCiAgICAnJycpCgogICAgIyDQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAgUlNfZ29vZHMKICAgIFJzLmFwcGVuZCgnJycKICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19nb29kcyAoCiAgICAgICAgICAgIGlkICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgICAgIGNvZGUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIG5hbWUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIGFydCAgICAgICAgIFRFWFQsCiAgICAgICAgICAgIHVuaXQgICAgICAgIFRFWFQgIFJFRkVSRU5DRVMgUlNfY2xhc3NpZmllcl91bml0cyAoaWQpLAogICAgICAgICAgICB0eXBlX2dvb2QgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU190eXBlc19nb29kcyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNQVRDSCBbRlVMTF0sCiAgICAgICAgICAgIGRlc2NyaXB0aW9uIFRFWFQKICAgICAgICApCiAgICAgICAgJycnKQoKCiAgICAjINCl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3Byb3BlcnRpZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3Byb3BlcnRpZXMgKAogICAgaWQgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBPTiBDT05GTElDVCBSRVBMQUNFLAogICAgaWRfb3duZXIgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCkgT04gREVMRVRFIE5PIEFDVElPTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gVVBEQVRFIE5PIEFDVElPTiwKICAgIG5hbWUgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCgogICAgIyDQo9C/0LDQutC+0LLQutC4INCV0LTQuNC90LjRhtGLINC40LfQvNC10YDQtdC90LjRjyBSU191bml0cwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfdW5pdHMgKAogICAgICAgIGlkICAgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgaWRfb3duZXIgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBjb2RlICAgICAgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgbmFtZSAgICAgICAgICBURVhUICAgIE5PVCBOVUxMLAogICAgICAgIG5vbWluYXRvciAgICAgSU5URUdFUiBOT1QgTlVMTCwKICAgICAgICBkZW5vbWluYXRvciAgIElOVEVHRVIgTk9UIE5VTEwsCiAgICAgICAgaW50X3JlZHVjdGlvbiBURVhUICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgoKCiAgICAjINCh0LXRgNC40Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3NlcmllcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfc2VyaWVzICgKICAgICAgICBpZCAgICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBiZXN0X2JlZm9yZSAgICAgVEVYVCwKICAgICAgICB0eXBlX2dvb2RzICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBwcm9kdWN0aW9uX2RhdGUgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKCiAgICAjINCo0YLRgNC40YXQutC+0LTRiyBSU19iYXJjb2RlcwogICAgUnMuYXBwZW5kKCAnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2JhcmNvZGVzICgKICAgIGJhcmNvZGUgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICBpZF9nb29kICAgICBURVhUIE5PVCBOVUxMLAogICAgaWRfcHJvcGVydHkgVEVYVCwKICAgIGlkX3NlcmllcyAgIFRFWFQsCiAgICBpZF91bml0ICAgICBURVhUCikKCiAgICAnJycpCgogICAgI9Ca0L7QtNGLINC80LDRgNC60LjRgNC+0LLQutC4IFJTX21hcmtpbmdfY29kZXMKICAgIFJzLmFwcGVuZCggJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19tYXJraW5nX2NvZGVzICgKICAgICAgICBpZCAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBtYXJrX2NvZGUgICBURVhUIE5PVCBOVUxMLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9wcm9wZXJ0eSBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSAKICAgICkKICAgICcnJykKCgoKICAgICMg0JrQvtC90YLRgNCw0LPQtdC90YLRiyBSU19jb3VudHJhZ2VudHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NvdW50cmFnZW50cyAoCiAgICAgICAgaWQgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgbmFtZSAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgZnVsbF9uYW1lIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgaW5uICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAga3BwICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCh0LrQu9Cw0LTRiyBSU193YXJlaG91c2VzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU193YXJlaG91c2VzICgKICAgICAgICBpZCBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NlbGxzICgKICAgIGlkICAgVEVYVCBQUklNQVJZIEtFWQogICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgbmFtZSBURVhUIE5PVCBOVUxMLAogICAgYmFyY29kZSBURVhUCiAgICApJycnKQoKICAgICMg0JLQuNC00Ysg0YbQtdC9INC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZV90eXBlcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfcHJpY2VfdHlwZXMgKAogICAgICAgIGlkICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCm0LXQvdGLINC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3ByaWNlcyAoCiAgICAgICAgaWQgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX3ByaWNlX3R5cGVzIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBpZF9nb29kcyAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICAgICAgaWRfcHJvcGVydGllcyAgVEVYVCAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgcHJpY2UgICAgICAgICAgUkVBTCwKICAgICAgICBpZF91bml0ICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3VuaXRzIChpZCkgCiAgICApCiAgICAnJycpCgogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfZG9jX3R5cGVzICgKICAgIGRvY190eXBlIFRFWFQgUFJJTUFSWSBLRVkgT04gQ09ORkxJQ1QgUkVQTEFDRQogICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICBpc19hZHJfc3RvcmFnZSBJTlQgIERFRkFVTFQgKDApIAogICAgKQogICAgJycnKQoKICAgICMg0JLRgdC1INC00L7QutGD0LzQtdC90YLRiyDRgdC/0LjRgdC60L7QvCBSU19kb2NzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfY291bnRyYWdlbnRzICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfY291bnRyYWdlbnRzIChpZCksCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUIERFRkFVTFQgMAogICAgKQogICAgJycnKQoKCiAgICAjINCi0LDQsdC70LjRh9C90LDRjyDRh9Cw0YHRgtGMINC00L7QutGD0LzQtdC90YLQvtCyIFJTX2RvY3NfdGFibGUKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfdGFibGUgKAogICAgICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICBpZF9kb2MgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICAgICAgaWRfZ29vZCAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgICAgIGlkX3Byb3BlcnRpZXMgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgaWRfc2VyaWVzICAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSwKICAgICAgICBxdHR5ICAgICAgICAgIFJFQUwsCiAgICAgICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgICAgIHByaWNlICAgICAgICAgUkVBTCwKICAgICAgICBpZF9wcmljZSAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBzZW50ICAgICAgICAgIElOVEVHRVIsCiAgICAgICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGlzX3BsYW4gICAgICAgVEVYVCBERUZBVUxUICJUcnVlIiwKICAgICAgICBpZF9jZWxsICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSAKICAgICkKICAgICcnJykKCgogICAgIyDQmtC+0LTRiyDQvNCw0YDQutC40YDQvtCy0LrQuCDQsiDQtNC+0LrRg9C80LXQvdGC0LUgUlNfZG9jc19iYXJjb2RlcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfZG9jc19iYXJjb2RlcyAoCiAgICBpZCAgICAgICAgICAgICAgICAgICBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsCiAgICBpZF9kb2MgICAgICAgICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZG9jcyAoaWRfZG9jKSwKICAgIGlkX2dvb2QgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydHkgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgIGlkX3NlcmllcyAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3VuaXQgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpICwKICAgIC0tIyBpZF9iYXJjb2RlICAgICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAtLSMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX21hcmtpbmdfY29kZXMgKGlkKSwKICAgIGJhcmNvZGVfZnJvbV9zY2FubmVyIFRFWFQsCiAgICBpc19wbGFuICAgICAgICAgICAgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgIGFwcHJvdmVkICAgICAgICAgICAgIFRFWFQgICAgREVGQVVMVCAwLAogICAgR1RJTiAgICAgICAgICAgICAgICAgVEVYVCwKICAgIFNlcmllcyAgICAgICAgICAgICAgIFRFWFQKICAgICkKICAgICcnJykKCiAgICAj0J/QvtGC0L7QuiDQv9GA0L7QuNC30LLQvtC70YzQvdGL0YUg0YjRgtGA0LjRhdC60L7QtNC+0LIKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2JhcmNfZmxvdyAoCiAgICBpZF9kb2MgIFRFWFQgUkVGRVJFTkNFUyBSU19kb2NzIChpZF9kb2MpLAogICAgYmFyY29kZSBURVhUCiAgICApCiAgICAnJycpCgogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfYWRyX2RvY3MgKAogICAgaWRfZG9jICAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICBkb2NfdHlwZSAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICBkb2NfbiAgICAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICBpZF93YXJlaG91c2UgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3dhcmVob3VzZXMgKGlkKSwKICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgc2VudCAgICAgICAgICAgICAgIElOVEVHRVIsCiAgICBhZGRfbWFya19zZWxlY3Rpb24gSU5URUdFUiwKICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgY29udHJvbCAgICAgICAgICAgIFRFWFQgICAgIERFRkFVTFQgMAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzX3RhYmxlICgKICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19hZHJfZG9jcyAoaWRfZG9jKSBPTiBERUxFVEUgQ0FTQ0FERQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBTRVQgREVGQVVMVCwKICAgIGlkX2dvb2QgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydGllcyBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgIGlkX3NlcmllcyAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpLAogICAgcXR0eSAgICAgICAgICBSRUFMLAogICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgc2VudCAgICAgICAgICBJTlRFR0VSLAogICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiAgICAgICBURVhUICAgICBERUZBVUxUIFRydWUsCiAgICBpZF9jZWxsICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwgCiAgICB0YWJsZV90eXBlICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgIERFRkFVTFQgJ291dCcKICAgICkKICAgICcnJykKCiAgICBScy5hcHBlbmQoJycnCiAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgRXJyb3JfbG9nICgKICAgICAgICBsb2cgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoJycpLAogICAgICAgIHRpbWVzdGFtcCBEQVRFVElNRSBERUZBVUxUIChDVVJSRU5UX1RJTUVTVEFNUCkpIAogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX25hbWUgT04gUlNfY2VsbHMgKAogICAgbmFtZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX25hbWUgT04gUlNfY2VsbHMgKAogICAgYmFyY29kZQogICAgKQogICAgJycnKQoKCiMgUlNfY29uc3RhbnRzICsgUlNfY2xhc3NpZmllcl91bml0cyArIFJTX3R5cGVzX2dvb2RzCiMgICAgIFJzID0gKyBSU19nb29kcyArIFJTX3Byb3BlcnRpZXNcCiMgICAgICAgICAgKyBSU19zZXJpZXMgKyBSU191bml0cyArIFJTX2JhcmNvZGVzICsgUlNfbWFya2luZ19jb2RlcyArIFJTX2RvY3MgKyBSU19kb2NzX2JhcmNvZGVzXAojICAgICAgICAgICsgUlNfZG9jc190YWJsZSArIFJTX3ByaWNlX3R5cGVzICsgUlNfcHJpY2VzICsgUlNfY291bnRyYWdlbnRzICsgUlNfd2FyZWhvdXNlcwoKICAgIHJldHVybiBScwojcHJpbnQoZGF0YWJhc2Vfc2hlbWEoKSkKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2NvbnN0YW50cykKICAgICMgUnMuYXBwZW5kKFJTX2NsYXNzaWZpZXJfdW5pdHMpCiAgICAjIFJzLmFwcGVuZChSU190eXBlc19nb29kcykKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2dvb2RzKQogICAgIyBScy5hcHBlbmQoUlNfcHJvcGVydGllcykKICAgICMgUnMuYXBwZW5kKFJTX3NlcmllcykKICAgICMgUnMuYXBwZW5kKFJTX3VuaXRzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19tYXJraW5nX2NvZGVzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfZG9jcykKICAgICMgUnMuYXBwZW5kKFJTX2RvY3NfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19kb2NzX3RhYmxlKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfcHJpY2VfdHlwZXMpCiAgICAjIFJzLmFwcGVuZChSU19wcmljZXMpCiAgICAjCiAgICAjIFJzLmFwcGVuZChSU19jb3VudHJhZ2VudHMpCiAgICAjIFJzLmFwcGVuZChSU193YXJlaG91c2VzKQogICAgI3VpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KFJzKQoK"
            }
        ]
    }
}